{"id": 2256, "question": "This morning Tolik has understood that while he was sleeping he had invented an incredible problem which will be a perfect fit for Codeforces! But, as a \"Discuss tasks\" project hasn't been born yet (in English, well), he decides to test a problem and asks his uncle.\n\nAfter a long time thinking, Tolik's uncle hasn't any ideas on how to solve it. But, he doesn't want to tell Tolik about his inability to solve it, so he hasn't found anything better than asking you how to solve this task.\n\nIn this task you are given a cell field $n \\cdot m$, consisting of $n$ rows and $m$ columns, where point's coordinates $(x, y)$ mean it is situated in the $x$-th row and $y$-th column, considering numeration from one ($1 \\leq x \\leq n, 1 \\leq y \\leq m$). Initially, you stand in the cell $(1, 1)$. Every move you can jump from cell $(x, y)$, which you stand in, by any non-zero vector $(dx, dy)$, thus you will stand in the $(x+dx, y+dy)$ cell. Obviously, you can't leave the field, but also there is one more important condition — you're not allowed to use one vector twice. Your task is to visit each cell of the field exactly once (the initial cell is considered as already visited).\n\nTolik's uncle is a very respectful person. Help him to solve this task!\n\n\n-----Input-----\n\nThe first and only line contains two positive integers $n, m$ ($1 \\leq n \\cdot m \\leq 10^{6}$) — the number of rows and columns of the field respectively.\n\n\n-----Output-----\n\nPrint \"-1\" (without quotes) if it is impossible to visit every cell exactly once.\n\nElse print $n \\cdot m$ pairs of integers, $i$-th from them should contain two integers $x_i, y_i$ ($1 \\leq x_i \\leq n, 1 \\leq y_i \\leq m$) — cells of the field in order of visiting, so that all of them are distinct and vectors of jumps between them are distinct too.\n\nNotice that the first cell should have $(1, 1)$ coordinates, according to the statement.\n\n\n-----Examples-----\nInput\n2 3\n\nOutput\n1 1\n1 3\n1 2\n2 2\n2 3\n2 1\nInput\n1 1\n\nOutput\n1 1\n\n\n\n-----Note-----\n\nThe vectors from the first example in the order of making jumps are $(0, 2), (0, -1), (1, 0), (0, 1), (0, -2)$.", "input_output": [{"input": "2 3\n", "output": "1 1\n1 3\n1 2\n2 2\n2 3\n2 1"}, {"input": "1 1\n", "output": "1 1\n"}, {"input": "8 8\n", "output": "1 1\n8 8\n1 2\n8 7\n1 3\n8 6\n1 4\n8 5\n1 5\n8 4\n1 6\n8 3\n1 7\n8 2\n1 8\n8 1\n2 1\n7 8\n2 2\n7 7\n2 3\n7 6\n2 4\n7 5\n2 5\n7 4\n2 6\n7 3\n2 7\n7 2\n2 8\n7 1\n3 1\n6 8\n3 2\n6 7\n3 3\n6 6\n3 4\n6 5\n3 5\n6 4\n3 6\n6 3\n3 7\n6 2\n3 8\n6 1\n4 1\n5 8\n4 2\n5 7\n4 3\n5 6\n4 4\n5 5\n4 5\n5 4\n4 6\n5 3\n4 7\n5 2\n4 8\n5 1\n"}, {"input": "6 8\n", "output": "1 1\n6 8\n1 2\n6 7\n1 3\n6 6\n1 4\n6 5\n1 5\n6 4\n1 6\n6 3\n1 7\n6 2\n1 8\n6 1\n2 1\n5 8\n2 2\n5 7\n2 3\n5 6\n2 4\n5 5\n2 5\n5 4\n2 6\n5 3\n2 7\n5 2\n2 8\n5 1\n3 1\n4 8\n3 2\n4 7\n3 3\n4 6\n3 4\n4 5\n3 5\n4 4\n3 6\n4 3\n3 7\n4 2\n3 8\n4 1\n"}]}
{"id": 2149, "question": "You are given a set of size $m$ with integer elements between $0$ and $2^{n}-1$ inclusive. Let's build an undirected graph on these integers in the following way: connect two integers $x$ and $y$ with an edge if and only if $x \\& y = 0$. Here $\\&$ is the bitwise AND operation. Count the number of connected components in that graph.\n\n\n-----Input-----\n\nIn the first line of input there are two integers $n$ and $m$ ($0 \\le n \\le 22$, $1 \\le m \\le 2^{n}$).\n\nIn the second line there are $m$ integers $a_1, a_2, \\ldots, a_m$ ($0 \\le a_{i} < 2^{n}$) — the elements of the set. All $a_{i}$ are distinct.\n\n\n-----Output-----\n\nPrint the number of connected components.\n\n\n-----Examples-----\nInput\n2 3\n1 2 3\n\nOutput\n2\n\nInput\n5 5\n5 19 10 20 12\n\nOutput\n2\n\n\n\n-----Note-----\n\nGraph from first sample:\n\n$0$\n\nGraph from second sample:\n\n[Image]", "input_output": [{"input": "2 3\n1 2 3\n", "output": "2\n"}, {"input": "5 5\n5 19 10 20 12\n", "output": "2\n"}, {"input": "3 5\n3 5 0 6 7\n", "output": "1\n"}, {"input": "0 1\n0\n", "output": "1\n"}, {"input": "1 1\n1\n", "output": "1\n"}, {"input": "1 1\n0\n", "output": "1\n"}, {"input": "6 30\n3 8 13 16 18 19 21 22 24 25 26 28 29 31 33 42 44 46 49 50 51 53 54 57 58 59 60 61 62 63\n", "output": "10\n"}, {"input": "6 35\n5 7 10 11 13 14 17 18 25 27 28 29 30 31 33 35 36 37 39 40 41 43 46 47 50 52 55 56 57 58 59 60 61 62 63\n", "output": "13\n"}, {"input": "6 22\n21 23 26 28 31 35 38 39 41 42 44 45 47 50 51 52 54 55 56 59 62 63\n", "output": "20\n"}, {"input": "6 19\n15 23 27 29 30 31 43 46 47 51 53 55 57 58 59 60 61 62 63\n", "output": "19\n"}]}
{"id": 2339, "question": "This is the easy version of the problem. The difference between the versions is the constraint on $n$ and the required number of operations. You can make hacks only if all versions of the problem are solved.\n\nThere are two binary strings $a$ and $b$ of length $n$ (a binary string is a string consisting of symbols $0$ and $1$). In an operation, you select a prefix of $a$, and simultaneously invert the bits in the prefix ($0$ changes to $1$ and $1$ changes to $0$) and reverse the order of the bits in the prefix.\n\nFor example, if $a=001011$ and you select the prefix of length $3$, it becomes $011011$. Then if you select the entire string, it becomes $001001$.\n\nYour task is to transform the string $a$ into $b$ in at most $3n$ operations. It can be proved that it is always possible.\n\n\n-----Input-----\n\nThe first line contains a single integer $t$ ($1\\le t\\le 1000$)  — the number of test cases. Next $3t$ lines contain descriptions of test cases.\n\nThe first line of each test case contains a single integer $n$ ($1\\le n\\le 1000$)  — the length of the binary strings.\n\nThe next two lines contain two binary strings $a$ and $b$ of length $n$.\n\nIt is guaranteed that the sum of $n$ across all test cases does not exceed $1000$.\n\n\n-----Output-----\n\nFor each test case, output an integer $k$ ($0\\le k\\le 3n$), followed by $k$ integers $p_1,\\ldots,p_k$ ($1\\le p_i\\le n$). Here $k$ is the number of operations you use and $p_i$ is the length of the prefix you flip in the $i$-th operation.\n\n\n-----Example-----\nInput\n5\n2\n01\n10\n5\n01011\n11100\n2\n01\n01\n10\n0110011011\n1000110100\n1\n0\n1\n\nOutput\n3 1 2 1\n6 5 2 5 3 1 2\n0\n9 4 1 2 10 4 1 2 1 5\n1 1\n\n\n\n-----Note-----\n\nIn the first test case, we have $01\\to 11\\to 00\\to 10$.\n\nIn the second test case, we have $01011\\to 00101\\to 11101\\to 01000\\to 10100\\to 00100\\to 11100$.\n\nIn the third test case, the strings are already the same. Another solution is to flip the prefix of length $2$, which will leave $a$ unchanged.", "input_output": [{"input": "5\n2\n01\n10\n5\n01011\n11100\n2\n01\n01\n10\n0110011011\n1000110100\n1\n0\n1\n", "output": "3 1 2 1 \n8 1 5 1 4 1 3 2 1 \n3 2 1 1 \n19 1 10 1 9 1 8 1 7 1 6 1 5 1 4 1 3 1 2 1 \n1 1 \n"}]}
{"id": 2331, "question": "There is an undirected tree of $n$ vertices, connected by $n-1$ bidirectional edges. There is also a snake stuck inside of this tree. Its head is at vertex $a$ and its tail is at vertex $b$. The snake's body occupies all vertices on the unique simple path between $a$ and $b$.\n\nThe snake wants to know if it can reverse itself  — that is, to move its head to where its tail started, and its tail to where its head started. Unfortunately, the snake's movements are restricted to the tree's structure.\n\nIn an operation, the snake can move its head to an adjacent vertex not currently occupied by the snake. When it does this, the tail moves one vertex closer to the head, so that the length of the snake remains unchanged. Similarly, the snake can also move its tail to an adjacent vertex not currently occupied by the snake. When it does this, the head moves one unit closer to the tail. [Image] Let's denote a snake position by $(h,t)$, where $h$ is the index of the vertex with the snake's head, $t$ is the index of the vertex with the snake's tail. This snake can reverse itself with the movements $(4,7)\\to (5,1)\\to (4,2)\\to (1, 3)\\to (7,2)\\to (8,1)\\to (7,4)$. \n\nDetermine if it is possible to reverse the snake with some sequence of operations.\n\n\n-----Input-----\n\nThe first line contains a single integer $t$ ($1\\le t\\le 100$)  — the number of test cases. The next lines contain descriptions of test cases.\n\nThe first line of each test case contains three integers $n,a,b$ ($2\\le n\\le 10^5,1\\le a,b\\le n,a\\ne b$).\n\nEach of the next $n-1$ lines contains two integers $u_i,v_i$ ($1\\le u_i,v_i\\le n,u_i\\ne v_i$), indicating an edge between vertices $u_i$ and $v_i$. It is guaranteed that the given edges form a tree.\n\nIt is guaranteed that the sum of $n$ across all test cases does not exceed $10^5$.\n\n\n-----Output-----\n\nFor each test case, output \"YES\" if it is possible for the snake to reverse itself, or \"NO\" otherwise.\n\n\n-----Example-----\nInput\n4\n8 4 7\n1 2\n2 3\n1 4\n4 5\n4 6\n1 7\n7 8\n4 3 2\n4 3\n1 2\n2 3\n9 3 5\n1 2\n2 3\n3 4\n1 5\n5 6\n6 7\n1 8\n8 9\n16 15 12\n1 2\n2 3\n1 4\n4 5\n5 6\n6 7\n4 8\n8 9\n8 10\n10 11\n11 12\n11 13\n13 14\n10 15\n15 16\n\nOutput\nYES\nNO\nNO\nYES\n\n\n\n-----Note-----\n\nThe first test case is pictured above.\n\nIn the second test case, the tree is a path. We can show that the snake cannot reverse itself.\n\nIn the third test case, we can show that the snake cannot reverse itself.\n\nIn the fourth test case, an example solution is:\n\n$(15,12)\\to (16,11)\\to (15,13)\\to (10,14)\\to (8,13)\\to (4,11)\\to (1,10)$\n\n$\\to (2,8)\\to (3,4)\\to (2,5)\\to (1,6)\\to (4,7)\\to (8,6)\\to (10,5)$\n\n$\\to (11,4)\\to (13,8)\\to (14,10)\\to (13,15)\\to (11,16)\\to (12,15)$.", "input_output": [{"input": "4\n8 4 7\n1 2\n2 3\n1 4\n4 5\n4 6\n1 7\n7 8\n4 3 2\n4 3\n1 2\n2 3\n9 3 5\n1 2\n2 3\n3 4\n1 5\n5 6\n6 7\n1 8\n8 9\n16 15 12\n1 2\n2 3\n1 4\n4 5\n5 6\n6 7\n4 8\n8 9\n8 10\n10 11\n11 12\n11 13\n13 14\n10 15\n15 16\n", "output": "YES\nNO\nNO\nYES\n"}]}
{"id": 2099, "question": "Permutation p is an ordered set of integers p_1,   p_2,   ...,   p_{n}, consisting of n distinct positive integers not larger than n. We'll denote as n the length of permutation p_1,   p_2,   ...,   p_{n}.\n\nYour task is to find such permutation p of length n, that the group of numbers |p_1 - p_2|, |p_2 - p_3|, ..., |p_{n} - 1 - p_{n}| has exactly k distinct elements.\n\n\n-----Input-----\n\nThe single line of the input contains two space-separated positive integers n, k (1 ≤ k < n ≤ 10^5).\n\n\n-----Output-----\n\nPrint n integers forming the permutation. If there are multiple answers, print any of them.\n\n\n-----Examples-----\nInput\n3 2\n\nOutput\n1 3 2\n\nInput\n3 1\n\nOutput\n1 2 3\n\nInput\n5 2\n\nOutput\n1 3 2 4 5\n\n\n\n-----Note-----\n\nBy |x| we denote the absolute value of number x.", "input_output": [{"input": "3 2\n", "output": "1 3 2\n"}, {"input": "3 1\n", "output": "1 2 3\n"}, {"input": "5 2\n", "output": "1 3 2 4 5\n"}, {"input": "5 4\n", "output": "1 5 2 4 3\n"}, {"input": "10 4\n", "output": "1 10 2 9 8 7 6 5 4 3\n"}, {"input": "10 3\n", "output": "1 10 2 3 4 5 6 7 8 9\n"}, {"input": "10 9\n", "output": "1 10 2 9 3 8 4 7 5 6\n"}, {"input": "2 1\n", "output": "1 2\n"}, {"input": "4 1\n", "output": "1 2 3 4\n"}, {"input": "4 2\n", "output": "1 4 3 2\n"}, {"input": "9 8\n", "output": "1 9 2 8 3 7 4 6 5\n"}, {"input": "7 5\n", "output": "1 7 2 6 3 4 5\n"}]}
{"id": 2105, "question": "Sherlock has a new girlfriend (so unlike him!). Valentine's day is coming and he wants to gift her some jewelry.\n\nHe bought n pieces of jewelry. The i-th piece has price equal to i + 1, that is, the prices of the jewelry are 2, 3, 4, ... n + 1.\n\nWatson gave Sherlock a challenge to color these jewelry pieces such that two pieces don't have the same color if the price of one piece is a prime divisor of the price of the other piece. Also, Watson asked him to minimize the number of different colors used.\n\nHelp Sherlock complete this trivial task.\n\n\n-----Input-----\n\nThe only line contains single integer n (1 ≤ n ≤ 100000) — the number of jewelry pieces.\n\n\n-----Output-----\n\nThe first line of output should contain a single integer k, the minimum number of colors that can be used to color the pieces of jewelry with the given constraints.\n\nThe next line should consist of n space-separated integers (between 1 and k) that specify the color of each piece in the order of increasing price.\n\nIf there are multiple ways to color the pieces using k colors, you can output any of them.\n\n\n-----Examples-----\nInput\n3\n\nOutput\n2\n1 1 2 \nInput\n4\n\nOutput\n2\n2 1 1 2\n\n\n\n-----Note-----\n\nIn the first input, the colors for first, second and third pieces of jewelry having respective prices 2, 3 and 4 are 1, 1 and 2 respectively.\n\nIn this case, as 2 is a prime divisor of 4, colors of jewelry having prices 2 and 4 must be distinct.", "input_output": [{"input": "3\n", "output": "2\n1 1 2 \n"}, {"input": "4\n", "output": "2\n1 1 2 1 \n"}, {"input": "17\n", "output": "2\n1 1 2 1 2 1 2 2 2 1 2 1 2 2 2 1 2 \n"}, {"input": "25\n", "output": "2\n1 1 2 1 2 1 2 2 2 1 2 1 2 2 2 1 2 1 2 2 2 1 2 2 2 \n"}, {"input": "85\n", "output": "2\n1 1 2 1 2 1 2 2 2 1 2 1 2 2 2 1 2 1 2 2 2 1 2 2 2 2 2 1 2 1 2 2 2 2 2 1 2 2 2 1 2 1 2 2 2 1 2 2 2 2 2 1 2 2 2 2 2 1 2 1 2 2 2 2 2 1 2 2 2 1 2 1 2 2 2 2 2 1 2 2 2 1 2 2 2 \n"}, {"input": "105\n", "output": "2\n1 1 2 1 2 1 2 2 2 1 2 1 2 2 2 1 2 1 2 2 2 1 2 2 2 2 2 1 2 1 2 2 2 2 2 1 2 2 2 1 2 1 2 2 2 1 2 2 2 2 2 1 2 2 2 2 2 1 2 1 2 2 2 2 2 1 2 2 2 1 2 1 2 2 2 2 2 1 2 2 2 1 2 2 2 2 2 1 2 2 2 2 2 2 2 1 2 2 2 1 2 1 2 2 2 \n"}, {"input": "123\n", "output": "2\n1 1 2 1 2 1 2 2 2 1 2 1 2 2 2 1 2 1 2 2 2 1 2 2 2 2 2 1 2 1 2 2 2 2 2 1 2 2 2 1 2 1 2 2 2 1 2 2 2 2 2 1 2 2 2 2 2 1 2 1 2 2 2 2 2 1 2 2 2 1 2 1 2 2 2 2 2 1 2 2 2 1 2 2 2 2 2 1 2 2 2 2 2 2 2 1 2 2 2 1 2 1 2 2 2 1 2 1 2 2 2 1 2 2 2 2 2 2 2 2 2 2 2 \n"}, {"input": "1\n", "output": "1\n1 \n"}, {"input": "10\n", "output": "2\n1 1 2 1 2 1 2 2 2 1 \n"}, {"input": "2\n", "output": "1\n1 1 \n"}, {"input": "1\n", "output": "1\n1 \n"}, {"input": "2\n", "output": "1\n1 1 \n"}]}
{"id": 2219, "question": "During the archaeological research in the Middle East you found the traces of three ancient religions: First religion, Second religion and Third religion. You compiled the information on the evolution of each of these beliefs, and you now wonder if the followers of each religion could coexist in peace.\n\nThe Word of Universe is a long word containing the lowercase English characters only. At each moment of time, each of the religion beliefs could be described by a word consisting of lowercase English characters.\n\nThe three religions can coexist in peace if their descriptions form disjoint subsequences of the Word of Universe. More formally, one can paint some of the characters of the Word of Universe in three colors: $1$, $2$, $3$, so that each character is painted in at most one color, and the description of the $i$-th religion can be constructed from the Word of Universe by removing all characters that aren't painted in color $i$.\n\nThe religions however evolve. In the beginning, each religion description is empty. Every once in a while, either a character is appended to the end of the description of a single religion, or the last character is dropped from the description. After each change, determine if the religions could coexist in peace.\n\n\n-----Input-----\n\nThe first line of the input contains two integers $n, q$ ($1 \\leq n \\leq 100\\,000$, $1 \\leq q \\leq 1000$) — the length of the Word of Universe and the number of religion evolutions, respectively. The following line contains the Word of Universe — a string of length $n$ consisting of lowercase English characters.\n\nEach of the following line describes a single evolution and is in one of the following formats:   + $i$ $c$ ($i \\in \\{1, 2, 3\\}$, $c \\in \\{\\mathtt{a}, \\mathtt{b}, \\dots, \\mathtt{z}\\}$: append the character $c$ to the end of $i$-th religion description.  - $i$ ($i \\in \\{1, 2, 3\\}$) – remove the last character from the $i$-th religion description. You can assume that the pattern is non-empty. \n\nYou can assume that no religion will have description longer than $250$ characters.\n\n\n-----Output-----\n\nWrite $q$ lines. The $i$-th of them should be YES if the religions could coexist in peace after the $i$-th evolution, or NO otherwise.\n\nYou can print each character in any case (either upper or lower).\n\n\n-----Examples-----\nInput\n6 8\nabdabc\n+ 1 a\n+ 1 d\n+ 2 b\n+ 2 c\n+ 3 a\n+ 3 b\n+ 1 c\n- 2\n\nOutput\nYES\nYES\nYES\nYES\nYES\nYES\nNO\nYES\n\nInput\n6 8\nabbaab\n+ 1 a\n+ 2 a\n+ 3 a\n+ 1 b\n+ 2 b\n+ 3 b\n- 1\n+ 2 z\n\nOutput\nYES\nYES\nYES\nYES\nYES\nNO\nYES\nNO\n\n\n\n-----Note-----\n\nIn the first example, after the 6th evolution the religion descriptions are: ad, bc, and ab. The following figure shows how these descriptions form three disjoint subsequences of the Word of Universe: $\\left. \\begin{array}{|c|c|c|c|c|c|c|} \\hline \\text{Word} & {a} & {b} & {d} & {a} & {b} & {c} \\\\ \\hline ad & {a} & {} & {d} & {} & {} & {} \\\\ \\hline bc & {} & {b} & {} & {} & {} & {c} \\\\ \\hline ab & {} & {} & {} & {a} & {b} & {} \\\\ \\hline \\end{array} \\right.$", "input_output": [{"input": "6 8\nabdabc\n+ 1 a\n+ 1 d\n+ 2 b\n+ 2 c\n+ 3 a\n+ 3 b\n+ 1 c\n- 2\n", "output": "YES\nYES\nYES\nYES\nYES\nYES\nNO\nYES\n"}, {"input": "6 8\nabbaab\n+ 1 a\n+ 2 a\n+ 3 a\n+ 1 b\n+ 2 b\n+ 3 b\n- 1\n+ 2 z\n", "output": "YES\nYES\nYES\nYES\nYES\nNO\nYES\nNO\n"}, {"input": "1 1\nz\n+ 3 z\n", "output": "YES\n"}, {"input": "1 1\nt\n+ 2 p\n", "output": "NO\n"}, {"input": "2 12\naa\n+ 1 a\n+ 2 a\n+ 3 a\n- 1\n+ 1 a\n- 2\n+ 2 a\n- 3\n+ 3 a\n+ 2 a\n- 1\n- 3\n", "output": "YES\nYES\nNO\nYES\nNO\nYES\nNO\nYES\nNO\nNO\nNO\nYES\n"}, {"input": "2 10\nuh\n+ 1 h\n+ 2 u\n+ 3 h\n- 1\n- 2\n+ 2 h\n+ 3 u\n- 2\n+ 1 u\n- 3\n", "output": "YES\nYES\nNO\nYES\nYES\nNO\nNO\nNO\nNO\nYES\n"}]}
{"id": 2168, "question": "Greg has a weighed directed graph, consisting of n vertices. In this graph any pair of distinct vertices has an edge between them in both directions. Greg loves playing with the graph and now he has invented a new game:  The game consists of n steps.  On the i-th step Greg removes vertex number x_{i} from the graph. As Greg removes a vertex, he also removes all the edges that go in and out of this vertex.  Before executing each step, Greg wants to know the sum of lengths of the shortest paths between all pairs of the remaining vertices. The shortest path can go through any remaining vertex. In other words, if we assume that d(i, v, u) is the shortest path between vertices v and u in the graph that formed before deleting vertex x_{i}, then Greg wants to know the value of the following sum: $\\sum_{v, u, v \\neq u} d(i, v, u)$. \n\nHelp Greg, print the value of the required sum before each step.\n\n\n-----Input-----\n\nThe first line contains integer n (1 ≤ n ≤ 500) — the number of vertices in the graph.\n\nNext n lines contain n integers each — the graph adjacency matrix: the j-th number in the i-th line a_{ij} (1 ≤ a_{ij} ≤ 10^5, a_{ii} = 0) represents the weight of the edge that goes from vertex i to vertex j.\n\nThe next line contains n distinct integers: x_1, x_2, ..., x_{n} (1 ≤ x_{i} ≤ n) — the vertices that Greg deletes.\n\n\n-----Output-----\n\nPrint n integers — the i-th number equals the required sum before the i-th step.\n\nPlease, do not use the %lld specifier to read or write 64-bit integers in C++. It is preferred to use the cin, cout streams of the %I64d specifier.\n\n\n-----Examples-----\nInput\n1\n0\n1\n\nOutput\n0 \nInput\n2\n0 5\n4 0\n1 2\n\nOutput\n9 0 \nInput\n4\n0 3 1 1\n6 0 400 1\n2 4 0 1\n1 1 1 0\n4 1 2 3\n\nOutput\n17 23 404 0", "input_output": [{"input": "1\n0\n1\n", "output": "0 "}, {"input": "2\n0 5\n4 0\n1 2\n", "output": "9 0 "}, {"input": "4\n0 3 1 1\n6 0 400 1\n2 4 0 1\n1 1 1 0\n4 1 2 3\n", "output": "17 23 404 0 "}, {"input": "4\n0 57148 51001 13357\n71125 0 98369 67226\n49388 90852 0 66291\n39573 38165 97007 0\n2 3 1 4\n", "output": "723897 306638 52930 0 "}, {"input": "5\n0 27799 15529 16434 44291\n47134 0 90227 26873 52252\n41605 21269 0 9135 55784\n70744 17563 79061 0 73981\n70529 35681 91073 52031 0\n5 2 3 1 4\n", "output": "896203 429762 232508 87178 0 "}, {"input": "6\n0 72137 71041 29217 96749 46417\n40199 0 55907 57677 68590 78796\n83463 50721 0 30963 31779 28646\n94529 47831 98222 0 61665 73941\n24397 66286 2971 81613 0 52501\n26285 3381 51438 45360 20160 0\n6 3 2 4 5 1\n", "output": "1321441 1030477 698557 345837 121146 0 "}, {"input": "7\n0 34385 31901 51111 10191 14089 95685\n11396 0 8701 33277 1481 517 46253\n51313 2255 0 5948 66085 37201 65310\n21105 60985 10748 0 89271 42883 77345\n34686 29401 73565 47795 0 13793 66997\n70279 49576 62900 40002 70943 0 89601\n65045 1681 28239 12023 40414 89585 0\n3 5 7 6 1 2 4\n", "output": "1108867 1016339 729930 407114 206764 94262 0 "}, {"input": "8\n0 74961 47889 4733 72876 21399 63105 48239\n15623 0 9680 89133 57989 63401 26001 29608\n42369 82390 0 32866 46171 11871 67489 54070\n23425 80027 18270 0 28105 42657 40876 29267\n78793 18701 7655 94798 0 88885 71424 86914\n44835 76636 11553 46031 13617 0 16971 51915\n33037 53719 43116 52806 56897 71241 0 11629\n2119 62373 93265 69513 5770 90751 36619 0\n3 7 6 5 8 1 2 4\n", "output": "1450303 1188349 900316 531281 383344 219125 169160 0 "}, {"input": "9\n0 85236 27579 82251 69479 24737 87917 15149 52311\n59640 0 74687 34711 3685 30121 4961 7552 83399\n33376 68733 0 81357 18042 74297 15466 29476 5865\n7493 5601 3321 0 20263 55901 45756 55361 87633\n26751 17161 76681 40376 0 39745 50717 56887 90055\n18885 76353 47089 43601 21561 0 60571 33551 53753\n74595 877 71853 93156 97499 70876 0 22713 63961\n67725 25309 56358 92376 40641 35433 39781 0 97482\n81818 12561 85961 81445 3941 76799 31701 43725 0\n6 2 9 3 5 7 1 4 8\n", "output": "2106523 1533575 1645151 1255230 946667 618567 287636 147737 0 "}]}
{"id": 2275, "question": "Johnny has just found the new, great tutorial: \"How to become a grandmaster?\". The tutorial tells many strange and unexpected for Johnny things, such as you have to be patient or that very important is solving many harder and harder problems. \n\nThe boy has found an online judge with tasks divided by topics they cover. He has picked $p^{k_i}$ problems from $i$-th category ($p$ is his favorite number). He wants to solve them in two weeks (the patience condition is too hard for Johnny, so for simplicity, he looks only at easy tasks, which can be solved in such a period). Now our future grandmaster has to decide which topics to cover first and which the second week. Help him assign topics in such a way, that workload is balanced.\n\nFormally, given $n$ numbers $p^{k_i}$, the boy wants to divide them into two disjoint sets, minimizing the absolute difference between sums of numbers in each set. Find the minimal absolute difference. Output the result modulo $10^{9}+7$.\n\n\n-----Input-----\n\nInput consists of multiple test cases. The first line contains one integer $t$ $(1 \\leq t \\leq 10^5)$ — the number of test cases. Each test case is described as follows:\n\nThe first line contains two integers $n$ and $p$ $(1 \\leq n, p \\leq 10^6)$. The second line contains $n$ integers $k_i$ $(0 \\leq k_i \\leq 10^6)$.\n\nThe sum of $n$ over all test cases doesn't exceed $10^6$.\n\n\n-----Output-----\n\nOutput one integer — the reminder of division the answer by $1\\,000\\,000\\,007$.\n\n\n-----Example-----\nInput\n4\n5 2\n2 3 4 4 3\n3 1\n2 10 1000\n4 5\n0 1 1 100\n1 8\n89\n\nOutput\n4\n1\n146981438\n747093407\n\n\n\n-----Note-----\n\nYou have to minimize the difference, not it's remainder. For example, if the minimum difference is equal to $2$, but there is also a distribution where the difference is $10^9 + 8$, then the answer is $2$, not $1$.\n\nIn the first test case of the example, there're the following numbers: $4$, $8$, $16$, $16$, and $8$. We can divide them into such two sets: ${4, 8, 16}$ and ${8, 16}$. Then the difference between the sums of numbers in sets would be $4$.", "input_output": [{"input": "4\n5 2\n2 3 4 4 3\n3 1\n2 10 1000\n4 5\n0 1 1 100\n1 8\n89\n", "output": "4\n1\n146981438\n747093407\n"}, {"input": "1\n1 2\n88\n", "output": "140130951\n"}, {"input": "1\n20 22328\n2572 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n", "output": "1000000004\n"}]}
{"id": 2101, "question": "Ujan has a lot of useless stuff in his drawers, a considerable part of which are his math notebooks: it is time to sort them out. This time he found an old dusty graph theory notebook with a description of a graph.\n\nIt is an undirected weighted graph on $n$ vertices. It is a complete graph: each pair of vertices is connected by an edge. The weight of each edge is either $0$ or $1$; exactly $m$ edges have weight $1$, and all others have weight $0$.\n\nSince Ujan doesn't really want to organize his notes, he decided to find the weight of the minimum spanning tree of the graph. (The weight of a spanning tree is the sum of all its edges.) Can you find the answer for Ujan so he stops procrastinating?\n\n\n-----Input-----\n\nThe first line of the input contains two integers $n$ and $m$ ($1 \\leq n \\leq 10^5$, $0 \\leq m \\leq \\min(\\frac{n(n-1)}{2},10^5)$), the number of vertices and the number of edges of weight $1$ in the graph. \n\nThe $i$-th of the next $m$ lines contains two integers $a_i$ and $b_i$ ($1 \\leq a_i, b_i \\leq n$, $a_i \\neq b_i$), the endpoints of the $i$-th edge of weight $1$.\n\nIt is guaranteed that no edge appears twice in the input.\n\n\n-----Output-----\n\nOutput a single integer, the weight of the minimum spanning tree of the graph.\n\n\n-----Examples-----\nInput\n6 11\n1 3\n1 4\n1 5\n1 6\n2 3\n2 4\n2 5\n2 6\n3 4\n3 5\n3 6\n\nOutput\n2\n\nInput\n3 0\n\nOutput\n0\n\n\n\n-----Note-----\n\nThe graph from the first sample is shown below. Dashed edges have weight $0$, other edges have weight $1$. One of the minimum spanning trees is highlighted in orange and has total weight $2$. [Image] \n\nIn the second sample, all edges have weight $0$ so any spanning tree has total weight $0$.", "input_output": [{"input": "6 11\n1 3\n1 4\n1 5\n1 6\n2 3\n2 4\n2 5\n2 6\n3 4\n3 5\n3 6\n", "output": "2\n"}, {"input": "3 0\n", "output": "0\n"}, {"input": "2 0\n", "output": "0\n"}, {"input": "1 0\n", "output": "0\n"}, {"input": "2 1\n1 2\n", "output": "1\n"}, {"input": "4 2\n3 2\n1 4\n", "output": "0\n"}, {"input": "3 3\n1 2\n3 1\n2 3\n", "output": "2\n"}, {"input": "7 5\n7 5\n1 5\n3 2\n2 6\n3 6\n", "output": "0\n"}, {"input": "10 10\n1 5\n1 8\n1 9\n5 8\n8 9\n4 7\n2 3\n3 10\n2 6\n2 10\n", "output": "0\n"}, {"input": "5 10\n1 2\n2 3\n3 4\n4 5\n5 1\n1 3\n2 4\n3 5\n4 1\n5 2\n", "output": "4\n"}, {"input": "15 10\n2 3\n5 4\n5 6\n5 7\n3 8\n3 10\n11 12\n12 13\n13 14\n14 15\n", "output": "0\n"}, {"input": "100000 0\n", "output": "0\n"}]}
{"id": 2359, "question": "Given positive integers N, K and M, solve the following problem for every integer x between 1 and N (inclusive):\n - Find the number, modulo M, of non-empty multisets containing between 0 and K (inclusive) instances of each of the integers 1, 2, 3 \\cdots, N such that the average of the elements is x.\n\n-----Constraints-----\n - 1 \\leq N, K \\leq 100\n - 10^8 \\leq M \\leq 10^9 + 9\n - M is prime.\n - All values in input are integers.\n\n-----Input-----\nInput is given from Standard Input in the following format:\nN K M\n\n-----Output-----\nUse the following format:\nc_1\nc_2\n:\nc_N\n\nHere, c_x should be the number, modulo M, of multisets such that the average of the elements is x.\n\n-----Sample Input-----\n3 1 998244353\n\n-----Sample Output-----\n1\n3\n1\n\nConsider non-empty multisets containing between 0 and 1 instance(s) of each of the integers between 1 and 3. Among them, there are:\n - one multiset such that the average of the elements is k = 1: \\{1\\};\n - three multisets such that the average of the elements is k = 2: \\{2\\}, \\{1, 3\\}, \\{1, 2, 3\\};\n - one multiset such that the average of the elements is k = 3: \\{3\\}.", "input_output": [{"input": "3 1 998244353\n", "output": "1\n3\n1\n"}, {"input": "1 2 1000000007\n", "output": "2\n"}, {"input": "10 8 861271909\n", "output": "8\n602\n81827\n4054238\n41331779\n41331779\n4054238\n81827\n602\n8\n"}, {"input": "2 1 905589253\n", "output": "1\n1\n"}, {"input": "14 19 964292983\n", "output": "19\n40239\n116285439\n44188045\n615501833\n534054421\n694441861\n694441861\n534054421\n615501833\n44188045\n116285439\n40239\n19\n"}, {"input": "24 26 804695321\n", "output": "26\n316385\n587325446\n562348028\n259395159\n735586658\n540711096\n448382968\n646169129\n665286086\n740680401\n638151860\n638151860\n740680401\n665286086\n646169129\n448382968\n540711096\n735586658\n259395159\n562348028\n587325446\n316385\n26\n"}, {"input": "39 36 991399517\n", "output": "36\n3667920\n990929167\n858401463\n60493630\n785191252\n714265038\n453588092\n382455915\n582064241\n401317628\n441250455\n403968890\n230277786\n432651121\n410095141\n951960058\n916461902\n641905774\n948722200\n641905774\n916461902\n951960058\n410095141\n432651121\n230277786\n403968890\n441250455\n401317628\n582064241\n382455915\n453588092\n714265038\n785191252\n60493630\n858401463\n990929167\n3667920\n36\n"}, {"input": "46 46 961455263\n", "output": "46\n30370929\n166679864\n575290604\n194798504\n252130064\n445139667\n765778720\n850511791\n84674874\n116060159\n145552585\n387190100\n700612085\n942254961\n156013598\n731283537\n729273362\n945901131\n779104366\n172673174\n208486221\n861159317\n861159317\n208486221\n172673174\n779104366\n945901131\n729273362\n731283537\n156013598\n942254961\n700612085\n387190100\n145552585\n116060159\n84674874\n850511791\n765778720\n445139667\n252130064\n194798504\n575290604\n166679864\n30370929\n46\n"}, {"input": "60 55 931711961\n", "output": "55\n167152439\n128555668\n452169460\n643905949\n564166013\n107864137\n829142158\n441763502\n504605298\n881084581\n745369157\n165726026\n347696005\n335989092\n224952495\n581117185\n108036073\n23523713\n890135712\n292644259\n89593977\n548089517\n38923823\n577648100\n401357148\n249060686\n489717600\n558942321\n63131721\n63131721\n558942321\n489717600\n249060686\n401357148\n577648100\n38923823\n548089517\n89593977\n292644259\n890135712\n23523713\n108036073\n581117185\n224952495\n335989092\n347696005\n165726026\n745369157\n881084581\n504605298\n441763502\n829142158\n107864137\n564166013\n643905949\n452169460\n128555668\n167152439\n55\n"}, {"input": "64 64 879068783\n", "output": "64\n800028839\n273410689\n196010624\n312953380\n227966059\n861538616\n217255633\n551899524\n272244211\n529845574\n363735259\n82493642\n864217314\n260504844\n624735861\n777035883\n168402978\n60765332\n70545429\n703637526\n112727240\n298194780\n873071920\n613410636\n624439078\n129940147\n656653400\n554594139\n519526204\n586168365\n613826896\n613826896\n586168365\n519526204\n554594139\n656653400\n129940147\n624439078\n613410636\n873071920\n298194780\n112727240\n703637526\n70545429\n60765332\n168402978\n777035883\n624735861\n260504844\n864217314\n82493642\n363735259\n529845574\n272244211\n551899524\n217255633\n861538616\n227966059\n312953380\n196010624\n273410689\n800028839\n64\n"}, {"input": "75 77 988580261\n", "output": "77\n421332563\n185730875\n360429166\n675372404\n881609639\n484733434\n634909079\n103284953\n925194231\n264709881\n123064656\n502896411\n644256875\n967090113\n333204169\n966807529\n626419932\n488814458\n208653026\n689831686\n979969185\n837738878\n843170164\n390592437\n274900757\n230073000\n23105152\n399821886\n853236996\n535025854\n628541071\n444492493\n947338316\n422517124\n190711625\n699376661\n435761061\n699376661\n190711625\n422517124\n947338316\n444492493\n628541071\n535025854\n853236996\n399821886\n23105152\n230073000\n274900757\n390592437\n843170164\n837738878\n979969185\n689831686\n208653026\n488814458\n626419932\n966807529\n333204169\n967090113\n644256875\n502896411\n123064656\n264709881\n925194231\n103284953\n634909079\n484733434\n881609639\n675372404\n360429166\n185730875\n421332563\n77\n"}, {"input": "89 89 942910693\n", "output": "89\n39936542\n195454156\n656721203\n631357927\n217894594\n154160725\n638317552\n840343374\n174218327\n425232179\n1907817\n221399060\n55623559\n449859916\n461977473\n524410836\n443896072\n234283060\n570186728\n299135533\n47682698\n540920573\n561289612\n25067383\n813997840\n918322355\n877125510\n438792625\n646455342\n644567581\n890924735\n81674404\n355946581\n926266101\n254402052\n641374921\n393575974\n399528713\n92571866\n589016560\n708936745\n420527488\n549659078\n273155421\n549659078\n420527488\n708936745\n589016560\n92571866\n399528713\n393575974\n641374921\n254402052\n926266101\n355946581\n81674404\n890924735\n644567581\n646455342\n438792625\n877125510\n918322355\n813997840\n25067383\n561289612\n540920573\n47682698\n299135533\n570186728\n234283060\n443896072\n524410836\n461977473\n449859916\n55623559\n221399060\n1907817\n425232179\n174218327\n840343374\n638317552\n154160725\n217894594\n631357927\n656721203\n195454156\n39936542\n89\n"}, {"input": "94 94 826395733\n", "output": "94\n265647617\n387893472\n738066733\n86520619\n656163016\n405429313\n815078307\n443616344\n512145331\n542638582\n288885865\n666773848\n709611994\n646076824\n247485371\n446663954\n246800688\n649240945\n265806909\n152772875\n515165398\n187931766\n759636807\n199845139\n428693396\n67862667\n647890913\n760379559\n752677492\n667415202\n812228423\n510963606\n794915058\n17109908\n628664401\n485963811\n625518961\n92045152\n802943188\n746052666\n507545653\n517587489\n427928558\n470452524\n321506149\n131834334\n131834334\n321506149\n470452524\n427928558\n517587489\n507545653\n746052666\n802943188\n92045152\n625518961\n485963811\n628664401\n17109908\n794915058\n510963606\n812228423\n667415202\n752677492\n760379559\n647890913\n67862667\n428693396\n199845139\n759636807\n187931766\n515165398\n152772875\n265806909\n649240945\n246800688\n446663954\n247485371\n646076824\n709611994\n666773848\n288885865\n542638582\n512145331\n443616344\n815078307\n405429313\n656163016\n86520619\n738066733\n387893472\n265647617\n94\n"}, {"input": "96 90 819042001\n", "output": "90\n605059907\n198354410\n673849386\n154926763\n134866344\n8143772\n133537054\n538291720\n521277234\n592295168\n203941089\n238588787\n452945189\n814482829\n494205724\n669134365\n22231530\n282834938\n124550795\n786873606\n198947801\n518473614\n62028843\n365088103\n243952808\n548001686\n441376661\n175994898\n531078863\n753716927\n736722144\n192384599\n400227229\n385944721\n612335759\n497648657\n294111241\n395772069\n583481712\n258116318\n352563916\n301818365\n39031126\n154208355\n530213436\n621647514\n172670134\n172670134\n621647514\n530213436\n154208355\n39031126\n301818365\n352563916\n258116318\n583481712\n395772069\n294111241\n497648657\n612335759\n385944721\n400227229\n192384599\n736722144\n753716927\n531078863\n175994898\n441376661\n548001686\n243952808\n365088103\n62028843\n518473614\n198947801\n786873606\n124550795\n282834938\n22231530\n669134365\n494205724\n814482829\n452945189\n238588787\n203941089\n592295168\n521277234\n538291720\n133537054\n8143772\n134866344\n154926763\n673849386\n198354410\n605059907\n90\n"}, {"input": "99 96 867494357\n", "output": "96\n685266867\n527860958\n789289317\n713564179\n257781899\n508052569\n104685750\n389322717\n501801759\n772987295\n796745275\n698454400\n43415064\n202285109\n352495965\n125867619\n204240242\n413335850\n850872935\n550672387\n79471915\n64271624\n200594784\n716610756\n5761613\n715198701\n353401623\n61922631\n226677476\n272502365\n379041771\n551125092\n118531346\n62521874\n235953669\n814328146\n540492797\n331642406\n174779148\n268311874\n571246065\n768120496\n508250596\n216464438\n6807407\n279555138\n563007377\n226571514\n276909105\n226571514\n563007377\n279555138\n6807407\n216464438\n508250596\n768120496\n571246065\n268311874\n174779148\n331642406\n540492797\n814328146\n235953669\n62521874\n118531346\n551125092\n379041771\n272502365\n226677476\n61922631\n353401623\n715198701\n5761613\n716610756\n200594784\n64271624\n79471915\n550672387\n850872935\n413335850\n204240242\n125867619\n352495965\n202285109\n43415064\n698454400\n796745275\n772987295\n501801759\n389322717\n104685750\n508052569\n257781899\n713564179\n789289317\n527860958\n685266867\n96\n"}, {"input": "93 90 952438633\n", "output": "90\n468902106\n485522357\n689600349\n346418139\n519338271\n810724072\n897803765\n64130697\n596372297\n465126204\n153828222\n573899326\n163922387\n258187325\n478590158\n867882463\n407682638\n304803105\n731744538\n344115139\n650567430\n5381611\n357554030\n327622805\n31048393\n127295835\n609753679\n115362652\n812800874\n779982579\n756428708\n445446657\n735981697\n125553883\n512144322\n896302026\n828192680\n670960735\n269693996\n516441322\n707196425\n441384939\n660859365\n597885806\n66815060\n115095319\n66815060\n597885806\n660859365\n441384939\n707196425\n516441322\n269693996\n670960735\n828192680\n896302026\n512144322\n125553883\n735981697\n445446657\n756428708\n779982579\n812800874\n115362652\n609753679\n127295835\n31048393\n327622805\n357554030\n5381611\n650567430\n344115139\n731744538\n304803105\n407682638\n867882463\n478590158\n258187325\n163922387\n573899326\n153828222\n465126204\n596372297\n64130697\n897803765\n810724072\n519338271\n346418139\n689600349\n485522357\n468902106\n90\n"}, {"input": "99 97 849572149\n", "output": "97\n589156599\n413310414\n399392037\n735443568\n656304478\n685373311\n56971929\n368708146\n820048313\n769297270\n545603290\n654387200\n637238807\n275596041\n638866195\n628642797\n230183692\n623776482\n765354019\n410591775\n457328422\n77533099\n729425767\n278214124\n658483227\n674143923\n504019775\n824605928\n644153286\n271263992\n391336921\n206818896\n755033913\n623313116\n599798791\n355088061\n459910242\n791189018\n637243903\n183102384\n232445783\n216439644\n460942725\n437526552\n231405479\n300621429\n841239066\n166285887\n635742144\n166285887\n841239066\n300621429\n231405479\n437526552\n460942725\n216439644\n232445783\n183102384\n637243903\n791189018\n459910242\n355088061\n599798791\n623313116\n755033913\n206818896\n391336921\n271263992\n644153286\n824605928\n504019775\n674143923\n658483227\n278214124\n729425767\n77533099\n457328422\n410591775\n765354019\n623776482\n230183692\n628642797\n638866195\n275596041\n637238807\n654387200\n545603290\n769297270\n820048313\n368708146\n56971929\n685373311\n656304478\n735443568\n399392037\n413310414\n589156599\n97\n"}, {"input": "100 100 996766481\n", "output": "100\n479013218\n301906461\n76865454\n197164919\n185261994\n562146154\n218533225\n703919664\n761757943\n421733444\n150668448\n939625796\n441056419\n399708797\n265484256\n872130614\n530113978\n956321625\n942851863\n391142590\n196625433\n784864879\n819183001\n159683454\n296917015\n221161941\n731209317\n448421227\n627343466\n96812703\n658830978\n929743853\n634638996\n987997473\n521196870\n640660350\n267753320\n902541346\n262706763\n514447345\n954420281\n621769349\n892390620\n720449512\n837536064\n273041385\n337735532\n151628949\n784376865\n784376865\n151628949\n337735532\n273041385\n837536064\n720449512\n892390620\n621769349\n954420281\n514447345\n262706763\n902541346\n267753320\n640660350\n521196870\n987997473\n634638996\n929743853\n658830978\n96812703\n627343466\n448421227\n731209317\n221161941\n296917015\n159683454\n819183001\n784864879\n196625433\n391142590\n942851863\n956321625\n530113978\n872130614\n265484256\n399708797\n441056419\n939625796\n150668448\n421733444\n761757943\n703919664\n218533225\n562146154\n185261994\n197164919\n76865454\n301906461\n479013218\n100\n"}, {"input": "1 1 1000000009\n", "output": "1\n"}, {"input": "77 47 984380351\n", "output": "47\n37005455\n655827090\n841853556\n611622803\n578616110\n121504566\n284904675\n891634360\n377336782\n74305742\n400674303\n40726716\n231832902\n540371916\n61720624\n426204166\n713024598\n887235048\n629982900\n18435119\n586810591\n459813654\n240930967\n281061283\n475993101\n885733307\n398851052\n327924289\n346318481\n367661460\n612707707\n708292758\n809657216\n892969100\n73795181\n88286917\n935190393\n945731063\n935190393\n88286917\n73795181\n892969100\n809657216\n708292758\n612707707\n367661460\n346318481\n327924289\n398851052\n885733307\n475993101\n281061283\n240930967\n459813654\n586810591\n18435119\n629982900\n887235048\n713024598\n426204166\n61720624\n540371916\n231832902\n40726716\n400674303\n74305742\n377336782\n891634360\n284904675\n121504566\n578616110\n611622803\n841853556\n655827090\n37005455\n47\n"}, {"input": "69 15 857601697\n", "output": "15\n10943\n25350255\n528980058\n565392555\n490875203\n751016925\n116301690\n327562015\n256781058\n831969974\n397081586\n605439049\n625311459\n64045373\n376722122\n591803433\n356268338\n542636205\n625267543\n578345629\n297436059\n65991694\n796883879\n221304789\n513275577\n520270726\n261893767\n634531775\n192703632\n186961710\n552544729\n70149983\n832033597\n483172204\n832033597\n70149983\n552544729\n186961710\n192703632\n634531775\n261893767\n520270726\n513275577\n221304789\n796883879\n65991694\n297436059\n578345629\n625267543\n542636205\n356268338\n591803433\n376722122\n64045373\n625311459\n605439049\n397081586\n831969974\n256781058\n327562015\n116301690\n751016925\n490875203\n565392555\n528980058\n25350255\n10943\n15\n"}, {"input": "42 94 907502863\n", "output": "94\n854567507\n188138242\n470085043\n455355673\n700530208\n656215169\n812522729\n463091752\n311387076\n205298231\n578306483\n182314350\n607901635\n163659300\n720202715\n792949911\n252979813\n528672464\n198746271\n30368013\n30368013\n198746271\n528672464\n252979813\n792949911\n720202715\n163659300\n607901635\n182314350\n578306483\n205298231\n311387076\n463091752\n812522729\n656215169\n700530208\n455355673\n470085043\n188138242\n854567507\n94\n"}, {"input": "25 38 900878039\n", "output": "38\n5655545\n464939347\n500668393\n269881226\n392721252\n665197363\n554583516\n778381832\n863024566\n587384571\n782714127\n393342842\n782714127\n587384571\n863024566\n778381832\n554583516\n665197363\n392721252\n269881226\n500668393\n464939347\n5655545\n38\n"}]}
{"id": 2021, "question": "Recently, Pari and Arya did some research about NP-Hard problems and they found the minimum vertex cover problem very interesting.\n\nSuppose the graph G is given. Subset A of its vertices is called a vertex cover of this graph, if for each edge uv there is at least one endpoint of it in this set, i.e. $u \\in A$ or $v \\in A$ (or both).\n\nPari and Arya have won a great undirected graph as an award in a team contest. Now they have to split it in two parts, but both of them want their parts of the graph to be a vertex cover.\n\nThey have agreed to give you their graph and you need to find two disjoint subsets of its vertices A and B, such that both A and B are vertex cover or claim it's impossible. Each vertex should be given to no more than one of the friends (or you can even keep it for yourself).\n\n\n-----Input-----\n\nThe first line of the input contains two integers n and m (2 ≤ n ≤ 100 000, 1 ≤ m ≤ 100 000) — the number of vertices and the number of edges in the prize graph, respectively.\n\nEach of the next m lines contains a pair of integers u_{i} and v_{i} (1  ≤  u_{i},  v_{i}  ≤  n), denoting an undirected edge between u_{i} and v_{i}. It's guaranteed the graph won't contain any self-loops or multiple edges.\n\n\n-----Output-----\n\nIf it's impossible to split the graph between Pari and Arya as they expect, print \"-1\" (without quotes).\n\nIf there are two disjoint sets of vertices, such that both sets are vertex cover, print their descriptions. Each description must contain two lines. The first line contains a single integer k denoting the number of vertices in that vertex cover, and the second line contains k integers — the indices of vertices. Note that because of m ≥ 1, vertex cover cannot be empty.\n\n\n-----Examples-----\nInput\n4 2\n1 2\n2 3\n\nOutput\n1\n2 \n2\n1 3 \n\nInput\n3 3\n1 2\n2 3\n1 3\n\nOutput\n-1\n\n\n\n-----Note-----\n\nIn the first sample, you can give the vertex number 2 to Arya and vertices numbered 1 and 3 to Pari and keep vertex number 4 for yourself (or give it someone, if you wish).\n\nIn the second sample, there is no way to satisfy both Pari and Arya.", "input_output": [{"input": "4 2\n1 2\n2 3\n", "output": "1\n2 \n2\n1 3 \n"}, {"input": "3 3\n1 2\n2 3\n1 3\n", "output": "-1\n"}, {"input": "5 7\n3 2\n5 4\n3 4\n1 3\n1 5\n1 4\n2 5\n", "output": "-1\n"}, {"input": "10 11\n4 10\n8 10\n2 3\n2 4\n7 1\n8 5\n2 8\n7 2\n1 2\n2 9\n6 8\n", "output": "-1\n"}, {"input": "10 9\n2 5\n2 4\n2 7\n2 9\n2 3\n2 8\n2 6\n2 10\n2 1\n", "output": "1\n2 \n9\n1 5 4 7 9 3 8 6 10 \n"}, {"input": "10 16\n6 10\n5 2\n6 4\n6 8\n5 3\n5 4\n6 2\n5 9\n5 7\n5 1\n6 9\n5 8\n5 10\n6 1\n6 7\n6 3\n", "output": "2\n5 6 \n8\n1 2 10 4 8 9 7 3 \n"}, {"input": "10 17\n5 1\n8 1\n2 1\n2 6\n3 1\n5 7\n3 7\n8 6\n4 7\n2 7\n9 7\n10 7\n3 6\n4 1\n9 1\n8 7\n10 1\n", "output": "7\n5 3 2 8 4 9 10 \n3\n1 7 6 \n"}, {"input": "10 15\n5 9\n7 8\n2 9\n1 9\n3 8\n3 9\n5 8\n1 8\n6 9\n7 9\n4 8\n4 9\n10 9\n10 8\n6 8\n", "output": "2\n9 8 \n8\n1 5 7 3 4 10 6 2 \n"}, {"input": "10 9\n4 9\n1 9\n10 9\n2 9\n3 9\n6 9\n5 9\n7 9\n8 9\n", "output": "1\n9 \n9\n1 4 10 2 3 6 5 7 8 \n"}, {"input": "2 1\n1 2\n", "output": "1\n2 \n1\n1 \n"}, {"input": "10 10\n6 4\n9 1\n3 6\n6 7\n4 2\n9 6\n8 6\n5 7\n1 4\n6 10\n", "output": "6\n9 4 3 7 8 10 \n4\n1 6 2 5 \n"}, {"input": "20 22\n20 8\n1 3\n3 18\n14 7\n19 6\n7 20\n14 8\n8 10\n2 5\n11 2\n4 19\n14 2\n7 11\n15 1\n12 15\n7 6\n11 13\n1 16\n9 12\n1 19\n17 3\n11 20\n", "output": "-1\n"}, {"input": "20 22\n3 18\n9 19\n6 15\n7 1\n16 8\n18 7\n12 3\n18 4\n9 15\n20 1\n4 2\n6 7\n14 2\n7 15\n7 10\n8 1\n13 6\n9 7\n11 8\n2 6\n18 5\n17 15\n", "output": "-1\n"}, {"input": "1000 1\n839 771\n", "output": "1\n839 \n1\n771 \n"}, {"input": "1000 1\n195 788\n", "output": "1\n788 \n1\n195 \n"}, {"input": "100000 1\n42833 64396\n", "output": "1\n64396 \n1\n42833 \n"}, {"input": "100000 1\n26257 21752\n", "output": "1\n26257 \n1\n21752 \n"}, {"input": "5 5\n1 2\n2 3\n3 4\n4 5\n5 1\n", "output": "-1\n"}]}
{"id": 2308, "question": "You are given $n$ arrays that can have different sizes. You also have a table with $w$ columns and $n$ rows. The $i$-th array is placed horizontally in the $i$-th row. You can slide each array within its row as long as it occupies several consecutive cells and lies completely inside the table.\n\nYou need to find the maximum sum of the integers in the $j$-th column for each $j$ from $1$ to $w$ independently.\n\n [Image] Optimal placements for columns $1$, $2$ and $3$ are shown on the pictures from left to right. \n\nNote that you can exclude any array out of a column provided it remains in the window. In this case its value is considered to be zero.\n\n\n-----Input-----\n\nThe first line contains two integers $n$ ($1 \\le n \\le 10^{6}$) and $w$ ($1 \\le w \\le 10^{6}$) — the number of arrays and the width of the table.\n\nEach of the next $n$ lines consists of an integer $l_{i}$ ($1 \\le l_{i} \\le w$), the length of the $i$-th array, followed by $l_{i}$ integers $a_{i1}, a_{i2}, \\ldots, a_{il_i}$ ($-10^{9} \\le a_{ij} \\le 10^{9}$) — the elements of the array.\n\nThe total length of the arrays does no exceed $10^{6}$.\n\n\n-----Output-----\n\nPrint $w$ integers, the $i$-th of them should be the maximum sum for column $i$.\n\n\n-----Examples-----\nInput\n3 3\n3 2 4 8\n2 2 5\n2 6 3\n\nOutput\n10 15 16 \n\nInput\n2 2\n2 7 8\n1 -8\n\nOutput\n7 8 \n\n\n\n-----Note-----\n\nIllustration for the first example is in the statement.", "input_output": [{"input": "3 3\n3 2 4 8\n2 2 5\n2 6 3\n", "output": "10 15 16 \n"}, {"input": "2 2\n2 7 8\n1 -8\n", "output": "7 8 \n"}]}
{"id": 2071, "question": "Watchmen are in a danger and Doctor Manhattan together with his friend Daniel Dreiberg should warn them as soon as possible. There are n watchmen on a plane, the i-th watchman is located at point (x_{i}, y_{i}).\n\nThey need to arrange a plan, but there are some difficulties on their way. As you know, Doctor Manhattan considers the distance between watchmen i and j to be |x_{i} - x_{j}| + |y_{i} - y_{j}|. Daniel, as an ordinary person, calculates the distance using the formula $\\sqrt{(x_{i} - x_{j})^{2} +(y_{i} - y_{j})^{2}}$.\n\nThe success of the operation relies on the number of pairs (i, j) (1 ≤ i < j ≤ n), such that the distance between watchman i and watchmen j calculated by Doctor Manhattan is equal to the distance between them calculated by Daniel. You were asked to compute the number of such pairs.\n\n\n-----Input-----\n\nThe first line of the input contains the single integer n (1 ≤ n ≤ 200 000) — the number of watchmen.\n\nEach of the following n lines contains two integers x_{i} and y_{i} (|x_{i}|, |y_{i}| ≤ 10^9).\n\nSome positions may coincide.\n\n\n-----Output-----\n\nPrint the number of pairs of watchmen such that the distance between them calculated by Doctor Manhattan is equal to the distance calculated by Daniel.\n\n\n-----Examples-----\nInput\n3\n1 1\n7 5\n1 5\n\nOutput\n2\n\nInput\n6\n0 0\n0 1\n0 2\n-1 1\n0 1\n1 1\n\nOutput\n11\n\n\n\n-----Note-----\n\nIn the first sample, the distance between watchman 1 and watchman 2 is equal to |1 - 7| + |1 - 5| = 10 for Doctor Manhattan and $\\sqrt{(1 - 7)^{2} +(1 - 5)^{2}} = 2 \\cdot \\sqrt{13}$ for Daniel. For pairs (1, 1), (1, 5) and (7, 5), (1, 5) Doctor Manhattan and Daniel will calculate the same distances.", "input_output": [{"input": "3\n1 1\n7 5\n1 5\n", "output": "2\n"}, {"input": "6\n0 0\n0 1\n0 2\n-1 1\n0 1\n1 1\n", "output": "11\n"}, {"input": "10\n46 -55\n46 45\n46 45\n83 -55\n46 45\n83 -55\n46 45\n83 45\n83 45\n46 -55\n", "output": "33\n"}, {"input": "1\n-5 -90\n", "output": "0\n"}, {"input": "2\n315 845\n-669 -762\n", "output": "0\n"}, {"input": "3\n8911 7861\n-6888 7861\n8911 7861\n", "output": "3\n"}, {"input": "2\n-1 1000000000\n0 -1\n", "output": "0\n"}, {"input": "2\n1000000000 0\n-7 1\n", "output": "0\n"}, {"input": "2\n1 4\n2 1\n", "output": "0\n"}, {"input": "2\n1 0\n0 2333333\n", "output": "0\n"}, {"input": "2\n2 1\n1 2\n", "output": "0\n"}, {"input": "2\n1 1000000000\n2 -1000000000\n", "output": "0\n"}, {"input": "2\n0 1000000000\n1 -7\n", "output": "0\n"}, {"input": "2\n1 0\n0 19990213\n", "output": "0\n"}]}
{"id": 2046, "question": "Farmer John has just given the cows a program to play with! The program contains two integer variables, x and y, and performs the following operations on a sequence a_1, a_2, ..., a_{n} of positive integers:  Initially, x = 1 and y = 0. If, after any step, x ≤ 0 or x > n, the program immediately terminates.  The program increases both x and y by a value equal to a_{x} simultaneously.  The program now increases y by a_{x} while decreasing x by a_{x}.  The program executes steps 2 and 3 (first step 2, then step 3) repeatedly until it terminates (it may never terminate). So, the sequence of executed steps may start with: step 2, step 3, step 2, step 3, step 2 and so on. \n\nThe cows are not very good at arithmetic though, and they want to see how the program works. Please help them!\n\nYou are given the sequence a_2, a_3, ..., a_{n}. Suppose for each i (1 ≤ i ≤ n - 1) we run the program on the sequence i, a_2, a_3, ..., a_{n}. For each such run output the final value of y if the program terminates or -1 if it does not terminate.\n\n\n-----Input-----\n\nThe first line contains a single integer, n (2 ≤ n ≤ 2·10^5). The next line contains n - 1 space separated integers, a_2, a_3, ..., a_{n} (1 ≤ a_{i} ≤ 10^9).\n\n\n-----Output-----\n\nOutput n - 1 lines. On the i-th line, print the requested value when the program is run on the sequence i, a_2, a_3, ...a_{n}.\n\nPlease do not use the %lld specifier to read or write 64-bit integers in С++. It is preferred to use the cin, cout streams or the %I64d specifier.\n\n\n-----Examples-----\nInput\n4\n2 4 1\n\nOutput\n3\n6\n8\n\nInput\n3\n1 2\n\nOutput\n-1\n-1\n\n\n\n-----Note-----\n\nIn the first sample   For i = 1,  x becomes $1 \\rightarrow 2 \\rightarrow 0$ and y becomes 1 + 2 = 3.  For i = 2,  x becomes $1 \\rightarrow 3 \\rightarrow - 1$ and y becomes 2 + 4 = 6.  For i = 3,  x becomes $1 \\rightarrow 4 \\rightarrow 3 \\rightarrow 7$ and y becomes 3 + 1 + 4 = 8.", "input_output": [{"input": "4\n2 4 1\n", "output": "3\n6\n8\n"}, {"input": "3\n1 2\n", "output": "-1\n-1\n"}, {"input": "5\n2 2 1 3\n", "output": "3\n-1\n-1\n-1\n"}, {"input": "2\n1\n", "output": "-1\n"}, {"input": "8\n7 6 2 6 2 6 6\n", "output": "8\n8\n12\n10\n-1\n-1\n20\n"}, {"input": "8\n4 5 3 2 3 3 3\n", "output": "5\n7\n-1\n-1\n-1\n-1\n-1\n"}, {"input": "3\n1 1\n", "output": "-1\n-1\n"}, {"input": "5\n3 2 4 2\n", "output": "4\n-1\n7\n-1\n"}, {"input": "10\n6 7 5 3 1 5 2 4 6\n", "output": "7\n9\n8\n-1\n-1\n-1\n-1\n-1\n-1\n"}, {"input": "8\n6 311942309 3 1 3 2 2\n", "output": "7\n311942311\n-1\n311942323\n311942317\n311942321\n12\n"}, {"input": "8\n2 3 1 2 2 3 3\n", "output": "3\n5\n-1\n-1\n-1\n-1\n-1\n"}, {"input": "6\n2 1 2 2 3\n", "output": "3\n-1\n-1\n-1\n-1\n"}, {"input": "23\n20 1 3 3 13 11 9 7 5 3 1 7 2 4 6 8 10 12 14 16 12 5\n", "output": "21\n-1\n-1\n-1\n18\n17\n16\n-1\n26\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n48\n-1\n37\n"}, {"input": "71\n28 11 39 275858941 64 69 66 18 468038892 49 47 45 43 41 39 37 35 33 31 29 27 25 23 21 19 17 15 13 11 9 7 5 3 1 25 2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46 48 50 701366631 51 25 11 11 49 33 67 43 57\n", "output": "29\n13\n42\n275858945\n69\n75\n73\n26\n468038901\n59\n58\n57\n56\n55\n54\n53\n52\n51\n50\n49\n48\n47\n-1\n-1\n113\n468038935\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n701366692\n-1\n-1\n111\n114\n-1\n-1\n-1\n-1\n-1\n"}, {"input": "23\n11 6 21 9 13 11 9 7 5 3 1 8 2 4 6 8 10 12 14 935874687 21 1\n", "output": "12\n8\n24\n13\n18\n17\n16\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n-1\n935874707\n-1\n44\n"}, {"input": "71\n2 50 62 41 50 16 65 6 49 47 45 43 41 39 37 35 33 31 29 27 25 23 21 19 17 15 13 11 9 7 5 3 1 26 2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46 48 50 14 6 67 54 54 620768469 637608010 27 54 18 49\n", "output": "3\n52\n65\n45\n55\n22\n72\n801\n58\n57\n56\n55\n54\n53\n52\n51\n50\n49\n48\n47\n46\n45\n831\n1067\n87\n1147\n891\n671\n487\n339\n227\n151\n111\n105\n109\n117\n129\n145\n165\n189\n217\n249\n285\n325\n369\n417\n469\n525\n585\n649\n717\n789\n865\n945\n1029\n1117\n1209\n1305\n1405\n543\n109\n129\n1413\n1317\n620768534\n637608076\n843\n973\n121\n515\n"}]}
{"id": 2161, "question": "Just to remind, girls in Arpa's land are really nice.\n\nMehrdad wants to invite some Hoses to the palace for a dancing party. Each Hos has some weight w_{i} and some beauty b_{i}. Also each Hos may have some friends. Hoses are divided in some friendship groups. Two Hoses x and y are in the same friendship group if and only if there is a sequence of Hoses a_1, a_2, ..., a_{k} such that a_{i} and a_{i} + 1 are friends for each 1 ≤ i < k, and a_1 = x and a_{k} = y.\n\n [Image] \n\nArpa allowed to use the amphitheater of palace to Mehrdad for this party. Arpa's amphitheater can hold at most w weight on it. \n\nMehrdad is so greedy that he wants to invite some Hoses such that sum of their weights is not greater than w and sum of their beauties is as large as possible. Along with that, from each friendship group he can either invite all Hoses, or no more than one. Otherwise, some Hoses will be hurt. Find for Mehrdad the maximum possible total beauty of Hoses he can invite so that no one gets hurt and the total weight doesn't exceed w.\n\n\n-----Input-----\n\nThe first line contains integers n, m and w (1  ≤  n  ≤  1000, $0 \\leq m \\leq \\operatorname{min}(\\frac{n \\cdot(n - 1)}{2}, 10^{5})$, 1 ≤ w ≤ 1000) — the number of Hoses, the number of pair of friends and the maximum total weight of those who are invited.\n\nThe second line contains n integers w_1, w_2, ..., w_{n} (1 ≤ w_{i} ≤ 1000) — the weights of the Hoses.\n\nThe third line contains n integers b_1, b_2, ..., b_{n} (1 ≤ b_{i} ≤ 10^6) — the beauties of the Hoses.\n\nThe next m lines contain pairs of friends, the i-th of them contains two integers x_{i} and y_{i} (1 ≤ x_{i}, y_{i} ≤ n, x_{i} ≠ y_{i}), meaning that Hoses x_{i} and y_{i} are friends. Note that friendship is bidirectional. All pairs (x_{i}, y_{i}) are distinct.\n\n\n-----Output-----\n\nPrint the maximum possible total beauty of Hoses Mehrdad can invite so that no one gets hurt and the total weight doesn't exceed w.\n\n\n-----Examples-----\nInput\n3 1 5\n3 2 5\n2 4 2\n1 2\n\nOutput\n6\n\nInput\n4 2 11\n2 4 6 6\n6 4 2 1\n1 2\n2 3\n\nOutput\n7\n\n\n\n-----Note-----\n\nIn the first sample there are two friendship groups: Hoses {1, 2} and Hos {3}. The best way is to choose all of Hoses in the first group, sum of their weights is equal to 5 and sum of their beauty is 6.\n\nIn the second sample there are two friendship groups: Hoses {1, 2, 3} and Hos {4}. Mehrdad can't invite all the Hoses from the first group because their total weight is 12 > 11, thus the best way is to choose the first Hos from the first group and the only one from the second group. The total weight will be 8, and the total beauty will be 7.", "input_output": [{"input": "3 1 5\n3 2 5\n2 4 2\n1 2\n", "output": "6\n"}, {"input": "4 2 11\n2 4 6 6\n6 4 2 1\n1 2\n2 3\n", "output": "7\n"}, {"input": "10 5 100\n70 67 8 64 28 82 18 61 82 7\n596434 595982 237932 275698 361351 850374 936914 877996 789231 331012\n1 7\n2 4\n3 6\n5 7\n1 5\n", "output": "2383854\n"}, {"input": "10 5 100\n64 90 3 94 96 97 52 54 82 31\n796554 444893 214351 43810 684158 555762 686198 339093 383018 699152\n6 8\n8 3\n3 9\n2 3\n10 3\n", "output": "1495706\n"}, {"input": "10 5 100\n6 18 35 6 87 58 4 53 37 71\n465782 57034 547741 748298 315223 370368 679320 349012 9740 622511\n1 2\n10 9\n6 7\n3 6\n7 1\n", "output": "2050129\n"}, {"input": "10 5 100\n78 89 3 2 95 96 87 11 13 60\n694709 921 799687 428614 221900 536251 117674 36488 219932 771513\n4 5\n3 4\n6 2\n2 3\n8 3\n", "output": "1791132\n"}, {"input": "10 5 100\n48 73 30 46 95 19 98 73 94 24\n501216 675859 843572 565104 879875 828759 80776 766980 213551 492652\n1 2\n6 5\n7 6\n10 3\n8 1\n", "output": "2237435\n"}, {"input": "10 5 100\n68 55 15 94 53 100 52 68 24 3\n286803 660813 226501 624597 215418 290774 416040 961916 910482 50278\n1 5\n7 2\n2 8\n5 3\n10 3\n", "output": "1922676\n"}, {"input": "10 5 100\n19 8 95 18 9 79 42 94 20 49\n735491 935681 717266 935275 521356 866021 356037 394445 589369 585077\n9 4\n5 6\n5 1\n1 4\n7 1\n", "output": "2456033\n"}]}
{"id": 2341, "question": "You and your $n - 1$ friends have found an array of integers $a_1, a_2, \\dots, a_n$. You have decided to share it in the following way: All $n$ of you stand in a line in a particular order. Each minute, the person at the front of the line chooses either the first or the last element of the array, removes it, and keeps it for himself. He then gets out of line, and the next person in line continues the process.\n\nYou are standing in the $m$-th position in the line. Before the process starts, you may choose up to $k$ different people in the line, and persuade them to always take either the first or the last element in the array on their turn (for each person his own choice, not necessarily equal for all people), no matter what the elements themselves are. Once the process starts, you cannot persuade any more people, and you cannot change the choices for the people you already persuaded.\n\nSuppose that you're doing your choices optimally. What is the greatest integer $x$ such that, no matter what are the choices of the friends you didn't choose to control, the element you will take from the array will be greater than or equal to $x$?\n\nPlease note that the friends you don't control may do their choice arbitrarily, and they will not necessarily take the biggest element available.\n\n\n-----Input-----\n\nThe input consists of multiple test cases. The first line contains a single integer $t$ ($1 \\le t \\le 1000$)  — the number of test cases. The description of the test cases follows.\n\nThe first line of each test case contains three space-separated integers $n$, $m$ and $k$ ($1 \\le m \\le n \\le 3500$, $0 \\le k \\le n - 1$)  — the number of elements in the array, your position in line and the number of people whose choices you can fix.\n\nThe second line of each test case contains $n$ positive integers $a_1, a_2, \\dots, a_n$ ($1 \\le a_i \\le 10^9$)  — elements of the array.\n\nIt is guaranteed that the sum of $n$ over all test cases does not exceed $3500$.\n\n\n-----Output-----\n\nFor each test case, print the largest integer $x$ such that you can guarantee to obtain at least $x$.\n\n\n-----Example-----\nInput\n4\n6 4 2\n2 9 2 3 8 5\n4 4 1\n2 13 60 4\n4 1 3\n1 2 2 1\n2 2 0\n1 2\n\nOutput\n8\n4\n1\n1\n\n\n\n-----Note-----\n\nIn the first test case, an optimal strategy is to force the first person to take the last element and the second person to take the first element.  the first person will take the last element ($5$) because he or she was forced by you to take the last element. After this turn the remaining array will be $[2, 9, 2, 3, 8]$;  the second person will take the first element ($2$) because he or she was forced by you to take the first element. After this turn the remaining array will be $[9, 2, 3, 8]$;  if the third person will choose to take the first element ($9$), at your turn the remaining array will be $[2, 3, 8]$ and you will take $8$ (the last element);  if the third person will choose to take the last element ($8$), at your turn the remaining array will be $[9, 2, 3]$ and you will take $9$ (the first element). \n\nThus, this strategy guarantees to end up with at least $8$. We can prove that there is no strategy that guarantees to end up with at least $9$. Hence, the answer is $8$.\n\nIn the second test case, an optimal strategy is to force the first person to take the first element. Then, in the worst case, both the second and the third person will take the first element: you will end up with $4$.", "input_output": [{"input": "4\n6 4 2\n2 9 2 3 8 5\n4 4 1\n2 13 60 4\n4 1 3\n1 2 2 1\n2 2 0\n1 2\n", "output": "8\n4\n1\n1\n"}]}
{"id": 2176, "question": "Let's consider a simplified version of order book of some stock. The order book is a list of orders (offers) from people that want to buy or sell one unit of the stock, each order is described by direction (BUY or SELL) and price.\n\nAt every moment of time, every SELL offer has higher price than every BUY offer. \n\nIn this problem no two ever existed orders will have the same price.\n\nThe lowest-price SELL order and the highest-price BUY order are called the best offers, marked with black frames on the picture below. [Image] The presented order book says that someone wants to sell the product at price $12$ and it's the best SELL offer because the other two have higher prices. The best BUY offer has price $10$. \n\nThere are two possible actions in this orderbook:  Somebody adds a new order of some direction with some price. Somebody accepts the best possible SELL or BUY offer (makes a deal). It's impossible to accept not the best SELL or BUY offer (to make a deal at worse price). After someone accepts the offer, it is removed from the orderbook forever.\n\nIt is allowed to add new BUY order only with prices less than the best SELL offer (if you want to buy stock for higher price, then instead of adding an order you should accept the best SELL offer). Similarly, one couldn't add a new SELL order with price less or equal to the best BUY offer. For example, you can't add a new offer \"SELL $20$\" if there is already an offer \"BUY $20$\" or \"BUY $25$\" — in this case you just accept the best BUY offer.\n\nYou have a damaged order book log (in the beginning the are no orders in book). Every action has one of the two types: \"ADD $p$\" denotes adding a new order with price $p$ and unknown direction. The order must not contradict with orders still not removed from the order book.  \"ACCEPT $p$\" denotes accepting an existing best offer with price $p$ and unknown direction.\n\nThe directions of all actions are lost. Information from the log isn't always enough to determine these directions. Count the number of ways to correctly restore all ADD action directions so that all the described conditions are satisfied at any moment. Since the answer could be large, output it modulo $10^9 + 7$. If it is impossible to correctly restore directions, then output $0$.\n\n\n-----Input-----\n\nThe first line contains an integer $n$ ($1 \\le n \\le 363\\,304$) — the number of actions in the log.\n\nEach of the next $n$ lines contains a string \"ACCEPT\" or \"ADD\" and an integer $p$ ($1 \\le p \\le 308\\,983\\,066$), describing an action type and price. \n\nAll ADD actions have different prices. For ACCEPT action it is guaranteed that the order with the same price has already been added but has not been accepted yet.\n\n\n-----Output-----\n\nOutput the number of ways to restore directions of ADD actions modulo $10^9 + 7$.\n\n\n-----Examples-----\nInput\n6\nADD 1\nACCEPT 1\nADD 2\nACCEPT 2\nADD 3\nACCEPT 3\n\nOutput\n8\n\nInput\n4\nADD 1\nADD 2\nADD 3\nACCEPT 2\n\nOutput\n2\n\nInput\n7\nADD 1\nADD 2\nADD 3\nADD 4\nADD 5\nACCEPT 3\nACCEPT 5\n\nOutput\n0\n\n\n\n-----Note-----\n\nIn the first example each of orders may be BUY or SELL.\n\nIn the second example the order with price $1$ has to be BUY order, the order with the price $3$ has to be SELL order.", "input_output": [{"input": "6\nADD 1\nACCEPT 1\nADD 2\nACCEPT 2\nADD 3\nACCEPT 3\n", "output": "8\n"}, {"input": "4\nADD 1\nADD 2\nADD 3\nACCEPT 2\n", "output": "2\n"}, {"input": "7\nADD 1\nADD 2\nADD 3\nADD 4\nADD 5\nACCEPT 3\nACCEPT 5\n", "output": "0\n"}, {"input": "6\nADD 10\nADD 7\nADD 13\nADD 15\nADD 12\nACCEPT 10\n", "output": "2\n"}, {"input": "8\nADD 10\nADD 7\nADD 13\nADD 15\nADD 12\nACCEPT 10\nADD 11\nADD 8\n", "output": "6\n"}, {"input": "15\nADD 14944938\nADD 40032655\nACCEPT 14944938\nACCEPT 40032655\nADD 79373162\nACCEPT 79373162\nADD 55424250\nACCEPT 55424250\nADD 67468892\nACCEPT 67468892\nADD 51815959\nADD 13976252\nADD 2040654\nADD 74300637\nACCEPT 51815959\n", "output": "32\n"}, {"input": "12\nADD 85752704\nACCEPT 85752704\nADD 82888551\nADD 31364670\nACCEPT 82888551\nADD 95416363\nADD 27575237\nADD 47306380\nACCEPT 31364670\nACCEPT 47306380\nADD 22352020\nADD 32836602\n", "output": "8\n"}, {"input": "5\nADD 187264133\nACCEPT 187264133\nADD 182071021\nACCEPT 182071021\nADD 291739970\n", "output": "8\n"}, {"input": "1\nADD 308983066\n", "output": "2\n"}]}
{"id": 2093, "question": "Ivan has an array consisting of n different integers. He decided to reorder all elements in increasing order. Ivan loves merge sort so he decided to represent his array with one or several increasing sequences which he then plans to merge into one sorted array.\n\nIvan represent his array with increasing sequences with help of the following algorithm.\n\nWhile there is at least one unused number in array Ivan repeats the following procedure:  iterate through array from the left to the right;  Ivan only looks at unused numbers on current iteration;  if current number is the first unused number on this iteration or this number is greater than previous unused number on current iteration, then Ivan marks the number as used and writes it down. \n\nFor example, if Ivan's array looks like [1, 3, 2, 5, 4] then he will perform two iterations. On first iteration Ivan will use and write numbers [1, 3, 5], and on second one — [2, 4].\n\nWrite a program which helps Ivan and finds representation of the given array with one or several increasing sequences in accordance with algorithm described above.\n\n\n-----Input-----\n\nThe first line contains a single integer n (1 ≤ n ≤ 2·10^5) — the number of elements in Ivan's array.\n\nThe second line contains a sequence consisting of distinct integers a_1, a_2, ..., a_{n} (1 ≤ a_{i} ≤ 10^9) — Ivan's array.\n\n\n-----Output-----\n\nPrint representation of the given array in the form of one or more increasing sequences in accordance with the algorithm described above. Each sequence must be printed on a new line.\n\n\n-----Examples-----\nInput\n5\n1 3 2 5 4\n\nOutput\n1 3 5 \n2 4 \n\nInput\n4\n4 3 2 1\n\nOutput\n4 \n3 \n2 \n1 \n\nInput\n4\n10 30 50 101\n\nOutput\n10 30 50 101", "input_output": [{"input": "5\n1 3 2 5 4\n", "output": "1 3 5 \n2 4 \n"}, {"input": "4\n4 3 2 1\n", "output": "4 \n3 \n2 \n1 \n"}, {"input": "4\n10 30 50 101\n", "output": "10 30 50 101 \n"}, {"input": "1\n1\n", "output": "1 \n"}, {"input": "1\n200000\n", "output": "200000 \n"}, {"input": "2\n1 2\n", "output": "1 2 \n"}, {"input": "2\n2 1\n", "output": "2 \n1 \n"}, {"input": "2\n1 200000\n", "output": "1 200000 \n"}, {"input": "2\n200000 1\n", "output": "200000 \n1 \n"}, {"input": "10\n71550121 446173607 640274071 402690754 802030518 598196518 796619138 96204862 983359971 799843967\n", "output": "71550121 446173607 640274071 802030518 983359971 \n402690754 598196518 796619138 799843967 \n96204862 \n"}, {"input": "3\n1 100 1000000000\n", "output": "1 100 1000000000 \n"}, {"input": "3\n1000000000 100 1\n", "output": "1000000000 \n100 \n1 \n"}]}
{"id": 2065, "question": "Andrewid the Android is a galaxy-famous detective. He is now investigating the case of vandalism at the exhibition of contemporary art.\n\nThe main exhibit is a construction of n matryoshka dolls that can be nested one into another. The matryoshka dolls are numbered from 1 to n. A matryoshka with a smaller number can be nested in a matryoshka with a higher number, two matryoshkas can not be directly nested in the same doll, but there may be chain nestings, for example, 1 → 2 → 4 → 5. \n\nIn one second, you can perform one of the two following operations:  Having a matryoshka a that isn't nested in any other matryoshka and a matryoshka b, such that b doesn't contain any other matryoshka and is not nested in any other matryoshka, you may put a in b;  Having a matryoshka a directly contained in matryoshka b, such that b is not nested in any other matryoshka, you may get a out of b. \n\nAccording to the modern aesthetic norms the matryoshka dolls on display were assembled in a specific configuration, i.e. as several separate chains of nested matryoshkas, but the criminal, following the mysterious plan, took out all the dolls and assembled them into a single large chain (1 → 2 → ... → n). In order to continue the investigation Andrewid needs to know in what minimum time it is possible to perform this action.\n\n\n-----Input-----\n\nThe first line contains integers n (1 ≤ n ≤ 10^5) and k (1 ≤ k ≤ 10^5) — the number of matryoshkas and matryoshka chains in the initial configuration.\n\nThe next k lines contain the descriptions of the chains: the i-th line first contains number m_{i} (1 ≤ m_{i} ≤ n), and then m_{i} numbers a_{i}1, a_{i}2, ..., a_{im}_{i} — the numbers of matryoshkas in the chain (matryoshka a_{i}1 is nested into matryoshka a_{i}2, that is nested into matryoshka a_{i}3, and so on till the matryoshka a_{im}_{i} that isn't nested into any other matryoshka).\n\nIt is guaranteed that m_1 + m_2 + ... + m_{k} = n, the numbers of matryoshkas in all the chains are distinct, in each chain the numbers of matryoshkas follow in the ascending order.\n\n\n-----Output-----\n\nIn the single line print the minimum number of seconds needed to assemble one large chain from the initial configuration.\n\n\n-----Examples-----\nInput\n3 2\n2 1 2\n1 3\n\nOutput\n1\n\nInput\n7 3\n3 1 3 7\n2 2 5\n2 4 6\n\nOutput\n10\n\n\n\n-----Note-----\n\nIn the first sample test there are two chains: 1 → 2 and 3. In one second you can nest the first chain into the second one and get 1 → 2 → 3.\n\nIn the second sample test you need to disassemble all the three chains into individual matryoshkas in 2 + 1 + 1 = 4 seconds and then assemble one big chain in 6 seconds.", "input_output": [{"input": "3 2\n2 1 2\n1 3\n", "output": "1\n"}, {"input": "7 3\n3 1 3 7\n2 2 5\n2 4 6\n", "output": "10\n"}, {"input": "1 1\n1 1\n", "output": "0\n"}, {"input": "3 2\n1 2\n2 1 3\n", "output": "3\n"}, {"input": "5 3\n1 4\n3 1 2 3\n1 5\n", "output": "2\n"}, {"input": "8 5\n2 1 2\n2 3 4\n1 5\n2 6 7\n1 8\n", "output": "8\n"}, {"input": "10 10\n1 5\n1 4\n1 10\n1 3\n1 7\n1 1\n1 8\n1 6\n1 9\n1 2\n", "output": "9\n"}, {"input": "20 6\n3 8 9 13\n3 4 14 20\n2 15 17\n3 2 5 11\n5 7 10 12 18 19\n4 1 3 6 16\n", "output": "33\n"}, {"input": "50 10\n6 17 21 31 42 45 49\n6 11 12 15 22 26 38\n3 9 29 36\n3 10 23 43\n5 14 19 28 46 48\n2 30 39\n6 13 20 24 33 37 47\n8 1 2 3 4 5 6 7 8\n7 16 18 25 27 34 40 44\n4 32 35 41 50\n", "output": "75\n"}, {"input": "13 8\n1 5\n2 8 10\n1 13\n4 1 2 3 11\n1 7\n2 6 12\n1 4\n1 9\n", "output": "13\n"}, {"input": "21 13\n1 18\n2 8 13\n1 21\n1 17\n2 7 9\n1 20\n1 19\n1 4\n1 16\n2 5 6\n3 12 14 15\n3 1 2 3\n2 10 11\n", "output": "24\n"}, {"input": "50 50\n1 2\n1 5\n1 28\n1 46\n1 42\n1 24\n1 3\n1 37\n1 33\n1 50\n1 23\n1 40\n1 43\n1 26\n1 49\n1 34\n1 8\n1 45\n1 15\n1 1\n1 22\n1 18\n1 27\n1 25\n1 13\n1 39\n1 38\n1 10\n1 44\n1 6\n1 17\n1 47\n1 7\n1 35\n1 20\n1 36\n1 31\n1 21\n1 32\n1 29\n1 4\n1 12\n1 19\n1 16\n1 11\n1 41\n1 9\n1 14\n1 30\n1 48\n", "output": "49\n"}, {"input": "100 3\n45 1 2 3 4 5 6 7 8 9 19 21 24 27 28 30 34 35 37 39 40 41 42 43 46 47 48 51 52 55 58 59 61 63 64 66 69 71 76 80 85 86 88 89 94 99\n26 10 11 15 18 23 29 31 33 36 38 44 49 54 56 60 62 65 75 78 82 83 84 95 96 97 98\n29 12 13 14 16 17 20 22 25 26 32 45 50 53 57 67 68 70 72 73 74 77 79 81 87 90 91 92 93 100\n", "output": "180\n"}, {"input": "100 19\n6 62 72 83 91 94 97\n3 61 84 99\n1 63\n5 46 53 56 69 78\n5 41 43 49 74 89\n5 55 57 79 85 87\n3 47 59 98\n3 64 76 82\n3 48 66 75\n2 60 88\n2 67 77\n4 40 51 73 95\n41 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 44 71 81\n4 58 65 90 93\n1 100\n5 39 45 52 80 86\n2 50 68\n1 92\n4 42 54 70 96\n", "output": "106\n"}]}
{"id": 2089, "question": "Petya learned a new programming language CALPAS. A program in this language always takes one non-negative integer and returns one non-negative integer as well.\n\nIn the language, there are only three commands: apply a bitwise operation AND, OR or XOR with a given constant to the current integer. A program can contain an arbitrary sequence of these operations with arbitrary constants from 0 to 1023. When the program is run, all operations are applied (in the given order) to the argument and in the end the result integer is returned.\n\nPetya wrote a program in this language, but it turned out to be too long. Write a program in CALPAS that does the same thing as the Petya's program, and consists of no more than 5 lines. Your program should return the same integer as Petya's program for all arguments from 0 to 1023.\n\n\n-----Input-----\n\nThe first line contains an integer n (1 ≤ n ≤ 5·10^5) — the number of lines.\n\nNext n lines contain commands. A command consists of a character that represents the operation (\"&\", \"|\" or \"^\" for AND, OR or XOR respectively), and the constant x_{i} 0 ≤ x_{i} ≤ 1023.\n\n\n-----Output-----\n\nOutput an integer k (0 ≤ k ≤ 5) — the length of your program.\n\nNext k lines must contain commands in the same format as in the input.\n\n\n-----Examples-----\nInput\n3\n| 3\n^ 2\n| 1\n\nOutput\n2\n| 3\n^ 2\n\nInput\n3\n& 1\n& 3\n& 5\n\nOutput\n1\n& 1\n\nInput\n3\n^ 1\n^ 2\n^ 3\n\nOutput\n0\n\n\n\n-----Note-----\n\nYou can read about bitwise operations in https://en.wikipedia.org/wiki/Bitwise_operation.\n\nSecond sample:\n\nLet x be an input of the Petya's program. It's output is ((x&1)&3)&5 = x&(1&3&5) = x&1. So these two programs always give the same outputs.", "input_output": [{"input": "3\n| 3\n^ 2\n| 1\n", "output": "2\n| 3\n^ 2\n"}, {"input": "3\n& 1\n& 3\n& 5\n", "output": "1\n& 1\n"}, {"input": "3\n^ 1\n^ 2\n^ 3\n", "output": "0\n"}, {"input": "2\n| 999\n^ 689\n", "output": "2\n| 999\n^ 689\n"}, {"input": "3\n& 242\n^ 506\n^ 522\n", "output": "2\n| 781\n^ 253\n"}, {"input": "2\n| 56\n^ 875\n", "output": "2\n| 56\n^ 875\n"}, {"input": "3\n^ 125\n^ 377\n& 1019\n", "output": "2\n| 4\n^ 260\n"}, {"input": "1\n& 123\n", "output": "1\n& 123\n"}, {"input": "1\n| 123\n", "output": "1\n| 123\n"}, {"input": "1\n^ 123\n", "output": "1\n^ 123\n"}, {"input": "10\n^ 218\n& 150\n| 935\n& 61\n| 588\n& 897\n| 411\n| 584\n^ 800\n| 704\n", "output": "2\n| 1023\n^ 260\n"}, {"input": "10\n^ 160\n& 1021\n& 510\n^ 470\n& 1022\n& 251\n& 760\n& 1016\n| 772\n| 515\n", "output": "2\n| 775\n^ 112\n"}, {"input": "1\n& 0\n", "output": "1\n& 0\n"}, {"input": "1\n| 0\n", "output": "0\n"}, {"input": "1\n^ 0\n", "output": "0\n"}, {"input": "1\n& 1023\n", "output": "0\n"}, {"input": "1\n| 1023\n", "output": "1\n| 1023\n"}, {"input": "1\n^ 1023\n", "output": "1\n^ 1023\n"}]}
{"id": 2155, "question": "Summer is coming! It's time for Iahub and Iahubina to work out, as they both want to look hot at the beach. The gym where they go is a matrix a with n lines and m columns. Let number a[i][j] represents the calories burned by performing workout at the cell of gym in the i-th line and the j-th column.\n\nIahub starts with workout located at line 1 and column 1. He needs to finish with workout a[n][m]. After finishing workout a[i][j], he can go to workout a[i + 1][j] or a[i][j + 1]. Similarly, Iahubina starts with workout a[n][1] and she needs to finish with workout a[1][m]. After finishing workout from cell a[i][j], she goes to either a[i][j + 1] or a[i - 1][j]. \n\nThere is one additional condition for their training. They have to meet in exactly one cell of gym. At that cell, none of them will work out. They will talk about fast exponentiation (pretty odd small talk) and then both of them will move to the next workout.\n\nIf a workout was done by either Iahub or Iahubina, it counts as total gain. Please plan a workout for Iahub and Iahubina such as total gain to be as big as possible. Note, that Iahub and Iahubina can perform workouts with different speed, so the number of cells that they use to reach meet cell may differs.\n\n\n-----Input-----\n\nThe first line of the input contains two integers n and m (3 ≤ n, m ≤ 1000). Each of the next n lines contains m integers: j-th number from i-th line denotes element a[i][j] (0 ≤ a[i][j] ≤ 10^5).\n\n\n-----Output-----\n\nThe output contains a single number — the maximum total gain possible. \n\n\n-----Examples-----\nInput\n3 3\n100 100 100\n100 1 100\n100 100 100\n\nOutput\n800\n\n\n-----Note-----\n\nIahub will choose exercises a[1][1] → a[1][2] → a[2][2] → a[3][2] → a[3][3]. Iahubina will choose exercises a[3][1] → a[2][1] → a[2][2] → a[2][3] → a[1][3].", "input_output": [{"input": "3 3\n100 100 100\n100 1 100\n100 100 100\n", "output": "800"}, {"input": "4 5\n87882 40786 3691 85313 46694\n28884 16067 3242 97367 78518\n4250 35501 9780 14435 19004\n64673 65438 56977 64495 27280\n", "output": "747898"}, {"input": "3 3\n3 1 2\n3 2 0\n2 3 2\n", "output": "16"}, {"input": "3 3\n1 10 1\n1 10 1\n1 10 1\n", "output": "26"}, {"input": "3 3\n0 0 0\n0 10000 0\n0 0 0\n", "output": "0"}, {"input": "3 3\n1 1 1\n0 10000 0\n1 1 1\n", "output": "6"}, {"input": "3 3\n9 0 9\n0 9 9\n9 9 9\n", "output": "54"}, {"input": "3 3\n0 0 0\n0 100 0\n0 0 0\n", "output": "0"}, {"input": "3 3\n100000 100000 100000\n1 100000 100000\n1 1 100000\n", "output": "500003"}, {"input": "3 3\n100 0 100\n1 100 100\n0 100 100\n", "output": "501"}]}
{"id": 2085, "question": "You are given n strings s_1, s_2, ..., s_{n} consisting of characters 0 and 1. m operations are performed, on each of them you concatenate two existing strings into a new one. On the i-th operation the concatenation s_{a}_{i}s_{b}_{i} is saved into a new string s_{n} + i (the operations are numbered starting from 1). After each operation you need to find the maximum positive integer k such that all possible strings consisting of 0 and 1 of length k (there are 2^{k} such strings) are substrings of the new string. If there is no such k, print 0.\n\n\n-----Input-----\n\nThe first line contains single integer n (1 ≤ n ≤ 100) — the number of strings. The next n lines contain strings s_1, s_2, ..., s_{n} (1 ≤ |s_{i}| ≤ 100), one per line. The total length of strings is not greater than 100.\n\nThe next line contains single integer m (1 ≤ m ≤ 100) — the number of operations. m lines follow, each of them contains two integers a_{i} abd b_{i} (1 ≤ a_{i}, b_{i} ≤ n + i - 1) — the number of strings that are concatenated to form s_{n} + i.\n\n\n-----Output-----\n\nPrint m lines, each should contain one integer — the answer to the question after the corresponding operation.\n\n\n-----Example-----\nInput\n5\n01\n10\n101\n11111\n0\n3\n1 2\n6 5\n4 4\n\nOutput\n1\n2\n0\n\n\n\n-----Note-----\n\nOn the first operation, a new string \"0110\" is created. For k = 1 the two possible binary strings of length k are \"0\" and \"1\", they are substrings of the new string. For k = 2 and greater there exist strings of length k that do not appear in this string (for k = 2 such string is \"00\"). So the answer is 1.\n\nOn the second operation the string \"01100\" is created. Now all strings of length k = 2 are present.\n\nOn the third operation the string \"1111111111\" is created. There is no zero, so the answer is 0.", "input_output": [{"input": "5\n01\n10\n101\n11111\n0\n3\n1 2\n6 5\n4 4\n", "output": "1\n2\n0\n"}, {"input": "5\n01\n1\n0011\n0\n01\n6\n5 5\n3 2\n4 2\n6 7\n5 1\n9 7\n", "output": "1\n1\n1\n2\n1\n2\n"}, {"input": "5\n111101000111100011100110000100\n000111001\n01101000\n0000110100100010011001000000010100100111110110\n0110001\n10\n5 5\n2 2\n5 6\n1 1\n1 7\n10 6\n6 2\n11 1\n3 6\n8 2\n", "output": "2\n2\n2\n3\n3\n4\n3\n4\n2\n3\n"}, {"input": "1\n1\n1\n1 1\n", "output": "0\n"}, {"input": "5\n110101010101010110000011011\n111111\n1000100011100111100101101010011111100000001001\n00\n1111101100001110000\n10\n4 3\n6 6\n7 5\n8 8\n8 7\n10 8\n11 9\n10 12\n13 13\n12 13\n", "output": "4\n4\n4\n4\n4\n4\n4\n4\n4\n4\n"}, {"input": "5\n100010010\n0\n1001100110010111\n0001000011000111000011011000110000010010010001110001000011011\n0100000100100\n10\n5 5\n6 6\n6 7\n7 8\n8 9\n10 8\n11 9\n10 9\n12 13\n12 13\n", "output": "1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n"}, {"input": "5\n0\n1\n11\n110000010001100101001\n1101011011111\n10\n5 3\n6 4\n7 6\n8 7\n9 8\n10 9\n11 10\n12 11\n13 12\n14 13\n", "output": "1\n4\n5\n5\n5\n5\n5\n5\n5\n5\n"}, {"input": "10\n0\n1\n1111100000\n0\n1\n0000\n11000\n1010001110010010110\n01101001111\n010101110110111111\n20\n10 3\n11 4\n12 5\n13 6\n14 7\n15 8\n16 9\n17 16\n18 17\n19 18\n20 19\n21 20\n22 21\n23 22\n24 23\n25 24\n26 25\n27 26\n28 27\n29 28\n", "output": "2\n2\n3\n3\n3\n4\n5\n6\n6\n6\n6\n6\n6\n6\n6\n6\n6\n6\n6\n6\n"}, {"input": "10\n0\n1\n1111\n110000000\n100000\n1\n1\n000010100001110001\n00100010110001101000111100100110010101001011\n100110110011101\n50\n10 3\n11 4\n12 5\n13 6\n14 7\n15 8\n16 9\n17 1\n18 1\n19 2\n20 2\n21 2\n22 2\n23 2\n24 1\n25 2\n26 1\n27 2\n28 1\n29 2\n30 2\n31 1\n32 2\n33 1\n34 2\n35 2\n36 2\n37 2\n38 1\n39 2\n40 2\n41 1\n42 2\n43 2\n44 2\n45 1\n46 2\n47 2\n48 2\n49 2\n50 2\n51 2\n52 2\n53 52\n54 53\n55 54\n56 55\n57 56\n58 57\n59 58\n", "output": "2\n2\n3\n3\n3\n4\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n5\n6\n6\n6\n6\n6\n6\n6\n6\n6\n6\n6\n6\n6\n6\n6\n"}, {"input": "2\n001010011100101110111\n001100110011001100110011001100110011001100110011001100111001\n14\n1 2\n3 3\n4 4\n5 5\n6 6\n7 7\n8 8\n9 9\n10 10\n11 11\n12 12\n13 13\n14 14\n15 15\n", "output": "2\n2\n2\n2\n2\n2\n2\n2\n2\n2\n2\n2\n2\n2\n"}, {"input": "2\n1\n0\n40\n1 2\n3 3\n4 4\n5 5\n6 6\n7 7\n8 8\n9 9\n10 10\n11 11\n12 12\n13 13\n14 14\n15 15\n16 16\n17 17\n18 18\n19 19\n20 20\n21 21\n22 22\n23 23\n24 24\n25 25\n26 26\n27 27\n28 28\n29 29\n30 30\n31 31\n32 32\n33 33\n34 34\n35 35\n36 36\n37 37\n38 38\n39 39\n40 40\n41 41\n", "output": "1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n"}, {"input": "2\n011\n100\n63\n1 1\n3 3\n4 4\n5 5\n6 6\n7 7\n8 8\n9 9\n10 10\n11 11\n12 12\n13 13\n14 14\n15 15\n16 16\n17 17\n18 18\n19 19\n20 20\n21 21\n22 22\n23 23\n24 24\n25 25\n26 26\n27 27\n28 28\n29 29\n30 30\n31 31\n32 32\n2 2\n34 34\n35 35\n36 36\n37 37\n38 38\n39 39\n40 40\n41 41\n42 42\n43 43\n44 44\n45 45\n46 46\n47 47\n48 48\n49 49\n50 50\n51 51\n52 52\n53 53\n54 54\n55 55\n56 56\n57 57\n58 58\n59 59\n60 60\n61 61\n62 62\n63 63\n33 64\n", "output": "1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n1\n2\n"}, {"input": "1\n0000000000000000000000000000000000000000000000000000000000000000\n25\n1 1\n2 2\n3 3\n4 4\n5 5\n6 6\n7 7\n8 8\n9 9\n10 10\n11 11\n12 12\n13 13\n14 14\n15 15\n16 16\n17 17\n18 18\n19 19\n20 20\n21 21\n22 22\n23 23\n24 24\n25 25\n", "output": "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n"}]}
{"id": 2266, "question": "There are M chairs arranged in a line. The coordinate of the i-th chair (1 ≤ i ≤ M) is i.\nN people of the Takahashi clan played too much games, and they are all suffering from backaches. They need to sit in chairs and rest, but they are particular about which chairs they sit in. Specifically, the i-th person wishes to sit in a chair whose coordinate is not greater than L_i, or not less than R_i. Naturally, only one person can sit in the same chair.\nIt may not be possible for all of them to sit in their favorite chairs, if nothing is done.\nAoki, who cares for the health of the people of the Takahashi clan, decides to provide additional chairs so that all of them can sit in chairs at their favorite positions.\nAdditional chairs can be placed at arbitrary real coordinates. Find the minimum required number of additional chairs.\n\n-----Constraints-----\n - 1 ≤ N,M ≤ 2 × 10^5\n - 0 ≤ L_i < R_i ≤ M + 1(1 ≤ i ≤ N)\n - All input values are integers.\n\n-----Input-----\nInput is given from Standard Input in the following format:\nN M\nL_1 R_1\n:\nL_N R_N\n\n-----Output-----\nPrint the minimum required number of additional chairs.\n\n-----Sample Input-----\n4 4\n0 3\n2 3\n1 3\n3 4\n\n-----Sample Output-----\n0\n\nThe four people can sit in chairs at the coordinates 3, 2, 1 and 4, respectively, and no more chair is needed.", "input_output": [{"input": "4 4\n0 3\n2 3\n1 3\n3 4\n", "output": "0\n"}, {"input": "7 6\n0 7\n1 5\n3 6\n2 7\n1 6\n2 6\n3 7\n", "output": "2\n"}, {"input": "3 1\n1 2\n1 2\n1 2\n", "output": "2\n"}, {"input": "6 6\n1 6\n1 6\n1 5\n1 5\n2 6\n2 6\n", "output": "2\n"}]}
{"id": 2177, "question": "Vasily has a deck of cards consisting of n cards. There is an integer on each of the cards, this integer is between 1 and 100 000, inclusive. It is possible that some cards have the same integers on them.\n\nVasily decided to sort the cards. To do this, he repeatedly takes the top card from the deck, and if the number on it equals the minimum number written on the cards in the deck, then he places the card away. Otherwise, he puts it under the deck and takes the next card from the top, and so on. The process ends as soon as there are no cards in the deck. You can assume that Vasily always knows the minimum number written on some card in the remaining deck, but doesn't know where this card (or these cards) is.\n\nYou are to determine the total number of times Vasily takes the top card from the deck.\n\n\n-----Input-----\n\nThe first line contains single integer n (1 ≤ n ≤ 100 000) — the number of cards in the deck.\n\nThe second line contains a sequence of n integers a_1, a_2, ..., a_{n} (1 ≤ a_{i} ≤ 100 000), where a_{i} is the number written on the i-th from top card in the deck.\n\n\n-----Output-----\n\nPrint the total number of times Vasily takes the top card from the deck.\n\n\n-----Examples-----\nInput\n4\n6 3 1 2\n\nOutput\n7\n\nInput\n1\n1000\n\nOutput\n1\n\nInput\n7\n3 3 3 3 3 3 3\n\nOutput\n7\n\n\n\n-----Note-----\n\nIn the first example Vasily at first looks at the card with number 6 on it, puts it under the deck, then on the card with number 3, puts it under the deck, and then on the card with number 1. He places away the card with 1, because the number written on it is the minimum among the remaining cards. After that the cards from top to bottom are [2, 6, 3]. Then Vasily looks at the top card with number 2 and puts it away. After that the cards from top to bottom are [6, 3]. Then Vasily looks at card 6, puts it under the deck, then at card 3 and puts it away. Then there is only one card with number 6 on it, and Vasily looks at it and puts it away. Thus, in total Vasily looks at 7 cards.", "input_output": [{"input": "4\n6 3 1 2\n", "output": "7\n"}, {"input": "1\n1000\n", "output": "1\n"}, {"input": "7\n3 3 3 3 3 3 3\n", "output": "7\n"}, {"input": "64\n826 142 89 337 897 891 1004 704 281 644 910 852 147 193 289 384 625 695 416 944 162 939 164 1047 359 114 499 99 713 300 268 316 256 404 852 496 373 322 716 202 689 857 936 806 556 153 137 863 1047 678 564 474 282 135 610 176 855 360 814 144 77 112 354 154\n", "output": "1042\n"}, {"input": "87\n12 2 2 10 12 1 5 9 15 2 4 7 7 14 8 10 1 6 7 6 13 15 10 6 2 11 13 1 15 14 8 8 4 7 11 12 3 15 9 2 13 1 7 11 2 1 13 11 8 14 2 2 12 7 13 4 13 3 13 3 11 1 7 13 15 8 12 4 12 4 1 4 9 3 13 12 10 15 14 10 7 7 7 2 7 6 10\n", "output": "580\n"}, {"input": "10\n4 3 4 3 3 3 4 4 4 3\n", "output": "15\n"}, {"input": "20\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n", "output": "20\n"}, {"input": "30\n6283 14661 69188 39640 41261 48019 86266 70517 4592 69008 20602 33339 29980 96844 76008 96294 27120 22671 5243 742 33692 18068 29056 48033 1223 82728 99765 38350 36425 10671\n", "output": "235\n"}, {"input": "100\n9 9 72 55 14 8 55 58 35 67 3 18 73 92 41 49 15 60 18 66 9 26 97 47 43 88 71 97 19 34 48 96 79 53 8 24 69 49 12 23 77 12 21 88 66 9 29 13 61 69 54 77 41 13 4 68 37 74 7 6 29 76 55 72 89 4 78 27 29 82 18 83 12 4 32 69 89 85 66 13 92 54 38 5 26 56 17 55 29 4 17 39 29 94 3 67 85 98 21 14\n", "output": "1805\n"}]}
{"id": 2182, "question": "Oleg the client and Igor the analyst are good friends. However, sometimes they argue over little things. Recently, they started a new company, but they are having trouble finding a name for the company.\n\nTo settle this problem, they've decided to play a game. The company name will consist of n letters. Oleg and Igor each have a set of n letters (which might contain multiple copies of the same letter, the sets can be different). Initially, the company name is denoted by n question marks. Oleg and Igor takes turns to play the game, Oleg moves first. In each turn, a player can choose one of the letters c in his set and replace any of the question marks with c. Then, a copy of the letter c is removed from his set. The game ends when all the question marks has been replaced by some letter.\n\nFor example, suppose Oleg has the set of letters {i, o, i} and Igor has the set of letters {i, m, o}. One possible game is as follows :\n\nInitially, the company name is ???.\n\nOleg replaces the second question mark with 'i'. The company name becomes ?i?. The set of letters Oleg have now is {i, o}.\n\nIgor replaces the third question mark with 'o'. The company name becomes ?io. The set of letters Igor have now is {i, m}.\n\nFinally, Oleg replaces the first question mark with 'o'. The company name becomes oio. The set of letters Oleg have now is {i}.\n\nIn the end, the company name is oio.\n\nOleg wants the company name to be as lexicographically small as possible while Igor wants the company name to be as lexicographically large as possible. What will be the company name if Oleg and Igor always play optimally?\n\nA string s = s_1s_2...s_{m} is called lexicographically smaller than a string t = t_1t_2...t_{m} (where s ≠ t) if s_{i} < t_{i} where i is the smallest index such that s_{i} ≠ t_{i}. (so s_{j} = t_{j} for all j < i)\n\n\n-----Input-----\n\nThe first line of input contains a string s of length n (1 ≤ n ≤ 3·10^5). All characters of the string are lowercase English letters. This string denotes the set of letters Oleg has initially.\n\nThe second line of input contains a string t of length n. All characters of the string are lowercase English letters. This string denotes the set of letters Igor has initially.\n\n\n-----Output-----\n\nThe output should contain a string of n lowercase English letters, denoting the company name if Oleg and Igor plays optimally.\n\n\n-----Examples-----\nInput\ntinkoff\nzscoder\n\nOutput\nfzfsirk\n\nInput\nxxxxxx\nxxxxxx\n\nOutput\nxxxxxx\n\nInput\nioi\nimo\n\nOutput\nioi\n\n\n\n-----Note-----\n\nOne way to play optimally in the first sample is as follows : Initially, the company name is ???????. Oleg replaces the first question mark with 'f'. The company name becomes f??????. Igor replaces the second question mark with 'z'. The company name becomes fz?????. Oleg replaces the third question mark with 'f'. The company name becomes fzf????. Igor replaces the fourth question mark with 's'. The company name becomes fzfs???. Oleg replaces the fifth question mark with 'i'. The company name becomes fzfsi??. Igor replaces the sixth question mark with 'r'. The company name becomes fzfsir?. Oleg replaces the seventh question mark with 'k'. The company name becomes fzfsirk.\n\nFor the second sample, no matter how they play, the company name will always be xxxxxx.", "input_output": [{"input": "tinkoff\nzscoder\n", "output": "fzfsirk\n"}, {"input": "xxxxxx\nxxxxxx\n", "output": "xxxxxx\n"}, {"input": "ioi\nimo\n", "output": "ioi\n"}, {"input": "abc\naaa\n", "output": "aab\n"}, {"input": "reddit\nabcdef\n", "output": "dfdeed\n"}, {"input": "cbxz\naaaa\n", "output": "abac\n"}, {"input": "bcdef\nabbbc\n", "output": "bccdb\n"}, {"input": "z\ny\n", "output": "z\n"}, {"input": "y\nz\n", "output": "y\n"}]}
{"id": 2296, "question": "You are given a string S consisting of lowercase English letters.\nDetermine whether we can turn S into a palindrome by repeating the operation of swapping two adjacent characters. If it is possible, find the minimum required number of operations.\n\n-----Constraints-----\n - 1 \\leq |S| \\leq 2 × 10^5\n - S consists of lowercase English letters.\n\n-----Input-----\nInput is given from Standard Input in the following format:\nS\n\n-----Output-----\nIf we cannot turn S into a palindrome, print -1. Otherwise, print the minimum required number of operations.\n\n-----Sample Input-----\neel\n\n-----Sample Output-----\n1\n\nWe can turn S into a palindrome by the following operation:\n - Swap the 2-nd and 3-rd characters. S is now ele.", "input_output": [{"input": "eel\n", "output": "1\n"}, {"input": "ataatmma\n", "output": "4\n"}, {"input": "snuke\n", "output": "-1\n"}]}
{"id": 2290, "question": "We have a board with an H \\times W grid.\nEach square in the grid is painted in black or white. The square at the i-th row from the top and j-th column from the left is black if the j-th character in S_i is #, and white if that character is ..\nSnuke can perform the following operation on the grid any number of times:\n - Select a row or column in the grid, and invert the color of all the squares in that row or column (that is, black squares become white and vice versa).\nThen, Snuke draws a rectangle along grid lines. Here, all the squares contained in the rectangle must be painted in black.\nFind the maximum possible area of Snuke's rectangle when the operation is performed optimally.\n\n-----Constraints-----\n - 2 \\leq H \\leq 2000\n - 2 \\leq W \\leq 2000\n - |S_i| = W\n - S_i consists of # and ..\n\n-----Input-----\nInput is given from Standard Input in the following format:\nH W\nS_1\nS_2\n:\nS_H\n\n-----Output-----\nPrint the maximum possible area of Snuke's rectangle.\n\n-----Sample Input-----\n3 3\n..#\n##.\n.#.\n\n-----Sample Output-----\n6\n\nIf the first row from the top and the third column from the left are inverted, a 2 \\times 3 rectangle can be drawn, as shown below:", "input_output": [{"input": "3 3\n..#\n##.\n.#.\n", "output": "6\n"}, {"input": "4 4\n....\n....\n....\n....\n", "output": "16\n"}, {"input": "10 8\n##...#.#\n##...#.#\n..###.#.\n#.##.#.#\n.#..#.#.\n..##.#.#\n##.#.#..\n...#.#..\n###.#.##\n###..###\n", "output": "27\n"}]}
{"id": 2053, "question": "$n$ boys and $m$ girls came to the party. Each boy presented each girl some integer number of sweets (possibly zero). All boys are numbered with integers from $1$ to $n$ and all girls are numbered with integers from $1$ to $m$. For all $1 \\leq i \\leq n$ the minimal number of sweets, which $i$-th boy presented to some girl is equal to $b_i$ and for all $1 \\leq j \\leq m$ the maximal number of sweets, which $j$-th girl received from some boy is equal to $g_j$.\n\nMore formally, let $a_{i,j}$ be the number of sweets which the $i$-th boy give to the $j$-th girl. Then $b_i$ is equal exactly to the minimum among values $a_{i,1}, a_{i,2}, \\ldots, a_{i,m}$ and $g_j$ is equal exactly to the maximum among values $b_{1,j}, b_{2,j}, \\ldots, b_{n,j}$.\n\nYou are interested in the minimum total number of sweets that boys could present, so you need to minimize the sum of $a_{i,j}$ for all $(i,j)$ such that $1 \\leq i \\leq n$ and $1 \\leq j \\leq m$. You are given the numbers $b_1, \\ldots, b_n$ and $g_1, \\ldots, g_m$, determine this number. \n\n\n-----Input-----\n\nThe first line contains two integers $n$ and $m$, separated with space — the number of boys and girls, respectively ($2 \\leq n, m \\leq 100\\,000$). The second line contains $n$ integers $b_1, \\ldots, b_n$, separated by spaces — $b_i$ is equal to the minimal number of sweets, which $i$-th boy presented to some girl ($0 \\leq b_i \\leq 10^8$). The third line contains $m$ integers $g_1, \\ldots, g_m$, separated by spaces — $g_j$ is equal to the maximal number of sweets, which $j$-th girl received from some boy ($0 \\leq g_j \\leq 10^8$).\n\n\n-----Output-----\n\nIf the described situation is impossible, print $-1$. In another case, print the minimal total number of sweets, which boys could have presented and all conditions could have satisfied.\n\n\n-----Examples-----\nInput\n3 2\n1 2 1\n3 4\n\nOutput\n12\nInput\n2 2\n0 1\n1 0\n\nOutput\n-1\nInput\n2 3\n1 0\n1 1 2\n\nOutput\n4\n\n\n-----Note-----\n\nIn the first test, the minimal total number of sweets, which boys could have presented is equal to $12$. This can be possible, for example, if the first boy presented $1$ and $4$ sweets, the second boy presented $3$ and $2$ sweets and the third boy presented $1$ and $1$ sweets for the first and the second girl, respectively. It's easy to see, that all conditions are satisfied and the total number of sweets is equal to $12$.\n\nIn the second test, the boys couldn't have presented sweets in such way, that all statements satisfied.\n\nIn the third test, the minimal total number of sweets, which boys could have presented is equal to $4$. This can be possible, for example, if the first boy presented $1$, $1$, $2$ sweets for the first, second, third girl, respectively and the second boy didn't present sweets for each girl. It's easy to see, that all conditions are satisfied and the total number of sweets is equal to $4$.", "input_output": [{"input": "3 2\n1 2 1\n3 4\n", "output": "12"}, {"input": "2 2\n0 1\n1 0\n", "output": "-1"}, {"input": "2 3\n1 0\n1 1 2\n", "output": "4"}, {"input": "2 2\n0 0\n100000000 100000000\n", "output": "200000000"}, {"input": "2 2\n14419485 34715515\n45193875 34715515\n", "output": "108748360"}, {"input": "2 2\n4114169 4536507\n58439428 4536507\n", "output": "71204273"}, {"input": "2 2\n89164828 36174769\n90570286 89164829\n", "output": "305074712"}, {"input": "2 2\n23720786 67248252\n89244428 67248253\n", "output": "247461719"}, {"input": "2 2\n217361 297931\n297930 83550501\n", "output": "-1"}, {"input": "2 2\n72765050 72765049\n72763816 77716490\n", "output": "-1"}, {"input": "2 2\n100000000 100000000\n100000000 100000000\n", "output": "400000000"}, {"input": "2 2\n100000000 100000000\n0 0\n", "output": "-1"}, {"input": "2 2\n0 0\n0 0\n", "output": "0"}, {"input": "4 2\n0 2 7 3\n7 9\n", "output": "26"}, {"input": "4 3\n1 5 6 7\n8 9 10\n", "output": "64"}]}
{"id": 2102, "question": "John Doe started thinking about graphs. After some thought he decided that he wants to paint an undirected graph, containing exactly k cycles of length 3. \n\nA cycle of length 3 is an unordered group of three distinct graph vertices a, b and c, such that each pair of them is connected by a graph edge. \n\nJohn has been painting for long, but he has not been a success. Help him find such graph. Note that the number of vertices there shouldn't exceed 100, or else John will have problems painting it.\n\n\n-----Input-----\n\nA single line contains an integer k (1 ≤ k ≤ 10^5) — the number of cycles of length 3 in the required graph.\n\n\n-----Output-----\n\nIn the first line print integer n (3 ≤ n ≤ 100) — the number of vertices in the found graph. In each of next n lines print n characters \"0\" and \"1\": the i-th character of the j-th line should equal \"0\", if vertices i and j do not have an edge between them, otherwise it should equal \"1\". Note that as the required graph is undirected, the i-th character of the j-th line must equal the j-th character of the i-th line. The graph shouldn't contain self-loops, so the i-th character of the i-th line must equal \"0\" for all i.\n\n\n-----Examples-----\nInput\n1\n\nOutput\n3\n011\n101\n110\n\nInput\n10\n\nOutput\n5\n01111\n10111\n11011\n11101\n11110", "input_output": [{"input": "1\n", "output": "3\n011\n101\n110\n"}, {"input": "10\n", "output": "5\n01111\n10111\n11011\n11101\n11110\n"}, {"input": "2\n", "output": "4\n0111\n1011\n1100\n1100\n"}, {"input": "3\n", "output": "5\n01001\n10111\n01001\n01001\n11110\n"}, {"input": "4\n", "output": "4\n0111\n1011\n1101\n1110\n"}, {"input": "5\n", "output": "5\n01001\n10111\n01011\n01101\n11110\n"}, {"input": "6\n", "output": "6\n010010\n101111\n010110\n011010\n111101\n010010\n"}, {"input": "7\n", "output": "5\n01011\n10111\n01011\n11101\n11110\n"}, {"input": "8\n", "output": "6\n010110\n101111\n010110\n111010\n111101\n010010\n"}, {"input": "9\n", "output": "7\n0101100\n1011111\n0100100\n1100101\n1111011\n0100100\n0101100\n"}, {"input": "12\n", "output": "7\n0101101\n1011111\n0100100\n1100101\n1111011\n0100100\n1101100\n"}, {"input": "19\n", "output": "7\n0101101\n1011111\n0101100\n1110111\n1111011\n0101101\n1101110\n"}]}
{"id": 2259, "question": "Let $a_1, \\ldots, a_n$ be an array of $n$ positive integers. In one operation, you can choose an index $i$ such that $a_i = i$, and remove $a_i$ from the array (after the removal, the remaining parts are concatenated).\n\nThe weight of $a$ is defined as the maximum number of elements you can remove.\n\nYou must answer $q$ independent queries $(x, y)$: after replacing the $x$ first elements of $a$ and the $y$ last elements of $a$ by $n+1$ (making them impossible to remove), what would be the weight of $a$?\n\n\n-----Input-----\n\nThe first line contains two integers $n$ and $q$ ($1 \\le n, q \\le 3 \\cdot 10^5$)  — the length of the array and the number of queries.\n\nThe second line contains $n$ integers $a_1$, $a_2$, ..., $a_n$ ($1 \\leq a_i \\leq n$) — elements of the array.\n\nThe $i$-th of the next $q$ lines contains two integers $x$ and $y$ ($x, y \\ge 0$ and $x+y < n$).\n\n\n-----Output-----\n\nPrint $q$ lines, $i$-th line should contain a single integer  — the answer to the $i$-th query.\n\n\n-----Examples-----\nInput\n13 5\n2 2 3 9 5 4 6 5 7 8 3 11 13\n3 1\n0 0\n2 4\n5 0\n0 12\n\nOutput\n5\n11\n6\n1\n0\n\nInput\n5 2\n1 4 1 2 4\n0 0\n1 0\n\nOutput\n2\n0\n\n\n\n-----Note-----\n\nExplanation of the first query:\n\nAfter making first $x = 3$ and last $y = 1$ elements impossible to remove, $a$ becomes $[\\times, \\times, \\times, 9, 5, 4, 6, 5, 7, 8, 3, 11, \\times]$ (we represent $14$ as $\\times$ for clarity).\n\nHere is a strategy that removes $5$ elements (the element removed is colored in red):  $[\\times, \\times, \\times, 9, \\color{red}{5}, 4, 6, 5, 7, 8, 3, 11, \\times]$  $[\\times, \\times, \\times, 9, 4, 6, 5, 7, 8, 3, \\color{red}{11}, \\times]$  $[\\times, \\times, \\times, 9, 4, \\color{red}{6}, 5, 7, 8, 3, \\times]$  $[\\times, \\times, \\times, 9, 4, 5, 7, \\color{red}{8}, 3, \\times]$  $[\\times, \\times, \\times, 9, 4, 5, \\color{red}{7}, 3, \\times]$  $[\\times, \\times, \\times, 9, 4, 5, 3, \\times]$ (final state) \n\nIt is impossible to remove more than $5$ elements, hence the weight is $5$.", "input_output": [{"input": "13 5\n2 2 3 9 5 4 6 5 7 8 3 11 13\n3 1\n0 0\n2 4\n5 0\n0 12\n", "output": "5\n11\n6\n1\n0\n"}, {"input": "5 2\n1 4 1 2 4\n0 0\n1 0\n", "output": "2\n0\n"}, {"input": "1 1\n1\n0 0\n", "output": "1\n"}, {"input": "30 10\n1 1 3 3 5 2 1 8 2 6 11 5 2 6 12 11 8 5 11 3 14 8 16 13 14 25 16 2 8 17\n6 3\n0 15\n1 0\n9 2\n12 16\n1 0\n17 3\n14 13\n0 22\n3 10\n", "output": "3\n15\n16\n2\n0\n16\n0\n0\n8\n4\n"}]}
{"id": 2352, "question": "Vasya is an active Internet user. One day he came across an Internet resource he liked, so he wrote its address in the notebook. We know that the address of the written resource has format: <protocol>://<domain>.ru[/<context>] \n\nwhere:  <protocol> can equal either \"http\" (without the quotes) or \"ftp\" (without the quotes),  <domain> is a non-empty string, consisting of lowercase English letters,  the /<context> part may not be present. If it is present, then <context> is a non-empty string, consisting of lowercase English letters. \n\nIf string <context> isn't present in the address, then the additional character \"/\" isn't written. Thus, the address has either two characters \"/\" (the ones that go before the domain), or three (an extra one in front of the context).\n\nWhen the boy came home, he found out that the address he wrote in his notebook had no punctuation marks. Vasya must have been in a lot of hurry and didn't write characters \":\", \"/\", \".\".\n\nHelp Vasya to restore the possible address of the recorded Internet resource.\n\n\n-----Input-----\n\nThe first line contains a non-empty string that Vasya wrote out in his notebook. This line consists of lowercase English letters only. \n\nIt is guaranteed that the given string contains at most 50 letters. It is guaranteed that the given string can be obtained from some correct Internet resource address, described above.\n\n\n-----Output-----\n\nPrint a single line — the address of the Internet resource that Vasya liked. If there are several addresses that meet the problem limitations, you are allowed to print any of them.\n\n\n-----Examples-----\nInput\nhttpsunrux\n\nOutput\nhttp://sun.ru/x\n\nInput\nftphttprururu\n\nOutput\nftp://http.ru/ruru\n\n\n\n-----Note-----\n\nIn the second sample there are two more possible answers: \"ftp://httpruru.ru\" and \"ftp://httpru.ru/ru\".", "input_output": [{"input": "httpsunrux\n", "output": "http://sun.ru/x\n"}, {"input": "ftphttprururu\n", "output": "ftp://http.ru/ruru\n"}, {"input": "httpuururrururruruurururrrrrurrurrurruruuruuu\n", "output": "http://uu.ru/rrururruruurururrrrrurrurrurruruuruuu\n"}, {"input": "httpabuaruauabbaruru\n", "output": "http://abua.ru/auabbaruru\n"}, {"input": "httpuurrruurruuruuruuurrrurururuurruuuuuuruurr\n", "output": "http://uurr.ru/urruuruuruuurrrurururuurruuuuuuruurr\n"}, {"input": "httpruhhphhhpuhruruhhpruhhphruhhru\n", "output": "http://ruhhphhhpuh.ru/ruhhpruhhphruhhru\n"}, {"input": "httpftprftprutprururftruruftptp\n", "output": "http://ftprftp.ru/tprururftruruftptp\n"}, {"input": "httpfttpftpfttftpftpftppfrurururu\n", "output": "http://fttpftpfttftpftpftppf.ru/rururu\n"}, {"input": "httpruhttttpruhttprupruhttpruhtturuhttphtruuru\n", "output": "http://ruhttttp.ru/httprupruhttpruhtturuhttphtruuru\n"}, {"input": "httpsjkazaaghasjkasjkabruru\n", "output": "http://sjkazaaghasjkasjkab.ru/ru\n"}, {"input": "httpftphttptphttphrururuhpftphtpftphtpftphtptpft\n", "output": "http://ftphttptphttph.ru/ruruhpftphtpftphtpftphtptpft\n"}, {"input": "httpppppru\n", "output": "http://pppp.ru\n"}, {"input": "ftprrurururrurururuurrururruuru\n", "output": "ftp://r.ru/rururrurururuurrururruuru\n"}, {"input": "ftpabaruru\n", "output": "ftp://aba.ru/ru\n"}, {"input": "ftpruurruurururururuuruuur\n", "output": "ftp://ruur.ru/urururururuuruuur\n"}, {"input": "ftphhphruhhpruhhpuhhpuruhhphruhhruhhpuhhru\n", "output": "ftp://hhph.ru/hhpruhhpuhhpuruhhphruhhruhhpuhhru\n"}, {"input": "ftparua\n", "output": "ftp://a.ru/a\n"}, {"input": "httpzru\n", "output": "http://z.ru\n"}, {"input": "httprrur\n", "output": "http://r.ru/r\n"}, {"input": "ftprru\n", "output": "ftp://r.ru\n"}]}
{"id": 2209, "question": "You have unweighted tree of $n$ vertices. You have to assign a positive weight to each edge so that the following condition would hold:\n\n  For every two different leaves $v_{1}$ and $v_{2}$ of this tree, bitwise XOR of weights of all edges on the simple path between $v_{1}$ and $v_{2}$ has to be equal to $0$. \n\nNote that you can put very large positive integers (like $10^{(10^{10})}$).\n\nIt's guaranteed that such assignment always exists under given constraints. Now let's define $f$ as the number of distinct weights in assignment.\n\n [Image] In this example, assignment is valid, because bitwise XOR of all edge weights between every pair of leaves is $0$. $f$ value is $2$ here, because there are $2$ distinct edge weights($4$ and $5$).\n\n[Image] In this example, assignment is invalid, because bitwise XOR of all edge weights between vertex $1$ and vertex $6$ ($3, 4, 5, 4$) is not $0$. \n\nWhat are the minimum and the maximum possible values of $f$ for the given tree? Find and print both.\n\n\n-----Input-----\n\nThe first line contains integer $n$ ($3 \\le n \\le 10^{5}$) — the number of vertices in given tree.\n\nThe $i$-th of the next $n-1$ lines contains two integers $a_{i}$ and $b_{i}$ ($1 \\le a_{i} \\lt b_{i} \\le n$) — it means there is an edge between $a_{i}$ and $b_{i}$. It is guaranteed that given graph forms tree of $n$ vertices.\n\n\n-----Output-----\n\nPrint two integers — the minimum and maximum possible value of $f$ can be made from valid assignment of given tree. Note that it's always possible to make an assignment under given constraints.\n\n\n-----Examples-----\nInput\n6\n1 3\n2 3\n3 4\n4 5\n5 6\n\nOutput\n1 4\n\nInput\n6\n1 3\n2 3\n3 4\n4 5\n4 6\n\nOutput\n3 3\n\nInput\n7\n1 2\n2 7\n3 4\n4 7\n5 6\n6 7\n\nOutput\n1 6\n\n\n\n-----Note-----\n\nIn the first example, possible assignments for each minimum and maximum are described in picture below. Of course, there are multiple possible assignments for each minimum and maximum.  [Image] \n\nIn the second example, possible assignments for each minimum and maximum are described in picture below. The $f$ value of valid assignment of this tree is always $3$.  [Image] \n\nIn the third example, possible assignments for each minimum and maximum are described in picture below. Of course, there are multiple possible assignments for each minimum and maximum.  [Image]", "input_output": [{"input": "6\n1 3\n2 3\n3 4\n4 5\n5 6\n", "output": "1 4\n"}, {"input": "6\n1 3\n2 3\n3 4\n4 5\n4 6\n", "output": "3 3\n"}, {"input": "7\n1 2\n2 7\n3 4\n4 7\n5 6\n6 7\n", "output": "1 6\n"}, {"input": "3\n1 2\n2 3\n", "output": "1 1\n"}, {"input": "5\n1 2\n2 3\n1 4\n3 5\n", "output": "1 4\n"}, {"input": "4\n1 2\n2 3\n3 4\n", "output": "3 3\n"}, {"input": "5\n1 2\n2 3\n1 4\n4 5\n", "output": "1 4\n"}]}
{"id": 2310, "question": "Important: All possible tests are in the pretest, so you shouldn't hack on this problem. So, if you passed pretests, you will also pass the system test.\n\nYou are an adventurer currently journeying inside an evil temple. After defeating a couple of weak monsters, you arrived at a square room consisting of tiles forming an n × n grid, surrounded entirely by walls. At the end of the room lies a door locked with evil magical forces. The following inscriptions are written on the door:\n\n The sound of clashing rocks will awaken the door! \n\nBeing a very senior adventurer, you immediately realize what this means. In the room next door lies an infinite number of magical rocks. There are four types of rocks:   '^': this rock moves upwards;  '<': this rock moves leftwards;  '>': this rock moves rightwards;  'v': this rock moves downwards. \n\nTo open the door, you first need to place the rocks on some of the tiles (one tile can be occupied by at most one rock). Then, you select a single rock that you have placed and activate it. The activated rock will then move in its direction until it hits another rock or hits the walls of the room (the rock will not move if something already blocks it in its chosen direction). The rock then deactivates. If it hits the walls, or if there have been already 10^7 events of rock becoming activated, the movements end. Otherwise, the rock that was hit becomes activated and this procedure is repeated.\n\nIf a rock moves at least one cell before hitting either the wall or another rock, the hit produces a sound. The door will open once the number of produced sounds is at least x. It is okay for the rocks to continue moving after producing x sounds.\n\nThe following picture illustrates the four possible scenarios of moving rocks.\n\n\n\n Moves at least one cell, then hits another rock. A sound is produced, the hit rock becomes activated.\n\n [Image] \n\n Moves at least one cell, then hits the wall (i.e., the side of the room). A sound is produced, the movements end.\n\n [Image] \n\n Does not move because a rock is already standing in the path. The blocking rock becomes activated, but no sounds are produced.\n\n [Image] \n\n Does not move because the wall is in the way. No sounds are produced and the movements end.\n\n [Image] \n\nAssume there's an infinite number of rocks of each type in the neighboring room. You know what to do: place the rocks and open the door!\n\n\n-----Input-----\n\nThe first line will consists of two integers n and x, denoting the size of the room and the number of sounds required to open the door. There will be exactly three test cases for this problem:\n\n  n = 5, x = 5;  n = 3, x = 2;  n = 100, x = 10^5. \n\nAll of these testcases are in pretest.\n\n\n-----Output-----\n\nOutput n lines. Each line consists of n characters — the j-th character of the i-th line represents the content of the tile at the i-th row and the j-th column, and should be one of these:\n\n  '^', '<', '>', or 'v': a rock as described in the problem statement.  '.': an empty tile. \n\nThen, output two integers r and c (1 ≤ r, c ≤ n) on the next line — this means that the rock you activate first is located at the r-th row from above and c-th column from the left. There must be a rock in this cell.\n\nIf there are multiple solutions, you may output any of them.\n\n\n-----Examples-----\nInput\n5 5\n\nOutput\n>...v\nv.<..\n..^..\n>....\n..^.<\n1 1\n\nInput\n3 2\n\nOutput\n>vv\n^<.\n^.<\n1 3\n\n\n\n-----Note-----\n\nHere's a simulation of the first example, accompanied with the number of sounds produced so far.\n\n $8$ 0 sound \n\n [Image] 1 sound \n\n $8$ 2 sounds \n\n $8$ 3 sounds \n\n $8$ 4 sounds \n\n $8$ still 4 sounds \n\nIn the picture above, the activated rock switches between the '^' rock and the '<' rock. However, no sound is produced since the '^' rock didn't move even a single tile. So, still 4 sound.\n\n [Image] 5 sounds \n\nAt this point, 5 sound are already produced, so this solution is already correct. However, for the sake of example, we will continue simulating what happens.\n\n [Image] 6 sounds \n\n [Image] 7 sounds \n\n [Image] still 7 sounds \n\n [Image] 8 sounds \n\nAnd the movement stops. In total, it produces 8 sounds. Notice that the last move produced sound.\n\nHere's a simulation of the second example:\n\n [Image] 0 sound \n\n [Image] 1 sound \n\n [Image] 2 sounds \n\nNow, the activated stone will switch continuously from one to another without producing a sound until it reaches the 10^7 limit, after which the movement will cease.\n\n [Image] \n\nIn total, it produced exactly 2 sounds, so the solution is correct.", "input_output": [{"input": "5 5\n", "output": ">...v\nv.<..\n..^..\n>....\n..^.<\n1 1\n"}, {"input": "3 2\n", "output": ">vv\n^<.\n^.<\n1 3\n"}]}
{"id": 2047, "question": "Allen dreams of one day owning a enormous fleet of electric cars, the car of the future! He knows that this will give him a big status boost. As Allen is planning out all of the different types of cars he will own and how he will arrange them, he realizes that he has a problem. \n\nAllen's future parking lot can be represented as a rectangle with $4$ rows and $n$ ($n \\le 50$) columns of rectangular spaces, each of which can contain at most one car at any time. He imagines having $k$ ($k \\le 2n$) cars in the grid, and all the cars are initially in the second and third rows. Each of the cars also has a different designated parking space in the first or fourth row. Allen has to put the cars into corresponding parking places.\n\n [Image] Illustration to the first example. \n\nHowever, since Allen would never entrust his cars to anyone else, only one car can be moved at a time. He can drive a car from a space in any of the four cardinal directions to a neighboring empty space. Furthermore, Allen can only move one of his cars into a space on the first or fourth rows if it is the car's designated parking space. \n\nAllen knows he will be a very busy man, and will only have time to move cars at most $20000$ times before he realizes that moving cars is not worth his time. Help Allen determine if he should bother parking his cars or leave it to someone less important.\n\n\n-----Input-----\n\nThe first line of the input contains two space-separated integers $n$ and $k$ ($1 \\le n \\le 50$, $1 \\le k \\le 2n$), representing the number of columns and the number of cars, respectively.\n\nThe next four lines will contain $n$ integers each between $0$ and $k$ inclusive, representing the initial state of the parking lot. The rows are numbered $1$ to $4$ from top to bottom and the columns are numbered $1$ to $n$ from left to right.\n\nIn the first and last line, an integer $1 \\le x \\le k$ represents a parking spot assigned to car $x$ (you can only move this car to this place), while the integer $0$ represents a empty space (you can't move any car to this place).\n\nIn the second and third line, an integer $1 \\le x \\le k$ represents initial position of car $x$, while the integer $0$ represents an empty space (you can move any car to this place).\n\nEach $x$ between $1$ and $k$ appears exactly once in the second and third line, and exactly once in the first and fourth line.\n\n\n-----Output-----\n\nIf there is a sequence of moves that brings all of the cars to their parking spaces, with at most $20000$ car moves, then print $m$, the number of moves, on the first line. On the following $m$ lines, print the moves (one move per line) in the format $i$ $r$ $c$, which corresponds to Allen moving car $i$ to the neighboring space at row $r$ and column $c$.\n\nIf it is not possible for Allen to move all the cars to the correct spaces with at most $20000$ car moves, print a single line with the integer $-1$.\n\n\n-----Examples-----\nInput\n4 5\n1 2 0 4\n1 2 0 4\n5 0 0 3\n0 5 0 3\n\nOutput\n6\n1 1 1\n2 1 2\n4 1 4\n3 4 4\n5 3 2\n5 4 2\n\nInput\n1 2\n1\n2\n1\n2\n\nOutput\n-1\n\nInput\n1 2\n1\n1\n2\n2\n\nOutput\n2\n1 1 1\n2 4 1\n\n\n\n-----Note-----\n\nIn the first sample test case, all cars are in front of their spots except car $5$, which is in front of the parking spot adjacent. The example shows the shortest possible sequence of moves, but any sequence of length at most $20000$ will be accepted.\n\nIn the second sample test case, there is only one column, and the cars are in the wrong order, so no cars can move and the task is impossible.", "input_output": [{"input": "4 5\n1 2 0 4\n1 2 0 4\n5 0 0 3\n0 5 0 3\n", "output": "6\n1 1 1\n2 1 2\n4 1 4\n3 4 4\n5 3 2\n5 4 2\n"}, {"input": "1 2\n1\n2\n1\n2\n", "output": "-1\n"}, {"input": "1 2\n1\n1\n2\n2\n", "output": "2\n1 1 1\n2 4 1\n"}, {"input": "2 2\n1 0\n0 2\n0 1\n0 2\n", "output": "7\n2 2 1\n1 2 2\n2 3 1\n1 2 1\n2 3 2\n1 1 1\n2 4 2\n"}, {"input": "7 14\n2 11 1 14 9 8 5\n12 6 7 1 10 2 3\n14 13 9 8 5 4 11\n13 6 4 3 12 7 10\n", "output": "-1\n"}, {"input": "2 1\n0 0\n0 0\n0 1\n0 1\n", "output": "1\n1 4 2\n"}, {"input": "2 3\n0 2\n0 1\n3 2\n3 1\n", "output": "7\n1 2 1\n2 2 2\n3 4 1\n1 3 1\n2 1 2\n1 3 2\n1 4 2\n"}, {"input": "1 1\n0\n1\n0\n1\n", "output": "2\n1 3 1\n1 4 1\n"}, {"input": "2 4\n3 4\n2 1\n3 4\n2 1\n", "output": "-1\n"}, {"input": "3 5\n2 1 5\n5 3 2\n4 0 1\n0 4 3\n", "output": "18\n4 3 2\n5 3 1\n3 2 1\n2 2 2\n1 2 3\n4 4 2\n5 3 2\n3 3 1\n2 2 1\n1 2 2\n5 3 3\n3 3 2\n2 1 1\n1 1 2\n5 2 3\n3 3 3\n5 1 3\n3 4 3\n"}, {"input": "10 1\n0 0 1 0 0 0 0 0 0 0\n0 0 1 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0\n", "output": "1\n1 1 3\n"}, {"input": "50 1\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n", "output": "34\n1 3 27\n1 3 28\n1 3 29\n1 3 30\n1 3 31\n1 3 32\n1 3 33\n1 3 34\n1 3 35\n1 3 36\n1 3 37\n1 3 38\n1 3 39\n1 3 40\n1 3 41\n1 3 42\n1 3 43\n1 3 44\n1 3 45\n1 3 46\n1 3 47\n1 3 48\n1 3 49\n1 3 50\n1 2 50\n1 2 49\n1 2 48\n1 2 47\n1 2 46\n1 2 45\n1 2 44\n1 2 43\n1 2 42\n1 1 42\n"}, {"input": "22 2\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0\n0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 2 0 0 0 0\n", "output": "65\n2 2 13\n1 3 21\n2 2 12\n1 3 22\n2 2 11\n1 2 22\n2 2 10\n1 2 21\n2 2 9\n1 2 20\n2 2 8\n1 2 19\n2 2 7\n1 2 18\n2 2 6\n1 2 17\n2 2 5\n1 2 16\n2 2 4\n1 2 15\n2 2 3\n1 2 14\n2 2 2\n1 2 13\n2 2 1\n1 2 12\n2 3 1\n1 2 11\n2 3 2\n1 2 10\n2 3 3\n1 2 9\n2 3 4\n1 2 8\n2 3 5\n1 2 7\n2 3 6\n1 2 6\n2 3 7\n1 2 5\n2 3 8\n1 2 4\n2 3 9\n1 2 3\n2 3 10\n1 2 2\n2 3 11\n1 2 1\n2 3 12\n1 3 1\n2 3 13\n1 3 2\n2 3 14\n1 3 3\n2 3 15\n1 3 4\n2 3 16\n1 3 5\n2 3 17\n1 3 6\n2 3 18\n1 3 7\n2 4 18\n1 3 8\n1 4 8\n"}, {"input": "12 3\n0 0 0 0 0 0 0 0 0 0 0 0\n0 0 0 0 0 0 0 0 0 0 0 0\n2 0 0 0 0 3 0 0 0 1 0 0\n0 0 0 0 0 0 0 1 3 0 2 0\n", "output": "38\n1 3 11\n3 3 7\n2 3 2\n1 3 12\n3 3 8\n2 3 3\n1 2 12\n3 3 9\n2 3 4\n1 2 11\n3 4 9\n2 3 5\n1 2 10\n2 3 6\n1 2 9\n2 3 7\n1 2 8\n2 3 8\n1 2 7\n2 3 9\n1 2 6\n2 3 10\n1 2 5\n2 3 11\n1 2 4\n2 4 11\n1 2 3\n1 2 2\n1 2 1\n1 3 1\n1 3 2\n1 3 3\n1 3 4\n1 3 5\n1 3 6\n1 3 7\n1 3 8\n1 4 8\n"}, {"input": "10 20\n18 9 4 5 12 14 16 1 15 20\n11 13 16 6 18 5 20 17 4 3\n12 9 15 14 8 10 2 19 1 7\n6 11 13 2 7 19 10 3 8 17\n", "output": "-1\n"}, {"input": "15 30\n20 24 17 13 26 8 5 6 27 14 18 22 25 2 15\n4 12 6 25 3 5 28 11 15 21 9 26 7 17 13\n19 20 24 16 2 23 8 29 22 30 1 27 10 14 18\n9 29 3 7 12 28 10 16 23 19 21 1 30 11 4\n", "output": "-1\n"}]}
{"id": 2240, "question": "A tree is a graph with n vertices and exactly n - 1 edges; this graph should meet the following condition: there exists exactly one shortest (by number of edges) path between any pair of its vertices.\n\nA subtree of a tree T is a tree with both vertices and edges as subsets of vertices and edges of T.\n\nYou're given a tree with n vertices. Consider its vertices numbered with integers from 1 to n. Additionally an integer is written on every vertex of this tree. Initially the integer written on the i-th vertex is equal to v_{i}. In one move you can apply the following operation:  Select the subtree of the given tree that includes the vertex with number 1.  Increase (or decrease) by one all the integers which are written on the vertices of that subtree. \n\nCalculate the minimum number of moves that is required to make all the integers written on the vertices of the given tree equal to zero.\n\n\n-----Input-----\n\nThe first line of the input contains n (1 ≤ n ≤ 10^5). Each of the next n - 1 lines contains two integers a_{i} and b_{i} (1 ≤ a_{i}, b_{i} ≤ n; a_{i} ≠ b_{i}) indicating there's an edge between vertices a_{i} and b_{i}. It's guaranteed that the input graph is a tree. \n\nThe last line of the input contains a list of n space-separated integers v_1, v_2, ..., v_{n} (|v_{i}| ≤ 10^9).\n\n\n-----Output-----\n\nPrint the minimum number of operations needed to solve the task.\n\nPlease, do not write the %lld specifier to read or write 64-bit integers in С++. It is preferred to use the cin, cout streams or the %I64d specifier.\n\n\n-----Examples-----\nInput\n3\n1 2\n1 3\n1 -1 1\n\nOutput\n3", "input_output": [{"input": "3\n1 2\n1 3\n1 -1 1\n", "output": "3\n"}, {"input": "5\n2 3\n4 5\n2 5\n1 3\n0 2 1 4 3\n", "output": "8\n"}, {"input": "10\n5 6\n8 2\n9 3\n4 1\n6 10\n9 8\n7 10\n7 4\n5 2\n0 -6 -9 -1 -5 -4 -2 -7 -8 -3\n", "output": "18\n"}, {"input": "5\n3 1\n2 4\n3 4\n2 5\n0 -3 -1 2 4\n", "output": "20\n"}, {"input": "12\n1 6\n10 1\n4 1\n7 1\n1 2\n5 1\n1 8\n1 11\n3 1\n12 1\n9 1\n580660007 861441526 -264928594 488291045 253254575 -974301934 709266786 926718320 87511873 514836444 -702876508 848928657\n", "output": "2529263875\n"}]}
{"id": 2307, "question": "There are N towns on a line running east-west.\nThe towns are numbered 1 through N, in order from west to east.\nEach point on the line has a one-dimensional coordinate, and a point that is farther east has a greater coordinate value.\nThe coordinate of town i is X_i.\nYou are now at town 1, and you want to visit all the other towns.\nYou have two ways to travel:\n - Walk on the line.\nYour fatigue level increases by A each time you travel a distance of 1, regardless of direction.\n - Teleport to any location of your choice.\nYour fatigue level increases by B, regardless of the distance covered.\nFind the minimum possible total increase of your fatigue level when you visit all the towns in these two ways.\n\n-----Constraints-----\n - All input values are integers.\n - 2≤N≤10^5\n - 1≤X_i≤10^9\n - For all i(1≤i≤N-1), X_i<X_{i+1}.\n - 1≤A≤10^9\n - 1≤B≤10^9\n\n-----Input-----\nThe input is given from Standard Input in the following format:\nN A B\nX_1 X_2 ... X_N\n\n-----Output-----\nPrint the minimum possible total increase of your fatigue level when you visit all the towns.\n\n-----Sample Input-----\n4 2 5\n1 2 5 7\n\n-----Sample Output-----\n11\n\nFrom town 1, walk a distance of 1 to town 2, then teleport to town 3, then walk a distance of 2 to town 4.\nThe total increase of your fatigue level in this case is 2×1+5+2×2=11, which is the minimum possible value.", "input_output": [{"input": "4 2 5\n1 2 5 7\n", "output": "11\n"}, {"input": "7 1 100\n40 43 45 105 108 115 124\n", "output": "84\n"}, {"input": "7 1 2\n24 35 40 68 72 99 103\n", "output": "12\n"}]}
{"id": 2207, "question": "Polycarpus is a system administrator. There are two servers under his strict guidance — a and b. To stay informed about the servers' performance, Polycarpus executes commands \"ping a\" and \"ping b\". Each ping command sends exactly ten packets to the server specified in the argument of the command. Executing a program results in two integers x and y (x + y = 10; x, y ≥ 0). These numbers mean that x packets successfully reached the corresponding server through the network and y packets were lost.\n\nToday Polycarpus has performed overall n ping commands during his workday. Now for each server Polycarpus wants to know whether the server is \"alive\" or not. Polycarpus thinks that the server is \"alive\", if at least half of the packets that we send to this server reached it successfully along the network.\n\nHelp Polycarpus, determine for each server, whether it is \"alive\" or not by the given commands and their results.\n\n\n-----Input-----\n\nThe first line contains a single integer n (2 ≤ n ≤ 1000) — the number of commands Polycarpus has fulfilled. Each of the following n lines contains three integers — the description of the commands. The i-th of these lines contains three space-separated integers t_{i}, x_{i}, y_{i} (1 ≤ t_{i} ≤ 2; x_{i}, y_{i} ≥ 0; x_{i} + y_{i} = 10). If t_{i} = 1, then the i-th command is \"ping a\", otherwise the i-th command is \"ping b\". Numbers x_{i}, y_{i} represent the result of executing this command, that is, x_{i} packets reached the corresponding server successfully and y_{i} packets were lost.\n\nIt is guaranteed that the input has at least one \"ping a\" command and at least one \"ping b\" command.\n\n\n-----Output-----\n\nIn the first line print string \"LIVE\" (without the quotes) if server a is \"alive\", otherwise print \"DEAD\" (without the quotes).\n\nIn the second line print the state of server b in the similar format.\n\n\n-----Examples-----\nInput\n2\n1 5 5\n2 6 4\n\nOutput\nLIVE\nLIVE\n\nInput\n3\n1 0 10\n2 0 10\n1 10 0\n\nOutput\nLIVE\nDEAD\n\n\n\n-----Note-----\n\nConsider the first test case. There 10 packets were sent to server a, 5 of them reached it. Therefore, at least half of all packets sent to this server successfully reached it through the network. Overall there were 10 packets sent to server b, 6 of them reached it. Therefore, at least half of all packets sent to this server successfully reached it through the network.\n\nConsider the second test case. There were overall 20 packages sent to server a, 10 of them reached it. Therefore, at least half of all packets sent to this server successfully reached it through the network. Overall 10 packets were sent to server b, 0 of them reached it. Therefore, less than half of all packets sent to this server successfully reached it through the network.", "input_output": [{"input": "2\n1 5 5\n2 6 4\n", "output": "LIVE\nLIVE\n"}, {"input": "3\n1 0 10\n2 0 10\n1 10 0\n", "output": "LIVE\nDEAD\n"}, {"input": "10\n1 3 7\n2 4 6\n1 2 8\n2 5 5\n2 10 0\n2 10 0\n1 8 2\n2 2 8\n2 10 0\n1 1 9\n", "output": "DEAD\nLIVE\n"}, {"input": "11\n1 8 2\n1 6 4\n1 9 1\n1 7 3\n2 0 10\n2 0 10\n1 8 2\n2 2 8\n2 6 4\n2 7 3\n2 9 1\n", "output": "LIVE\nDEAD\n"}, {"input": "12\n1 5 5\n1 0 10\n1 4 6\n1 2 8\n1 2 8\n1 5 5\n1 9 1\n2 9 1\n1 5 5\n1 1 9\n2 9 1\n2 7 3\n", "output": "DEAD\nLIVE\n"}, {"input": "13\n1 8 2\n1 4 6\n1 5 5\n1 5 5\n2 10 0\n2 9 1\n1 3 7\n2 6 4\n2 6 4\n2 5 5\n1 7 3\n2 3 7\n2 9 1\n", "output": "LIVE\nLIVE\n"}, {"input": "14\n1 7 3\n1 0 10\n1 7 3\n1 1 9\n2 2 8\n2 0 10\n1 1 9\n2 8 2\n2 6 4\n1 3 7\n1 3 7\n2 6 4\n2 1 9\n2 7 3\n", "output": "DEAD\nDEAD\n"}]}
{"id": 2124, "question": "Niwel is a little golden bear. As everyone knows, bears live in forests, but Niwel got tired of seeing all the trees so he decided to move to the city.\n\nIn the city, Niwel took on a job managing bears to deliver goods. The city that he lives in can be represented as a directed graph with n nodes and m edges. Each edge has a weight capacity. A delivery consists of a bear carrying weights with their bear hands on a simple path from node 1 to node n. The total weight that travels across a particular edge must not exceed the weight capacity of that edge.\n\nNiwel has exactly x bears. In the interest of fairness, no bear can rest, and the weight that each bear carries must be exactly the same. However, each bear may take different paths if they like.\n\nNiwel would like to determine, what is the maximum amount of weight he can deliver (it's the sum of weights carried by bears). Find the maximum weight.\n\n\n-----Input-----\n\nThe first line contains three integers n, m and x (2 ≤ n ≤ 50, 1 ≤ m ≤ 500, 1 ≤ x ≤ 100 000) — the number of nodes, the number of directed edges and the number of bears, respectively.\n\nEach of the following m lines contains three integers a_{i}, b_{i} and c_{i} (1 ≤ a_{i}, b_{i} ≤ n, a_{i} ≠ b_{i}, 1 ≤ c_{i} ≤ 1 000 000). This represents a directed edge from node a_{i} to b_{i} with weight capacity c_{i}. There are no self loops and no multiple edges from one city to the other city. More formally, for each i and j that i ≠ j it's guaranteed that a_{i} ≠ a_{j} or b_{i} ≠ b_{j}. It is also guaranteed that there is at least one path from node 1 to node n.\n\n\n-----Output-----\n\nPrint one real value on a single line — the maximum amount of weight Niwel can deliver if he uses exactly x bears. Your answer will be considered correct if its absolute or relative error does not exceed 10^{ - 6}.\n\nNamely: let's assume that your answer is a, and the answer of the jury is b. The checker program will consider your answer correct if $\\frac{|a - b|}{\\operatorname{max}(1, b)} \\leq 10^{-6}$.\n\n\n-----Examples-----\nInput\n4 4 3\n1 2 2\n2 4 1\n1 3 1\n3 4 2\n\nOutput\n1.5000000000\n\nInput\n5 11 23\n1 2 3\n2 3 4\n3 4 5\n4 5 6\n1 3 4\n2 4 5\n3 5 6\n1 4 2\n2 5 3\n1 5 2\n3 2 30\n\nOutput\n10.2222222222\n\n\n\n-----Note-----\n\nIn the first sample, Niwel has three bears. Two bears can choose the path $1 \\rightarrow 3 \\rightarrow 4$, while one bear can choose the path $1 \\rightarrow 2 \\rightarrow 4$. Even though the bear that goes on the path $1 \\rightarrow 2 \\rightarrow 4$ can carry one unit of weight, in the interest of fairness, he is restricted to carry 0.5 units of weight. Thus, the total weight is 1.5 units overall. Note that even though Niwel can deliver more weight with just 2 bears, he must use exactly 3 bears on this day.", "input_output": [{"input": "4 4 3\n1 2 2\n2 4 1\n1 3 1\n3 4 2\n", "output": "1.5000000000\n"}, {"input": "5 11 23\n1 2 3\n2 3 4\n3 4 5\n4 5 6\n1 3 4\n2 4 5\n3 5 6\n1 4 2\n2 5 3\n1 5 2\n3 2 30\n", "output": "10.2222222222\n"}, {"input": "10 16 63\n1 2 1\n2 10 1\n1 3 1\n3 10 1\n1 4 1\n4 10 1\n1 5 1\n5 10 1\n1 6 1\n6 10 1\n1 7 1\n7 10 1\n1 8 1\n8 10 1\n1 9 1\n9 10 1\n", "output": "7.8750000000\n"}, {"input": "2 1 3\n1 2 301\n", "output": "301.0000000000\n"}, {"input": "2 2 1\n1 2 48\n2 1 39\n", "output": "48.0000000000\n"}, {"input": "5 9 5\n3 2 188619\n4 2 834845\n2 4 996667\n1 2 946392\n2 5 920935\n2 3 916558\n1 5 433923\n4 5 355150\n3 5 609814\n", "output": "1182990.0000000000\n"}, {"input": "7 15 10\n1 3 776124\n6 7 769968\n2 1 797048\n4 3 53774\n2 7 305724\n4 1 963904\n4 6 877656\n4 5 971901\n1 4 803781\n3 1 457050\n3 7 915891\n1 7 8626\n5 7 961155\n3 4 891456\n5 4 756977\n", "output": "1552248.0000000000\n"}, {"input": "3 2 100000\n1 2 1\n2 3 1\n", "output": "1.0000000000\n"}, {"input": "3 2 100000\n1 2 1\n2 3 1000000\n", "output": "1.0000000000\n"}, {"input": "2 1 100000\n1 2 1\n", "output": "1.0000000000\n"}, {"input": "3 2 100000\n1 2 1\n2 3 100000\n", "output": "1.0000000000\n"}]}
{"id": 2294, "question": "There are N bags, each containing two white balls. The i-th box contains two balls with integers x_i and y_i written on them, respectively.\nFor each of these bags, you will paint one of the balls red, and paint the other blue.\nAfterwards, the 2N balls will be classified according to color.\nThen, we will define the following:\n - R_{max}: the maximum integer written on a ball painted in red\n - R_{min}: the minimum integer written on a ball painted in red\n - B_{max}: the maximum integer written on a ball painted in blue\n - B_{min}: the minimum integer written on a ball painted in blue\nFind the minimum possible value of (R_{max} - R_{min}) \\times (B_{max} - B_{min}).\n\n-----Constraints-----\n - 1 ≤ N ≤ 200,000\n - 1 ≤ x_i, y_i ≤ 10^9\n\n-----Input-----\nInput is given from Standard Input in the following format:\nN\nx_1 y_1\nx_2 y_2\n:\nx_N y_N\n\n-----Output-----\nPrint the minimum possible value.\n\n-----Sample Input-----\n3\n1 2\n3 4\n5 6\n\n-----Sample Output-----\n15\n\nThe optimal solution is to paint the balls with x_1, x_2, y_3 red, and paint the balls with y_1, y_2, x_3 blue.", "input_output": [{"input": "3\n1 2\n3 4\n5 6\n", "output": "15\n"}, {"input": "3\n1010 10\n1000 1\n20 1020\n", "output": "380\n"}, {"input": "2\n1 1\n1000000000 1000000000\n", "output": "999999998000000001\n"}]}
{"id": 2225, "question": "For strings s and t, we will say that s and t are prefix-free when neither is a prefix of the other.\nLet L be a positive integer. A set of strings S is a good string set when the following conditions hold true:\n - Each string in S has a length between 1 and L (inclusive) and consists of the characters 0 and 1.\n - Any two distinct strings in S are prefix-free.\nWe have a good string set S = \\{ s_1, s_2, ..., s_N \\}. Alice and Bob will play a game against each other. They will alternately perform the following operation, starting from Alice:\n - Add a new string to S. After addition, S must still be a good string set.\nThe first player who becomes unable to perform the operation loses the game. Determine the winner of the game when both players play optimally.\n\n-----Constraints-----\n - 1 \\leq N \\leq 10^5\n - 1 \\leq L \\leq 10^{18}\n - s_1, s_2, ..., s_N are all distinct.\n - { s_1, s_2, ..., s_N } is a good string set.\n - |s_1| + |s_2| + ... + |s_N| \\leq 10^5\n\n-----Input-----\nInput is given from Standard Input in the following format:\nN L\ns_1\ns_2\n:\ns_N\n\n-----Output-----\nIf Alice will win, print Alice; if Bob will win, print Bob.\n\n-----Sample Input-----\n2 2\n00\n01\n\n-----Sample Output-----\nAlice\n\nIf Alice adds 1, Bob will be unable to add a new string.", "input_output": [{"input": "2 2\n00\n01\n", "output": "Alice\n"}, {"input": "2 2\n00\n11\n", "output": "Bob\n"}, {"input": "3 3\n0\n10\n110\n", "output": "Alice\n"}, {"input": "2 1\n0\n1\n", "output": "Bob\n"}, {"input": "1 2\n11\n", "output": "Alice\n"}, {"input": "2 3\n101\n11\n", "output": "Bob\n"}]}
{"id": 2144, "question": "Ujan has a lot of numbers in his boxes. He likes order and balance, so he decided to reorder the numbers.\n\nThere are $k$ boxes numbered from $1$ to $k$. The $i$-th box contains $n_i$ integer numbers. The integers can be negative. All of the integers are distinct. \n\nUjan is lazy, so he will do the following reordering of the numbers exactly once. He will pick a single integer from each of the boxes, $k$ integers in total. Then he will insert the chosen numbers — one integer in each of the boxes, so that the number of integers in each box is the same as in the beginning. Note that he may also insert an integer he picked from a box back into the same box.\n\nUjan will be happy if the sum of the integers in each box is the same. Can he achieve this and make the boxes perfectly balanced, like all things should be?\n\n\n-----Input-----\n\nThe first line contains a single integer $k$ ($1 \\leq k \\leq 15$), the number of boxes. \n\nThe $i$-th of the next $k$ lines first contains a single integer $n_i$ ($1 \\leq n_i \\leq 5\\,000$), the number of integers in box $i$. Then the same line contains $n_i$ integers $a_{i,1}, \\ldots, a_{i,n_i}$ ($|a_{i,j}| \\leq 10^9$), the integers in the $i$-th box. \n\nIt is guaranteed that all $a_{i,j}$ are distinct.\n\n\n-----Output-----\n\nIf Ujan cannot achieve his goal, output \"No\" in a single line. Otherwise in the first line output \"Yes\", and then output $k$ lines. The $i$-th of these lines should contain two integers $c_i$ and $p_i$. This means that Ujan should pick the integer $c_i$ from the $i$-th box and place it in the $p_i$-th box afterwards.\n\nIf there are multiple solutions, output any of those.\n\nYou can print each letter in any case (upper or lower).\n\n\n-----Examples-----\nInput\n4\n3 1 7 4\n2 3 2\n2 8 5\n1 10\n\nOutput\nYes\n7 2\n2 3\n5 1\n10 4\n\nInput\n2\n2 3 -2\n2 -1 5\n\nOutput\nNo\n\nInput\n2\n2 -10 10\n2 0 -20\n\nOutput\nYes\n-10 2\n-20 1\n\n\n\n-----Note-----\n\nIn the first sample, Ujan can put the number $7$ in the $2$nd box, the number $2$ in the $3$rd box, the number $5$ in the $1$st box and keep the number $10$ in the same $4$th box. Then the boxes will contain numbers $\\{1,5,4\\}$, $\\{3, 7\\}$, $\\{8,2\\}$ and $\\{10\\}$. The sum in each box then is equal to $10$.\n\nIn the second sample, it is not possible to pick and redistribute the numbers in the required way.\n\nIn the third sample, one can swap the numbers $-20$ and $-10$, making the sum in each box equal to $-10$.", "input_output": [{"input": "4\n3 1 7 4\n2 3 2\n2 8 5\n1 10\n", "output": "Yes\n7 2\n2 3\n5 1\n10 4\n"}, {"input": "2\n2 3 -2\n2 -1 5\n", "output": "No\n"}, {"input": "2\n2 -10 10\n2 0 -20\n", "output": "Yes\n-10 2\n-20 1\n"}, {"input": "1\n1 0\n", "output": "Yes\n0 1\n"}, {"input": "3\n1 20\n2 30 40\n3 50 60 80\n", "output": "No\n"}, {"input": "3\n3 1 3 100\n2 4 104\n2 2 102\n", "output": "No\n"}, {"input": "4\n3 80 1 10\n3 52 19 24\n3 27 46 29\n3 74 13 25\n", "output": "No\n"}, {"input": "2\n5 -1000000000 999999999 -999999998 999999997 0\n5 1000000000 -999999999 999999998 -999999997 4\n", "output": "Yes\n0 2\n4 1\n"}, {"input": "5\n10 -251 650 475 -114 364 -75754 -982 -532 -151 -484\n10 -623 -132 -317561 -438 20 -275 -323 -530089 -311 -587\n10 450900 -519 903 -401 -789 -606529 277 -267 -682 -161\n10 -246 873 -641 838 719 234 789 -74 -287288 -772972\n10 186 741 -927 -866 -855 578 -1057019 202 162962 -458\n", "output": "Yes\n650 3\n-530089 1\n450900 5\n-287288 2\n162962 4\n"}, {"input": "2\n2 1 2\n10 0 1000000000 999999999 999999998 999999997 999999996 999999995 999999994 999999993 589934621\n", "output": "No\n"}]}
{"id": 2232, "question": "ZS the Coder is playing a game. There is a number displayed on the screen and there are two buttons, ' + ' (plus) and '$\\sqrt{}$' (square root). Initially, the number 2 is displayed on the screen. There are n + 1 levels in the game and ZS the Coder start at the level 1.\n\nWhen ZS the Coder is at level k, he can :  Press the ' + ' button. This increases the number on the screen by exactly k. So, if the number on the screen was x, it becomes x + k. Press the '$\\sqrt{}$' button. Let the number on the screen be x. After pressing this button, the number becomes $\\sqrt{x}$. After that, ZS the Coder levels up, so his current level becomes k + 1. This button can only be pressed when x is a perfect square, i.e. x = m^2 for some positive integer m. \n\nAdditionally, after each move, if ZS the Coder is at level k, and the number on the screen is m, then m must be a multiple of k. Note that this condition is only checked after performing the press. For example, if ZS the Coder is at level 4 and current number is 100, he presses the '$\\sqrt{}$' button and the number turns into 10. Note that at this moment, 10 is not divisible by 4, but this press is still valid, because after it, ZS the Coder is at level 5, and 10 is divisible by 5.\n\nZS the Coder needs your help in beating the game — he wants to reach level n + 1. In other words, he needs to press the '$\\sqrt{}$' button n times. Help him determine the number of times he should press the ' + ' button before pressing the '$\\sqrt{}$' button at each level. \n\nPlease note that ZS the Coder wants to find just any sequence of presses allowing him to reach level n + 1, but not necessarily a sequence minimizing the number of presses.\n\n\n-----Input-----\n\nThe first and only line of the input contains a single integer n (1 ≤ n ≤ 100 000), denoting that ZS the Coder wants to reach level n + 1.\n\n\n-----Output-----\n\nPrint n non-negative integers, one per line. i-th of them should be equal to the number of times that ZS the Coder needs to press the ' + ' button before pressing the '$\\sqrt{}$' button at level i. \n\nEach number in the output should not exceed 10^18. However, the number on the screen can be greater than 10^18.\n\nIt is guaranteed that at least one solution exists. If there are multiple solutions, print any of them.\n\n\n-----Examples-----\nInput\n3\n\nOutput\n14\n16\n46\n\nInput\n2\n\nOutput\n999999999999999998\n44500000000\n\nInput\n4\n\nOutput\n2\n17\n46\n97\n\n\n\n-----Note-----\n\nIn the first sample case:\n\nOn the first level, ZS the Coder pressed the ' + ' button 14 times (and the number on screen is initially 2), so the number became 2 + 14·1 = 16. Then, ZS the Coder pressed the '$\\sqrt{}$' button, and the number became $\\sqrt{16} = 4$. \n\nAfter that, on the second level, ZS pressed the ' + ' button 16 times, so the number becomes 4 + 16·2 = 36. Then, ZS pressed the '$\\sqrt{}$' button, levelling up and changing the number into $\\sqrt{36} = 6$.\n\nAfter that, on the third level, ZS pressed the ' + ' button 46 times, so the number becomes 6 + 46·3 = 144. Then, ZS pressed the '$\\sqrt{}$' button, levelling up and changing the number into $\\sqrt{144} = 12$. \n\nNote that 12 is indeed divisible by 4, so ZS the Coder can reach level 4.\n\nAlso, note that pressing the ' + ' button 10 times on the third level before levelling up does not work, because the number becomes 6 + 10·3 = 36, and when the '$\\sqrt{}$' button is pressed, the number becomes $\\sqrt{36} = 6$ and ZS the Coder is at Level 4. However, 6 is not divisible by 4 now, so this is not a valid solution.\n\nIn the second sample case:\n\nOn the first level, ZS the Coder pressed the ' + ' button 999999999999999998 times (and the number on screen is initially 2), so the number became 2 + 999999999999999998·1 = 10^18. Then, ZS the Coder pressed the '$\\sqrt{}$' button, and the number became $\\sqrt{10^{18}} = 10^{9}$. \n\nAfter that, on the second level, ZS pressed the ' + ' button 44500000000 times, so the number becomes 10^9 + 44500000000·2 = 9·10^10. Then, ZS pressed the '$\\sqrt{}$' button, levelling up and changing the number into $\\sqrt{9 \\cdot 10^{10}} = 300000$. \n\nNote that 300000 is a multiple of 3, so ZS the Coder can reach level 3.", "input_output": [{"input": "3\n", "output": "2\n17\n46\n"}, {"input": "2\n", "output": "2\n17\n"}, {"input": "4\n", "output": "2\n17\n46\n97\n"}, {"input": "1\n", "output": "2\n"}, {"input": "7\n", "output": "2\n17\n46\n97\n176\n289\n442\n"}]}
{"id": 2172, "question": "Let's assume that   v(n) is the largest prime number, that does not exceed n;\n\n u(n) is the smallest prime number strictly greater than n. \n\nFind $\\sum_{i = 2}^{n} \\frac{1}{v(i) u(i)}$.\n\n\n-----Input-----\n\nThe first line contains integer t (1 ≤ t ≤ 500) — the number of testscases. \n\nEach of the following t lines of the input contains integer n (2 ≤ n ≤ 10^9).\n\n\n-----Output-----\n\nPrint t lines: the i-th of them must contain the answer to the i-th test as an irreducible fraction \"p/q\", where p, q are integers, q > 0.\n\n\n-----Examples-----\nInput\n2\n2\n3\n\nOutput\n1/6\n7/30", "input_output": [{"input": "2\n2\n3\n", "output": "1/6\n7/30\n"}, {"input": "1\n1000000000\n", "output": "999999941999999673/1999999887999999118\n"}, {"input": "5\n3\n6\n9\n10\n5\n", "output": "7/30\n5/14\n61/154\n9/22\n23/70\n"}, {"input": "5\n5\n8\n18\n17\n17\n", "output": "23/70\n59/154\n17/38\n287/646\n287/646\n"}, {"input": "5\n7\n40\n37\n25\n4\n", "output": "57/154\n39/82\n1437/3034\n615/1334\n3/10\n"}, {"input": "5\n72\n72\n30\n75\n11\n", "output": "71/146\n71/146\n29/62\n5615/11534\n119/286\n"}, {"input": "5\n79\n149\n136\n194\n124\n", "output": "6393/13114\n22199/44998\n135/274\n37631/76042\n14121/28702\n"}, {"input": "6\n885\n419\n821\n635\n63\n480\n", "output": "781453/1566442\n175559/352798\n674039/1351366\n403199/808942\n3959/8174\n232303/466546\n"}, {"input": "1\n649580447\n", "output": "421954771415489597/843909545429301074\n"}]}
{"id": 2336, "question": "Petr likes to come up with problems about randomly generated data. This time problem is about random permutation. He decided to generate a random permutation this way: he takes identity permutation of numbers from $1$ to $n$ and then $3n$ times takes a random pair of different elements and swaps them. Alex envies Petr and tries to imitate him in all kind of things. Alex has also come up with a problem about random permutation. He generates a random permutation just like Petr but swaps elements $7n+1$ times instead of $3n$ times. Because it is more random, OK?!\n\nYou somehow get a test from one of these problems and now you want to know from which one.\n\n\n-----Input-----\n\nIn the first line of input there is one integer $n$ ($10^{3} \\le n \\le 10^{6}$).\n\nIn the second line there are $n$ distinct integers between $1$ and $n$ — the permutation of size $n$ from the test.\n\nIt is guaranteed that all tests except for sample are generated this way: First we choose $n$ — the size of the permutation. Then we randomly choose a method to generate a permutation — the one of Petr or the one of Alex. Then we generate a permutation using chosen method.\n\n\n-----Output-----\n\nIf the test is generated via Petr's method print \"Petr\" (without quotes). If the test is generated via Alex's method print \"Um_nik\" (without quotes).\n\n\n-----Example-----\nInput\n5\n2 4 5 1 3\n\nOutput\nPetr\n\n\n\n-----Note-----\n\nPlease note that the sample is not a valid test (because of limitations for $n$) and is given only to illustrate input/output format. Your program still has to print correct answer to this test to get AC.\n\nDue to randomness of input hacks in this problem are forbidden.", "input_output": [{"input": "5\n2 4 5 1 3\n", "output": "Petr\n"}]}
{"id": 2025, "question": "Vasya and Petya are playing a simple game. Vasya thought of number x between 1 and n, and Petya tries to guess the number.\n\nPetya can ask questions like: \"Is the unknown number divisible by number y?\".\n\nThe game is played by the following rules: first Petya asks all the questions that interest him (also, he can ask no questions), and then Vasya responds to each question with a 'yes' or a 'no'. After receiving all the answers Petya should determine the number that Vasya thought of.\n\nUnfortunately, Petya is not familiar with the number theory. Help him find the minimum number of questions he should ask to make a guaranteed guess of Vasya's number, and the numbers y_{i}, he should ask the questions about.\n\n\n-----Input-----\n\nA single line contains number n (1 ≤ n ≤ 10^3).\n\n\n-----Output-----\n\nPrint the length of the sequence of questions k (0 ≤ k ≤ n), followed by k numbers — the questions y_{i} (1 ≤ y_{i} ≤ n).\n\nIf there are several correct sequences of questions of the minimum length, you are allowed to print any of them.\n\n\n-----Examples-----\nInput\n4\n\nOutput\n3\n2 4 3 \n\nInput\n6\n\nOutput\n4\n2 4 3 5 \n\n\n\n-----Note-----\n\nThe sequence from the answer to the first sample test is actually correct.\n\nIf the unknown number is not divisible by one of the sequence numbers, it is equal to 1.\n\nIf the unknown number is divisible by 4, it is 4.\n\nIf the unknown number is divisible by 3, then the unknown number is 3.\n\nOtherwise, it is equal to 2. Therefore, the sequence of questions allows you to guess the unknown number. It can be shown that there is no correct sequence of questions of length 2 or shorter.", "input_output": [{"input": "4\n", "output": "3\n2 4 3 \n"}, {"input": "6\n", "output": "4\n2 4 3 5 \n"}, {"input": "1\n", "output": "0\n\n"}, {"input": "15\n", "output": "9\n2 4 8 3 9 5 7 11 13 \n"}, {"input": "19\n", "output": "12\n2 4 8 16 3 9 5 7 11 13 17 19 \n"}, {"input": "20\n", "output": "12\n2 4 8 16 3 9 5 7 11 13 17 19 \n"}, {"input": "37\n", "output": "19\n2 4 8 16 32 3 9 27 5 25 7 11 13 17 19 23 29 31 37 \n"}, {"input": "211\n", "output": "61\n2 4 8 16 32 64 128 3 9 27 81 5 25 125 7 49 11 121 13 169 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 101 103 107 109 113 127 131 137 139 149 151 157 163 167 173 179 181 191 193 197 199 211 \n"}, {"input": "557\n", "output": "123\n2 4 8 16 32 64 128 256 512 3 9 27 81 243 5 25 125 7 49 343 11 121 13 169 17 289 19 361 23 529 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 101 103 107 109 113 127 131 137 139 149 151 157 163 167 173 179 181 191 193 197 199 211 223 227 229 233 239 241 251 257 263 269 271 277 281 283 293 307 311 313 317 331 337 347 349 353 359 367 373 379 383 389 397 401 409 419 421 431 433 439 443 449 457 461 463 467 479 487 491 499 503 509 521 523 541 547 557 \n"}, {"input": "289\n", "output": "78\n2 4 8 16 32 64 128 256 3 9 27 81 243 5 25 125 7 49 11 121 13 169 17 289 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 101 103 107 109 113 127 131 137 139 149 151 157 163 167 173 179 181 191 193 197 199 211 223 227 229 233 239 241 251 257 263 269 271 277 281 283 \n"}, {"input": "400\n", "output": "97\n2 4 8 16 32 64 128 256 3 9 27 81 243 5 25 125 7 49 343 11 121 13 169 17 289 19 361 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 101 103 107 109 113 127 131 137 139 149 151 157 163 167 173 179 181 191 193 197 199 211 223 227 229 233 239 241 251 257 263 269 271 277 281 283 293 307 311 313 317 331 337 347 349 353 359 367 373 379 383 389 397 \n"}, {"input": "625\n", "output": "136\n2 4 8 16 32 64 128 256 512 3 9 27 81 243 5 25 125 625 7 49 343 11 121 13 169 17 289 19 361 23 529 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 101 103 107 109 113 127 131 137 139 149 151 157 163 167 173 179 181 191 193 197 199 211 223 227 229 233 239 241 251 257 263 269 271 277 281 283 293 307 311 313 317 331 337 347 349 353 359 367 373 379 383 389 397 401 409 419 421 431 433 439 443 449 457 461 463 467 479 487 491 499 503 509 521 523 541 547 557 563 569 571 577 587 593 599 601 607 613 617 619 \n"}, {"input": "31\n", "output": "17\n2 4 8 16 3 9 27 5 25 7 11 13 17 19 23 29 31 \n"}, {"input": "44\n", "output": "21\n2 4 8 16 32 3 9 27 5 25 7 11 13 17 19 23 29 31 37 41 43 \n"}, {"input": "160\n", "output": "50\n2 4 8 16 32 64 128 3 9 27 81 5 25 125 7 49 11 121 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 101 103 107 109 113 127 131 137 139 149 151 157 \n"}, {"input": "322\n", "output": "83\n2 4 8 16 32 64 128 256 3 9 27 81 243 5 25 125 7 49 11 121 13 169 17 289 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97 101 103 107 109 113 127 131 137 139 149 151 157 163 167 173 179 181 191 193 197 199 211 223 227 229 233 239 241 251 257 263 269 271 277 281 283 293 307 311 313 317 \n"}, {"input": "30\n", "output": "16\n2 4 8 16 3 9 27 5 25 7 11 13 17 19 23 29 \n"}]}
{"id": 2184, "question": "This is an easier version of the next problem. In this version, $q = 0$.\n\nA sequence of integers is called nice if its elements are arranged in blocks like in $[3, 3, 3, 4, 1, 1]$. Formally, if two elements are equal, everything in between must also be equal.\n\nLet's define difficulty of a sequence as a minimum possible number of elements to change to get a nice sequence. However, if you change at least one element of value $x$ to value $y$, you must also change all other elements of value $x$ into $y$ as well. For example, for $[3, 3, 1, 3, 2, 1, 2]$ it isn't allowed to change first $1$ to $3$ and second $1$ to $2$. You need to leave $1$'s untouched or change them to the same value.\n\nYou are given a sequence of integers $a_1, a_2, \\ldots, a_n$ and $q$ updates.\n\nEach update is of form \"$i$ $x$\" — change $a_i$ to $x$. Updates are not independent (the change stays for the future).\n\nPrint the difficulty of the initial sequence and of the sequence after every update.\n\n\n-----Input-----\n\nThe first line contains integers $n$ and $q$ ($1 \\le n \\le 200\\,000$, $q = 0$), the length of the sequence and the number of the updates.\n\nThe second line contains $n$ integers $a_1, a_2, \\ldots, a_n$ ($1 \\le a_i \\le 200\\,000$), the initial sequence.\n\nEach of the following $q$ lines contains integers $i_t$ and $x_t$ ($1 \\le i_t \\le n$, $1 \\le x_t \\le 200\\,000$), the position and the new value for this position.\n\n\n-----Output-----\n\nPrint $q+1$ integers, the answer for the initial sequence and the answer after every update.\n\n\n-----Examples-----\nInput\n5 0\n3 7 3 7 3\n\nOutput\n2\n\nInput\n10 0\n1 2 1 2 3 1 1 1 50 1\n\nOutput\n4\n\nInput\n6 0\n6 6 3 3 4 4\n\nOutput\n0\n\nInput\n7 0\n3 3 1 3 2 1 2\n\nOutput\n4", "input_output": [{"input": "5 0\n3 7 3 7 3\n", "output": "2\n"}, {"input": "10 0\n1 2 1 2 3 1 1 1 50 1\n", "output": "4\n"}, {"input": "6 0\n6 6 3 3 4 4\n", "output": "0\n"}, {"input": "7 0\n3 3 1 3 2 1 2\n", "output": "4\n"}, {"input": "5 0\n1 2 1 2 1\n", "output": "2\n"}, {"input": "5 0\n2 3 2 3 3\n", "output": "2\n"}, {"input": "100 0\n6 7 100 8 5 61 5 75 59 65 51 47 83 37 34 54 87 46 4 26 21 87 12 97 86 68 60 11 62 76 14 83 29 31 91 62 57 80 47 75 85 97 62 77 91 86 14 25 48 77 83 65 39 61 78 77 45 46 90 74 100 91 86 98 55 5 84 42 91 69 100 4 74 98 60 37 75 44 41 12 15 34 36 1 99 16 7 87 36 26 79 42 41 84 17 98 72 16 38 55\n", "output": "95\n"}, {"input": "100 0\n91 32 10 38 92 14 100 7 48 72 47 10 76 99 56 53 41 46 68 18 37 47 61 99 16 60 12 51 17 50 69 8 82 78 34 95 3 15 79 4 51 45 83 91 81 68 79 91 16 30 6 86 72 97 63 75 67 14 50 60 1 13 77 37 57 14 65 79 41 62 15 11 74 56 76 62 54 52 9 96 8 27 44 21 59 57 17 53 15 66 49 94 62 58 71 53 88 97 65 37\n", "output": "97\n"}, {"input": "100 0\n44 8 97 30 48 96 35 54 42 9 66 27 99 57 74 97 90 24 78 97 98 55 74 56 25 30 34 26 12 87 77 12 7 49 79 2 95 33 72 50 47 28 95 31 99 27 96 43 9 62 6 21 55 22 10 79 71 27 85 37 32 66 54 61 48 48 10 61 57 78 91 41 30 43 29 70 96 4 36 19 50 99 16 68 8 80 55 74 18 35 54 84 70 9 17 77 69 71 67 24\n", "output": "96\n"}]}
{"id": 2175, "question": "After Misha's birthday he had many large numbers left, scattered across the room. Now it's time to clean up and Misha needs to put them in a basket. He ordered this task to his pet robot that agreed to complete the task at certain conditions. Before the robot puts a number x to the basket, Misha should answer the question: is it possible to choose one or multiple numbers that already are in the basket, such that their XOR sum equals x? \n\nIf the answer is positive, you also need to give the indexes of these numbers. If there are multiple options of choosing numbers, you are allowed to choose any correct option. After Misha's answer the robot puts the number to the basket.\n\nInitially the basket is empty. Each integer you put in the basket takes some number. The first integer you put into the basket take number 0, the second integer takes number 1 and so on.\n\nMisha needs to clean up the place as soon as possible but unfortunately, he isn't that good at mathematics. He asks you to help him.\n\n\n-----Input-----\n\nThe first line contains number m (1 ≤ m ≤ 2000), showing how many numbers are scattered around the room.\n\nThe next m lines contain the numbers in the order in which the robot puts them in the basket. Each number is a positive integer strictly less than 10^600 that doesn't contain leading zeroes. \n\n\n-----Output-----\n\nFor each number either print a 0 on the corresponding line, if the number cannot be represented as a XOR sum of numbers that are in the basket, or print integer k showing how many numbers are in the representation and the indexes of these numbers. Separate the numbers by spaces. Each number can occur in the representation at most once.\n\n\n-----Examples-----\nInput\n7\n7\n6\n5\n4\n3\n2\n1\n\nOutput\n0\n0\n0\n3 0 1 2\n2 1 2\n2 0 2\n2 0 1\n\nInput\n2\n5\n5\n\nOutput\n0\n1 0\n\n\n\n-----Note-----\n\nThe XOR sum of numbers is the result of bitwise sum of numbers modulo 2.", "input_output": [{"input": "7\n7\n6\n5\n4\n3\n2\n1\n", "output": "0\n0\n0\n3 0 1 2\n2 1 2\n2 0 2\n2 0 1\n"}, {"input": "2\n5\n5\n", "output": "0\n1 0\n"}, {"input": "10\n81\n97\n12\n2\n16\n96\n80\n99\n6\n83\n", "output": "0\n0\n0\n0\n0\n0\n3 0 1 5\n2 1 3\n0\n2 0 3\n"}, {"input": "10\n15106\n13599\n69319\n33224\n26930\n94490\n85089\n60931\n23137\n62868\n", "output": "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n"}, {"input": "10\n5059464500\n8210395556\n3004213265\n248593357\n5644084048\n9359824793\n8120649160\n4288978422\n183848555\n8135845959\n", "output": "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n"}, {"input": "10\n4\n12\n28\n29\n31\n31\n31\n31\n31\n31\n", "output": "0\n0\n0\n0\n0\n1 4\n1 4\n1 4\n1 4\n1 4\n"}, {"input": "10\n16\n24\n28\n30\n31\n31\n31\n31\n31\n31\n", "output": "0\n0\n0\n0\n0\n1 4\n1 4\n1 4\n1 4\n1 4\n"}, {"input": "10\n16\n8\n4\n2\n1\n31\n31\n31\n31\n31\n", "output": "0\n0\n0\n0\n0\n5 0 1 2 3 4\n5 0 1 2 3 4\n5 0 1 2 3 4\n5 0 1 2 3 4\n5 0 1 2 3 4\n"}, {"input": "10\n1\n2\n4\n8\n16\n31\n31\n31\n31\n31\n", "output": "0\n0\n0\n0\n0\n5 0 1 2 3 4\n5 0 1 2 3 4\n5 0 1 2 3 4\n5 0 1 2 3 4\n5 0 1 2 3 4\n"}]}
{"id": 2353, "question": "You are given an array a with n distinct integers. Construct an array b by permuting a such that for every non-empty subset of indices S = {x_1, x_2, ..., x_{k}} (1 ≤ x_{i} ≤ n, 0 < k < n) the sums of elements on that positions in a and b are different, i. e. $\\sum_{i = 1}^{k} a_{x_{i}} \\neq \\sum_{i = 1}^{k} b_{x_{i}}$\n\n\n-----Input-----\n\nThe first line contains one integer n (1 ≤ n ≤ 22) — the size of the array.\n\nThe second line contains n space-separated distinct integers a_1, a_2, ..., a_{n} (0 ≤ a_{i} ≤ 10^9) — the elements of the array.\n\n\n-----Output-----\n\nIf there is no such array b, print -1.\n\nOtherwise in the only line print n space-separated integers b_1, b_2, ..., b_{n}. Note that b must be a permutation of a.\n\nIf there are multiple answers, print any of them.\n\n\n-----Examples-----\nInput\n2\n1 2\n\nOutput\n2 1 \n\nInput\n4\n1000 100 10 1\n\nOutput\n100 1 1000 10\n\n\n\n-----Note-----\n\nAn array x is a permutation of y, if we can shuffle elements of y such that it will coincide with x.\n\nNote that the empty subset and the subset containing all indices are not counted.", "input_output": [{"input": "2\n1 2\n", "output": "2 1 \n"}, {"input": "4\n1000 100 10 1\n", "output": "100 1 1000 10\n"}, {"input": "5\n1 3 4 5 2\n", "output": "5 2 3 4 1 \n"}, {"input": "1\n10000000\n", "output": "10000000 \n"}, {"input": "4\n1 5 8 4\n", "output": "8 4 5 1 \n"}, {"input": "3\n1 3 2\n", "output": "3 2 1 \n"}, {"input": "4\n3 1 2 4\n", "output": "2 4 1 3 \n"}, {"input": "12\n7 1 62 12 3 5 8 9 10 22 23 0\n", "output": "5 0 23 10 1 3 7 8 9 12 22 62 \n"}, {"input": "17\n1 3 2 5 4 6 7 8 10 9 13 11 12 14 15 16 18\n", "output": "18 2 1 4 3 5 6 7 9 8 12 10 11 13 14 15 16 \n"}, {"input": "22\n1 3 5 7 22 2 4 6 8 9 10 11 12 13 15 14 17 18 16 20 19 23\n", "output": "23 2 4 6 20 1 3 5 7 8 9 10 11 12 14 13 16 17 15 19 18 22 \n"}, {"input": "22\n17 6 1 22 9 23 38 40 10 20 29 11 12 39 3 32 26 4 13 36 14 35\n", "output": "14 4 40 20 6 22 36 39 9 17 26 10 11 38 1 29 23 3 12 35 13 32 \n"}, {"input": "22\n27 21 12 14 8 40 47 45 24 49 36 37 17 32 42 13 35 10 18 2 5 30\n", "output": "24 18 10 13 5 37 45 42 21 47 35 36 14 30 40 12 32 8 17 49 2 27 \n"}, {"input": "22\n33 2 19 26 18 13 27 9 25 35 6 24 20 22 11 5 1 30 17 15 7 29\n", "output": "30 1 18 25 17 11 26 7 24 33 5 22 19 20 9 2 35 29 15 13 6 27 \n"}, {"input": "22\n18 37 15 33 35 5 14 1 0 27 22 11 40 20 13 2 30 21 8 25 32 16\n", "output": "16 35 14 32 33 2 13 0 40 25 21 8 37 18 11 1 27 20 5 22 30 15 \n"}, {"input": "22\n4 24 22 18 28 3 17 8 29 20 11 15 13 2 19 26 5 36 33 14 30 25\n", "output": "3 22 20 17 26 2 15 5 28 19 8 14 11 36 18 25 4 33 30 13 29 24 \n"}, {"input": "22\n28 40 5 38 29 12 21 24 2 33 35 17 30 11 16 0 8 27 34 14 19 36\n", "output": "27 38 2 36 28 11 19 21 0 30 34 16 29 8 14 40 5 24 33 12 17 35 \n"}, {"input": "22\n25 12 38 5 6 20 30 27 4 19 8 18 10 17 26 32 43 14 40 35 1 22\n", "output": "22 10 35 4 5 19 27 26 1 18 6 17 8 14 25 30 40 12 38 32 43 20 \n"}, {"input": "22\n2 22 21 19 3 25 28 11 10 9 14 37 18 38 15 23 20 34 7 30 31 4\n", "output": "38 21 20 18 2 23 25 10 9 7 11 34 15 37 14 22 19 31 4 28 30 3 \n"}, {"input": "22\n7 0 23 37 20 18 46 26 2 24 44 13 47 15 32 5 35 30 39 41 27 10\n", "output": "5 47 20 35 18 15 44 24 0 23 41 10 46 13 30 2 32 27 37 39 26 7 \n"}, {"input": "22\n36 5 7 22 33 30 14 8 25 24 28 12 19 29 37 2 20 15 10 17 13 21\n", "output": "33 2 5 21 30 29 13 7 24 22 25 10 17 28 36 37 19 14 8 15 12 20 \n"}, {"input": "22\n23 32 13 39 29 41 40 6 21 10 38 42 4 8 20 35 31 26 15 2 17 5\n", "output": "21 31 10 38 26 40 39 5 20 8 35 41 2 6 17 32 29 23 13 42 15 4 \n"}, {"input": "22\n41 12 14 36 16 21 0 2 18 22 39 29 40 31 37 25 28 9 4 34 6 43\n", "output": "40 9 12 34 14 18 43 0 16 21 37 28 39 29 36 22 25 6 2 31 4 41 \n"}, {"input": "22\n32 43 3 37 29 42 40 12 28 1 14 25 34 46 8 35 5 17 2 23 20 9\n", "output": "29 42 2 35 28 40 37 9 25 46 12 23 32 43 5 34 3 14 1 20 17 8 \n"}, {"input": "22\n17 10 24 44 41 33 48 6 30 27 38 19 16 46 22 8 35 13 5 9 4 1\n", "output": "16 9 22 41 38 30 46 5 27 24 35 17 13 44 19 6 33 10 4 8 1 48 \n"}, {"input": "22\n16 11 29 30 12 5 3 2 13 6 17 15 9 24 25 35 1 27 0 23 20 33\n", "output": "15 9 27 29 11 3 2 1 12 5 16 13 6 23 24 33 0 25 35 20 17 30 \n"}, {"input": "22\n12 38 6 37 14 26 2 0 9 17 28 33 3 11 15 8 31 21 29 34 18 24\n", "output": "11 37 3 34 12 24 0 38 8 15 26 31 2 9 14 6 29 18 28 33 17 21 \n"}, {"input": "22\n20 38 26 32 36 8 44 0 40 41 35 21 11 17 29 33 1 42 24 14 5 3\n", "output": "17 36 24 29 35 5 42 44 38 40 33 20 8 14 26 32 0 41 21 11 3 1 \n"}, {"input": "22\n7 10 1 25 42 8 39 35 6 19 31 24 16 0 21 32 11 28 13 4 37 22\n", "output": "6 8 0 24 39 7 37 32 4 16 28 22 13 42 19 31 10 25 11 1 35 21 \n"}, {"input": "22\n9 13 7 20 38 40 27 12 31 25 1 23 46 35 45 29 19 16 33 4 42 39\n", "output": "7 12 4 19 35 39 25 9 29 23 46 20 45 33 42 27 16 13 31 1 40 38 \n"}, {"input": "22\n13 2 10 25 5 34 19 18 16 9 7 22 28 20 31 38 36 35 1 26 6 23\n", "output": "10 1 9 23 2 31 18 16 13 7 6 20 26 19 28 36 35 34 38 25 5 22 \n"}, {"input": "22\n106855341 41953605 16663229 140358177 145011760 49391214 42672526 1000000000 173686818 18529133 155326121 177597841 65855243 125680752 111261017 47020618 35558283 100881772 149421816 84207033 181739589 185082482\n", "output": "100881772 35558283 1000000000 125680752 140358177 47020618 41953605 185082482 155326121 16663229 149421816 173686818 49391214 111261017 106855341 42672526 18529133 84207033 145011760 65855243 177597841 181739589 \n"}, {"input": "22\n177663922 168256855 139197944 78700101 93490895 127229611 46317725 84284513 48674853 66142856 29224095 1000000000 138390832 117500569 98525700 100418194 44827621 151960474 43225995 16918107 53307514 48861499\n", "output": "168256855 151960474 138390832 66142856 84284513 117500569 44827621 78700101 46317725 53307514 16918107 177663922 127229611 100418194 93490895 98525700 43225995 139197944 29224095 1000000000 48861499 48674853 \n"}, {"input": "22\n83255567 39959119 124812899 157774437 12694468 89732189 102545715 67019496 110206980 98186415 63181429 141617294 177406424 195504716 158928060 64956133 67949891 31436243 155002729 1000000000 128745406 52504492\n", "output": "67949891 31436243 110206980 155002729 1000000000 83255567 98186415 64956133 102545715 89732189 52504492 128745406 158928060 177406424 157774437 63181429 67019496 12694468 141617294 195504716 124812899 39959119 \n"}, {"input": "22\n138499935 195582510 159774498 12295611 37071371 91641202 167958938 119995178 19438466 182405139 207729895 56797798 79876605 152841775 1000000000 149079380 158867321 154637978 72179187 75460169 145092927 103227705\n", "output": "119995178 182405139 158867321 1000000000 19438466 79876605 159774498 103227705 12295611 167958938 195582510 37071371 75460169 149079380 207729895 145092927 154637978 152841775 56797798 72179187 138499935 91641202 \n"}, {"input": "22\n133295371 188010892 71730560 209842234 193069109 184556873 87395258 234247052 230809052 211444018 148989732 17810977 158722706 11753932 100093528 1000000000 43672080 61357581 171830832 13873487 34865589 114340079\n", "output": "114340079 184556873 61357581 193069109 188010892 171830832 71730560 230809052 211444018 209842234 133295371 13873487 148989732 1000000000 87395258 234247052 34865589 43672080 158722706 11753932 17810977 100093528 \n"}, {"input": "22\n94506085 195061283 78884975 27418524 41348358 185397891 151515774 66605535 170723638 212843258 218566729 7450050 21809921 1000000000 146101141 132453297 228865386 240705035 57636433 114219677 158240908 228428432\n", "output": "78884975 185397891 66605535 21809921 27418524 170723638 146101141 57636433 158240908 195061283 212843258 1000000000 7450050 240705035 132453297 114219677 228428432 228865386 41348358 94506085 151515774 218566729 \n"}, {"input": "22\n116213533 171312666 76695399 60099180 30779320 43431323 146620629 15321904 71245898 94843310 56549974 104020167 84091716 134384095 24383373 83975332 1000000000 101710173 188076412 199811222 153566780 115893674\n", "output": "115893674 153566780 71245898 56549974 24383373 30779320 134384095 1000000000 60099180 84091716 43431323 101710173 83975332 116213533 15321904 76695399 199811222 94843310 171312666 188076412 146620629 104020167 \n"}, {"input": "22\n79749952 42551386 1000000000 60427603 50702468 16899307 85913428 116634789 151569595 100251788 152378664 96284924 60769416 136345503 59995727 88224321 29257228 64921932 77805288 126026727 103477637 115959196\n", "output": "77805288 29257228 152378664 59995727 42551386 1000000000 79749952 115959196 136345503 96284924 151569595 88224321 60427603 126026727 50702468 85913428 16899307 60769416 64921932 116634789 100251788 103477637 \n"}, {"input": "22\n32119698 129510003 107370317 182795872 160438101 17245069 117836566 141016185 196664039 215252245 170450315 18866624 68629021 47385728 77249092 89835593 132769095 95649030 48749357 126701972 40219294 1000000000\n", "output": "18866624 126701972 95649030 170450315 141016185 1000000000 107370317 132769095 182795872 196664039 160438101 17245069 48749357 40219294 68629021 77249092 129510003 89835593 47385728 117836566 32119698 215252245 \n"}, {"input": "22\n148671024 180468173 99388811 78666746 187172484 157360521 112604605 2988530 60271244 163263697 27469084 166381131 1000000000 125847469 137766458 198740424 88387613 15152912 200315776 149201551 45997250 36252057\n", "output": "137766458 166381131 88387613 60271244 180468173 149201551 99388811 1000000000 45997250 157360521 15152912 163263697 200315776 112604605 125847469 187172484 78666746 2988530 198740424 148671024 36252057 27469084 \n"}]}
{"id": 2086, "question": "Recently, on the course of algorithms and data structures, Valeriy learned how to use a deque. He built a deque filled with $n$ elements. The $i$-th element is $a_i$ ($i$ = $1, 2, \\ldots, n$). He gradually takes the first two leftmost elements from the deque (let's call them $A$ and $B$, respectively), and then does the following: if $A > B$, he writes $A$ to the beginning and writes $B$ to the end of the deque, otherwise, he writes to the beginning $B$, and $A$ writes to the end of the deque. We call this sequence of actions an operation.\n\nFor example, if deque was $[2, 3, 4, 5, 1]$, on the operation he will write $B=3$ to the beginning and $A=2$ to the end, so he will get $[3, 4, 5, 1, 2]$.\n\nThe teacher of the course, seeing Valeriy, who was passionate about his work, approached him and gave him $q$ queries. Each query consists of the singular number $m_j$ $(j = 1, 2, \\ldots, q)$. It is required for each query to answer which two elements he will pull out on the $m_j$-th operation.\n\nNote that the queries are independent and for each query the numbers $A$ and $B$ should be printed in the order in which they will be pulled out of the deque.\n\nDeque is a data structure representing a list of elements where insertion of new elements or deletion of existing elements can be made from both sides.\n\n\n-----Input-----\n\nThe first line contains two integers $n$ and $q$ ($2 \\leq n \\leq 10^5$, $0 \\leq q \\leq 3 \\cdot 10^5$) — the number of elements in the deque and the number of queries. The second line contains $n$ integers $a_1$, $a_2$, ..., $a_n$, where $a_i$ $(0 \\leq a_i \\leq 10^9)$ — the deque element in $i$-th position. The next $q$ lines contain one number each, meaning $m_j$ ($1 \\leq m_j \\leq 10^{18}$).\n\n\n-----Output-----\n\nFor each teacher's query, output two numbers $A$ and $B$ — the numbers that Valeriy pulls out of the deque for the $m_j$-th operation.\n\n\n-----Examples-----\nInput\n5 3\n1 2 3 4 5\n1\n2\n10\n\nOutput\n1 2\n2 3\n5 2\n\nInput\n2 0\n0 0\n\nOutput\n\n\n\n-----Note----- Consider all 10 steps for the first test in detail: $[1, 2, 3, 4, 5]$ — on the first operation, $A$ and $B$ are $1$ and $2$, respectively.\n\nSo, $2$ we write to the beginning of the deque, and $1$ — to the end.\n\nWe get the following status of the deque: $[2, 3, 4, 5, 1]$. $[2, 3, 4, 5, 1] \\Rightarrow A = 2, B = 3$. $[3, 4, 5, 1, 2]$ $[4, 5, 1, 2, 3]$ $[5, 1, 2, 3, 4]$ $[5, 2, 3, 4, 1]$ $[5, 3, 4, 1, 2]$ $[5, 4, 1, 2, 3]$ $[5, 1, 2, 3, 4]$ $[5, 2, 3, 4, 1] \\Rightarrow A = 5, B = 2$.", "input_output": [{"input": "5 3\n1 2 3 4 5\n1\n2\n10\n", "output": "1 2\n2 3\n5 2\n"}, {"input": "2 0\n0 0\n", "output": ""}, {"input": "2 1\n1 2\n1\n", "output": "1 2\n"}, {"input": "3 2\n1000000 999999 999998\n98\n999999999999\n", "output": "1000000 999998\n1000000 999999\n"}, {"input": "5 10\n5728 41414 457879 94 1\n1\n100\n10000\n1000000\n100000000\n10000000000\n1000000000000\n100000000000000\n10000000000000000\n1000000000000000000\n", "output": "5728 41414\n457879 1\n457879 1\n457879 1\n457879 1\n457879 1\n457879 1\n457879 1\n457879 1\n457879 1\n"}, {"input": "71 57\n9 26 80 10 65 60 63 1 15 85 71 1 58 27 41 97 42 15 42 56 87 22 10 28 34 90 13 70 71 56 65 21 0 78 47 96 56 77 32 83 28 16 10 41 0 18 78 12 27 58 4 67 21 41 99 20 21 52 74 10 83 45 43 65 2 15 1 63 46 97 72\n81\n21\n81\n81\n5\n9\n41\n76\n81\n92\n95\n94\n78\n93\n47\n30\n92\n3\n45\n81\n42\n88\n17\n3\n39\n9\n95\n19\n95\n1\n79\n21\n15\n57\n31\n21\n61\n53\n93\n56\n55\n91\n62\n16\n41\n65\n65\n1\n31\n12\n27\n61\n61\n81\n29\n56\n61\n", "output": "99 1\n97 22\n99 1\n99 1\n80 60\n80 85\n97 16\n99 63\n99 1\n99 10\n99 90\n99 34\n99 15\n99 28\n97 12\n97 65\n99 10\n80 10\n97 18\n99 1\n97 10\n99 42\n97 15\n80 10\n97 83\n80 85\n99 90\n97 56\n99 90\n9 26\n99 80\n97 22\n85 97\n99 52\n97 21\n97 22\n99 45\n97 41\n99 28\n99 21\n99 20\n99 22\n99 43\n97 42\n97 16\n99 15\n99 15\n9 26\n97 21\n85 58\n97 70\n99 45\n99 45\n99 1\n97 56\n99 21\n99 45\n"}, {"input": "66 31\n2 35 79 90 61 55 7 13 96 67 58 18 72 46 59 43 45 78 72 86 78 47 47 14 84 43 91 19 25 81 63 94 23 48 50 74 1 4 92 97 84 86 91 1 73 66 77 75 30 57 16 46 17 22 54 4 44 44 95 56 34 16 41 13 29 39\n95\n78\n48\n33\n97\n28\n83\n21\n93\n97\n9\n76\n13\n97\n44\n96\n85\n13\n45\n24\n57\n1\n73\n94\n89\n1\n39\n49\n49\n87\n81\n", "output": "97 63\n97 46\n97 30\n96 48\n97 23\n96 25\n97 72\n96 47\n97 25\n97 23\n96 67\n97 18\n96 46\n97 23\n97 73\n97 94\n97 78\n96 46\n97 66\n96 84\n97 44\n2 35\n97 90\n97 81\n97 84\n2 35\n96 97\n97 57\n97 57\n97 47\n97 45\n"}, {"input": "51 15\n14 34 51 71 72 56 100 38 30 60 75 74 90 84 59 97 45 43 18 71 95 1 26 40 73 48 20 10 98 2 17 33 100 60 83 40 50 9 23 77 57 12 77 9 83 99 10 47 32 76 69\n81\n2\n82\n37\n21\n60\n9\n19\n85\n19\n1\n46\n16\n27\n21\n", "output": "100 33\n34 51\n100 100\n100 9\n100 1\n100 75\n100 60\n100 71\n100 40\n100 71\n14 34\n100 10\n100 45\n100 10\n100 1\n"}, {"input": "49 55\n88 17 40 32 36 60 78 90 64 78 5 77 46 94 48 12 91 65 75 18 81 92 8 19 61 70 46 27 74 10 39 67 87 95 97 35 17 24 56 58 22 17 9 42 74 74 79 48 20\n89\n21\n5\n57\n46\n65\n76\n60\n76\n63\n34\n1\n98\n45\n77\n5\n61\n30\n77\n1\n21\n69\n74\n15\n91\n28\n18\n13\n100\n19\n51\n65\n8\n18\n17\n97\n81\n97\n21\n1\n100\n99\n31\n1\n69\n6\n81\n67\n81\n33\n81\n31\n26\n78\n1\n", "output": "97 17\n94 92\n88 60\n97 78\n97 79\n97 65\n97 74\n97 46\n97 74\n97 12\n95 97\n88 17\n97 40\n97 74\n97 10\n88 60\n97 90\n94 39\n97 10\n88 17\n94 92\n97 92\n97 46\n94 12\n97 42\n94 74\n94 75\n90 94\n97 36\n94 18\n97 32\n97 65\n90 64\n94 75\n94 65\n97 17\n97 94\n97 17\n94 92\n88 17\n97 36\n97 32\n94 67\n88 17\n97 92\n88 78\n97 94\n97 18\n97 94\n94 95\n97 94\n94 67\n94 46\n97 39\n88 17\n"}, {"input": "42 58\n70 65 58 27 24 10 88 81 83 30 29 98 42 97 61 59 48 2 69 22 43 48 94 27 92 70 94 87 69 42 72 79 57 23 62 32 39 86 95 16 11 42\n61\n74\n11\n13\n73\n29\n34\n87\n75\n27\n79\n37\n7\n31\n11\n42\n14\n18\n73\n13\n41\n42\n61\n45\n3\n21\n95\n51\n10\n45\n31\n55\n20\n13\n33\n65\n50\n56\n29\n5\n62\n61\n48\n85\n3\n91\n21\n97\n53\n80\n56\n65\n19\n24\n49\n89\n93\n94\n", "output": "98 43\n98 23\n88 98\n98 97\n98 57\n98 42\n98 62\n98 10\n98 62\n98 87\n98 95\n98 86\n88 81\n98 79\n88 98\n98 65\n98 61\n98 69\n98 57\n98 97\n98 42\n98 65\n98 43\n98 24\n70 27\n98 48\n98 97\n98 29\n88 29\n98 24\n98 79\n98 61\n98 43\n98 97\n98 23\n98 92\n98 30\n98 59\n98 42\n70 10\n98 48\n98 43\n98 81\n98 27\n70 27\n98 30\n98 48\n98 59\n98 42\n98 16\n98 59\n98 92\n98 22\n98 92\n98 83\n98 81\n98 88\n98 42\n"}, {"input": "51 12\n52 59 4 82 16 80 52 81 0 36 70 25 0 66 24 58 70 34 81 71 53 87 45 12 97 73 72 35 51 55 66 43 8 20 89 48 48 53 32 87 17 13 43 80 70 84 16 87 8 18 25\n59\n31\n89\n77\n9\n78\n81\n29\n8\n41\n17\n59\n", "output": "97 36\n97 43\n97 87\n97 35\n82 36\n97 51\n97 43\n97 55\n82 0\n97 13\n82 34\n97 36\n"}, {"input": "5 3\n5 1 2 3 4\n1\n316\n2\n", "output": "5 1\n5 4\n5 2\n"}, {"input": "4 5\n1 2 5 5\n1\n2\n3\n4\n5\n", "output": "1 2\n2 5\n5 5\n5 1\n5 2\n"}]}
